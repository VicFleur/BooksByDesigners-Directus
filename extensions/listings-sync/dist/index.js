"use strict";var require$$8$1=require("crypto"),commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}const APP_EXTENSION_TYPES=["interface","display","layout","module","panel","theme"],API_EXTENSION_TYPES=["hook","endpoint"],HYBRID_EXTENSION_TYPES=["operation"],BUNDLE_EXTENSION_TYPES=["bundle"];function $constructor(e,r,t){function n(t,n){var i;Object.defineProperty(t,"_zod",{value:t._zod??{},enumerable:!1}),(i=t._zod).traits??(i.traits=new Set),t._zod.traits.add(e),r(t,n);for(const e in o.prototype)e in t||Object.defineProperty(t,e,{value:o.prototype[e].bind(t)});t._zod.constr=o,t._zod.def=n}const i=t?.Parent??Object;class s extends i{}function o(e){var r;const i=t?.Parent?new s:this;n(i,e),(r=i._zod).deferred??(r.deferred=[]);for(const e of i._zod.deferred)e();return i}return Object.defineProperty(s,"name",{value:e}),Object.defineProperty(o,"init",{value:n}),Object.defineProperty(o,Symbol.hasInstance,{value:r=>!!(t?.Parent&&r instanceof t.Parent)||r?._zod?.traits?.has(e)}),Object.defineProperty(o,"name",{value:e}),o}class $ZodAsyncError extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class $ZodEncodeError extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}}const globalConfig={};function config(e){return globalConfig}function getEnumValues(e){const r=Object.values(e).filter(e=>"number"==typeof e);return Object.entries(e).filter(([e,t])=>-1===r.indexOf(+e)).map(([e,r])=>r)}function jsonStringifyReplacer(e,r){return"bigint"==typeof r?r.toString():r}function cached(e){return{get value(){{const r=e();return Object.defineProperty(this,"value",{value:r}),r}}}}function nullish(e){return null==e}function cleanRegex(e){const r=e.startsWith("^")?1:0,t=e.endsWith("$")?e.length-1:e.length;return e.slice(r,t)}const EVALUATING=Symbol("evaluating");function defineLazy(e,r,t){let n;Object.defineProperty(e,r,{get(){if(n!==EVALUATING)return void 0===n&&(n=EVALUATING,n=t()),n},set(t){Object.defineProperty(e,r,{value:t})},configurable:!0})}function assignProp(e,r,t){Object.defineProperty(e,r,{value:t,writable:!0,enumerable:!0,configurable:!0})}function mergeDefs(...e){const r={};for(const t of e){const e=Object.getOwnPropertyDescriptors(t);Object.assign(r,e)}return Object.defineProperties({},r)}function esc(e){return JSON.stringify(e)}const captureStackTrace="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function isObject(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}const allowsEval=cached(()=>{if("undefined"!=typeof navigator&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return new Function(""),!0}catch(e){return!1}});function isPlainObject(e){if(!1===isObject(e))return!1;const r=e.constructor;if(void 0===r)return!0;const t=r.prototype;return!1!==isObject(t)&&!1!==Object.prototype.hasOwnProperty.call(t,"isPrototypeOf")}function shallowClone(e){return isPlainObject(e)?{...e}:Array.isArray(e)?[...e]:e}const propertyKeyTypes=new Set(["string","number","symbol"]);function escapeRegex(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function clone(e,r,t){const n=new e._zod.constr(r??e._zod.def);return r&&!t?.parent||(n._zod.parent=e),n}function normalizeParams(e){const r=e;if(!r)return{};if("string"==typeof r)return{error:()=>r};if(void 0!==r?.message){if(void 0!==r?.error)throw new Error("Cannot specify both `message` and `error` params");r.error=r.message}return delete r.message,"string"==typeof r.error?{...r,error:()=>r.error}:r}function optionalKeys(e){return Object.keys(e).filter(r=>"optional"===e[r]._zod.optin&&"optional"===e[r]._zod.optout)}function pick(e,r){const t=e._zod.def;return clone(e,mergeDefs(e._zod.def,{get shape(){const e={};for(const n in r){if(!(n in t.shape))throw new Error(`Unrecognized key: "${n}"`);r[n]&&(e[n]=t.shape[n])}return assignProp(this,"shape",e),e},checks:[]}))}function omit(e,r){const t=e._zod.def,n=mergeDefs(e._zod.def,{get shape(){const n={...e._zod.def.shape};for(const e in r){if(!(e in t.shape))throw new Error(`Unrecognized key: "${e}"`);r[e]&&delete n[e]}return assignProp(this,"shape",n),n},checks:[]});return clone(e,n)}function extend(e,r){if(!isPlainObject(r))throw new Error("Invalid input to extend: expected a plain object");const t=e._zod.def.checks;if(t&&t.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const n=mergeDefs(e._zod.def,{get shape(){const t={...e._zod.def.shape,...r};return assignProp(this,"shape",t),t},checks:[]});return clone(e,n)}function safeExtend(e,r){if(!isPlainObject(r))throw new Error("Invalid input to safeExtend: expected a plain object");const t={...e._zod.def,get shape(){const t={...e._zod.def.shape,...r};return assignProp(this,"shape",t),t},checks:e._zod.def.checks};return clone(e,t)}function merge(e,r){const t=mergeDefs(e._zod.def,{get shape(){const t={...e._zod.def.shape,...r._zod.def.shape};return assignProp(this,"shape",t),t},get catchall(){return r._zod.def.catchall},checks:[]});return clone(e,t)}function partial(e,r,t){const n=mergeDefs(r._zod.def,{get shape(){const n=r._zod.def.shape,i={...n};if(t)for(const r in t){if(!(r in n))throw new Error(`Unrecognized key: "${r}"`);t[r]&&(i[r]=e?new e({type:"optional",innerType:n[r]}):n[r])}else for(const r in n)i[r]=e?new e({type:"optional",innerType:n[r]}):n[r];return assignProp(this,"shape",i),i},checks:[]});return clone(r,n)}function required(e,r,t){const n=mergeDefs(r._zod.def,{get shape(){const n=r._zod.def.shape,i={...n};if(t)for(const r in t){if(!(r in i))throw new Error(`Unrecognized key: "${r}"`);t[r]&&(i[r]=new e({type:"nonoptional",innerType:n[r]}))}else for(const r in n)i[r]=new e({type:"nonoptional",innerType:n[r]});return assignProp(this,"shape",i),i},checks:[]});return clone(r,n)}function aborted(e,r=0){if(!0===e.aborted)return!0;for(let t=r;t<e.issues.length;t++)if(!0!==e.issues[t]?.continue)return!0;return!1}function prefixIssues(e,r){return r.map(r=>{var t;return(t=r).path??(t.path=[]),r.path.unshift(e),r})}function unwrapMessage(e){return"string"==typeof e?e:e?.message}function finalizeIssue(e,r,t){const n={...e,path:e.path??[]};if(!e.message){const i=unwrapMessage(e.inst?._zod.def?.error?.(e))??unwrapMessage(r?.error?.(e))??unwrapMessage(t.customError?.(e))??unwrapMessage(t.localeError?.(e))??"Invalid input";n.message=i}return delete n.inst,delete n.continue,r?.reportInput||delete n.input,n}function getLengthableOrigin(e){return Array.isArray(e)?"array":"string"==typeof e?"string":"unknown"}function issue(...e){const[r,t,n]=e;return"string"==typeof r?{message:r,code:"custom",input:t,inst:n}:{...r}}const initializer$1=(e,r)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:r,enumerable:!1}),e.message=JSON.stringify(r,jsonStringifyReplacer,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},$ZodError=$constructor("$ZodError",initializer$1),$ZodRealError=$constructor("$ZodError",initializer$1,{Parent:Error});function flattenError(e,r=e=>e.message){const t={},n=[];for(const i of e.issues)i.path.length>0?(t[i.path[0]]=t[i.path[0]]||[],t[i.path[0]].push(r(i))):n.push(r(i));return{formErrors:n,fieldErrors:t}}function formatError(e,r=e=>e.message){const t={_errors:[]},n=e=>{for(const i of e.issues)if("invalid_union"===i.code&&i.errors.length)i.errors.map(e=>n({issues:e}));else if("invalid_key"===i.code)n({issues:i.issues});else if("invalid_element"===i.code)n({issues:i.issues});else if(0===i.path.length)t._errors.push(r(i));else{let e=t,n=0;for(;n<i.path.length;){const t=i.path[n];n===i.path.length-1?(e[t]=e[t]||{_errors:[]},e[t]._errors.push(r(i))):e[t]=e[t]||{_errors:[]},e=e[t],n++}}};return n(e),t}const _parse=e=>(r,t,n,i)=>{const s=n?Object.assign(n,{async:!1}):{async:!1},o=r._zod.run({value:t,issues:[]},s);if(o instanceof Promise)throw new $ZodAsyncError;if(o.issues.length){const r=new(i?.Err??e)(o.issues.map(e=>finalizeIssue(e,s,config())));throw captureStackTrace(r,i?.callee),r}return o.value},_parseAsync=e=>async(r,t,n,i)=>{const s=n?Object.assign(n,{async:!0}):{async:!0};let o=r._zod.run({value:t,issues:[]},s);if(o instanceof Promise&&(o=await o),o.issues.length){const r=new(i?.Err??e)(o.issues.map(e=>finalizeIssue(e,s,config())));throw captureStackTrace(r,i?.callee),r}return o.value},_safeParse=e=>(r,t,n)=>{const i=n?{...n,async:!1}:{async:!1},s=r._zod.run({value:t,issues:[]},i);if(s instanceof Promise)throw new $ZodAsyncError;return s.issues.length?{success:!1,error:new(e??$ZodError)(s.issues.map(e=>finalizeIssue(e,i,config())))}:{success:!0,data:s.value}},safeParse$1=_safeParse($ZodRealError),_safeParseAsync=e=>async(r,t,n)=>{const i=n?Object.assign(n,{async:!0}):{async:!0};let s=r._zod.run({value:t,issues:[]},i);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new e(s.issues.map(e=>finalizeIssue(e,i,config())))}:{success:!0,data:s.value}},safeParseAsync$1=_safeParseAsync($ZodRealError),_encode=e=>(r,t,n)=>{const i=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return _parse(e)(r,t,i)},_decode=e=>(r,t,n)=>_parse(e)(r,t,n),_encodeAsync=e=>async(r,t,n)=>{const i=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return _parseAsync(e)(r,t,i)},_decodeAsync=e=>async(r,t,n)=>_parseAsync(e)(r,t,n),_safeEncode=e=>(r,t,n)=>{const i=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return _safeParse(e)(r,t,i)},_safeDecode=e=>(r,t,n)=>_safeParse(e)(r,t,n),_safeEncodeAsync=e=>async(r,t,n)=>{const i=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return _safeParseAsync(e)(r,t,i)},_safeDecodeAsync=e=>async(r,t,n)=>_safeParseAsync(e)(r,t,n),cuid=/^[cC][^\s-]{8,}$/,cuid2=/^[0-9a-z]+$/,ulid=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,xid=/^[0-9a-vA-V]{20}$/,ksuid=/^[A-Za-z0-9]{27}$/,nanoid=/^[a-zA-Z0-9_-]{21}$/,duration$1=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,guid=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,uuid=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,email=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,_emoji$1="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function emoji(){return new RegExp(_emoji$1,"u")}const ipv4=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,cidrv4=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,cidrv6=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,base64url=/^[A-Za-z0-9_-]*$/,hostname=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,e164=/^\+(?:[0-9]){6,14}[0-9]$/,dateSource="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",date$1=new RegExp(`^${dateSource}$`);function timeSource(e){const r="(?:[01]\\d|2[0-3]):[0-5]\\d";return"number"==typeof e.precision?-1===e.precision?`${r}`:0===e.precision?`${r}:[0-5]\\d`:`${r}:[0-5]\\d\\.\\d{${e.precision}}`:`${r}(?::[0-5]\\d(?:\\.\\d+)?)?`}function time$1(e){return new RegExp(`^${timeSource(e)}$`)}function datetime$1(e){const r=timeSource({precision:e.precision}),t=["Z"];e.local&&t.push(""),e.offset&&t.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const n=`${r}(?:${t.join("|")})`;return new RegExp(`^${dateSource}T(?:${n})$`)}const string$1=e=>new RegExp(`^${e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*"}$`),boolean$1=/^(?:true|false)$/i,lowercase=/^[^A-Z]*$/,uppercase=/^[^a-z]*$/,$ZodCheck=$constructor("$ZodCheck",(e,r)=>{var t;e._zod??(e._zod={}),e._zod.def=r,(t=e._zod).onattach??(t.onattach=[])}),$ZodCheckMaxLength=$constructor("$ZodCheckMaxLength",(e,r)=>{var t;$ZodCheck.init(e,r),(t=e._zod.def).when??(t.when=e=>{const r=e.value;return!nullish(r)&&void 0!==r.length}),e._zod.onattach.push(e=>{const t=e._zod.bag.maximum??Number.POSITIVE_INFINITY;r.maximum<t&&(e._zod.bag.maximum=r.maximum)}),e._zod.check=t=>{const n=t.value;if(n.length<=r.maximum)return;const i=getLengthableOrigin(n);t.issues.push({origin:i,code:"too_big",maximum:r.maximum,inclusive:!0,input:n,inst:e,continue:!r.abort})}}),$ZodCheckMinLength=$constructor("$ZodCheckMinLength",(e,r)=>{var t;$ZodCheck.init(e,r),(t=e._zod.def).when??(t.when=e=>{const r=e.value;return!nullish(r)&&void 0!==r.length}),e._zod.onattach.push(e=>{const t=e._zod.bag.minimum??Number.NEGATIVE_INFINITY;r.minimum>t&&(e._zod.bag.minimum=r.minimum)}),e._zod.check=t=>{const n=t.value;if(n.length>=r.minimum)return;const i=getLengthableOrigin(n);t.issues.push({origin:i,code:"too_small",minimum:r.minimum,inclusive:!0,input:n,inst:e,continue:!r.abort})}}),$ZodCheckLengthEquals=$constructor("$ZodCheckLengthEquals",(e,r)=>{var t;$ZodCheck.init(e,r),(t=e._zod.def).when??(t.when=e=>{const r=e.value;return!nullish(r)&&void 0!==r.length}),e._zod.onattach.push(e=>{const t=e._zod.bag;t.minimum=r.length,t.maximum=r.length,t.length=r.length}),e._zod.check=t=>{const n=t.value,i=n.length;if(i===r.length)return;const s=getLengthableOrigin(n),o=i>r.length;t.issues.push({origin:s,...o?{code:"too_big",maximum:r.length}:{code:"too_small",minimum:r.length},inclusive:!0,exact:!0,input:t.value,inst:e,continue:!r.abort})}}),$ZodCheckStringFormat=$constructor("$ZodCheckStringFormat",(e,r)=>{var t,n;$ZodCheck.init(e,r),e._zod.onattach.push(e=>{const t=e._zod.bag;t.format=r.format,r.pattern&&(t.patterns??(t.patterns=new Set),t.patterns.add(r.pattern))}),r.pattern?(t=e._zod).check??(t.check=t=>{r.pattern.lastIndex=0,r.pattern.test(t.value)||t.issues.push({origin:"string",code:"invalid_format",format:r.format,input:t.value,...r.pattern?{pattern:r.pattern.toString()}:{},inst:e,continue:!r.abort})}):(n=e._zod).check??(n.check=()=>{})}),$ZodCheckRegex=$constructor("$ZodCheckRegex",(e,r)=>{$ZodCheckStringFormat.init(e,r),e._zod.check=t=>{r.pattern.lastIndex=0,r.pattern.test(t.value)||t.issues.push({origin:"string",code:"invalid_format",format:"regex",input:t.value,pattern:r.pattern.toString(),inst:e,continue:!r.abort})}}),$ZodCheckLowerCase=$constructor("$ZodCheckLowerCase",(e,r)=>{r.pattern??(r.pattern=lowercase),$ZodCheckStringFormat.init(e,r)}),$ZodCheckUpperCase=$constructor("$ZodCheckUpperCase",(e,r)=>{r.pattern??(r.pattern=uppercase),$ZodCheckStringFormat.init(e,r)}),$ZodCheckIncludes=$constructor("$ZodCheckIncludes",(e,r)=>{$ZodCheck.init(e,r);const t=escapeRegex(r.includes),n=new RegExp("number"==typeof r.position?`^.{${r.position}}${t}`:t);r.pattern=n,e._zod.onattach.push(e=>{const r=e._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(n)}),e._zod.check=t=>{t.value.includes(r.includes,r.position)||t.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:r.includes,input:t.value,inst:e,continue:!r.abort})}}),$ZodCheckStartsWith=$constructor("$ZodCheckStartsWith",(e,r)=>{$ZodCheck.init(e,r);const t=new RegExp(`^${escapeRegex(r.prefix)}.*`);r.pattern??(r.pattern=t),e._zod.onattach.push(e=>{const r=e._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(t)}),e._zod.check=t=>{t.value.startsWith(r.prefix)||t.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:r.prefix,input:t.value,inst:e,continue:!r.abort})}}),$ZodCheckEndsWith=$constructor("$ZodCheckEndsWith",(e,r)=>{$ZodCheck.init(e,r);const t=new RegExp(`.*${escapeRegex(r.suffix)}$`);r.pattern??(r.pattern=t),e._zod.onattach.push(e=>{const r=e._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(t)}),e._zod.check=t=>{t.value.endsWith(r.suffix)||t.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:r.suffix,input:t.value,inst:e,continue:!r.abort})}}),$ZodCheckOverwrite=$constructor("$ZodCheckOverwrite",(e,r)=>{$ZodCheck.init(e,r),e._zod.check=e=>{e.value=r.tx(e.value)}});class Doc{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if("function"==typeof e)return e(this,{execution:"sync"}),void e(this,{execution:"async"});const r=e.split("\n").filter(e=>e),t=Math.min(...r.map(e=>e.length-e.trimStart().length)),n=r.map(e=>e.slice(t)).map(e=>" ".repeat(2*this.indent)+e);for(const e of n)this.content.push(e)}compile(){const e=Function,r=this?.args;return new e(...r,[...(this?.content??[""]).map(e=>`  ${e}`)].join("\n"))}}const version$1={major:4,minor:1,patch:12},$ZodType=$constructor("$ZodType",(e,r)=>{var t;e??(e={}),e._zod.def=r,e._zod.bag=e._zod.bag||{},e._zod.version=version$1;const n=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&n.unshift(e);for(const r of n)for(const t of r._zod.onattach)t(e);if(0===n.length)(t=e._zod).deferred??(t.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{const r=(e,r,t)=>{let n,i=aborted(e);for(const s of r){if(s._zod.def.when){if(!s._zod.def.when(e))continue}else if(i)continue;const r=e.issues.length,o=s._zod.check(e);if(o instanceof Promise&&!1===t?.async)throw new $ZodAsyncError;if(n||o instanceof Promise)n=(n??Promise.resolve()).then(async()=>{await o;e.issues.length!==r&&(i||(i=aborted(e,r)))});else{if(e.issues.length===r)continue;i||(i=aborted(e,r))}}return n?n.then(()=>e):e},t=(t,i,s)=>{if(aborted(t))return t.aborted=!0,t;const o=r(i,n,s);if(o instanceof Promise){if(!1===s.async)throw new $ZodAsyncError;return o.then(r=>e._zod.parse(r,s))}return e._zod.parse(o,s)};e._zod.run=(i,s)=>{if(s.skipChecks)return e._zod.parse(i,s);if("backward"===s.direction){const r=e._zod.parse({value:i.value,issues:[]},{...s,skipChecks:!0});return r instanceof Promise?r.then(e=>t(e,i,s)):t(r,i,s)}const o=e._zod.parse(i,s);if(o instanceof Promise){if(!1===s.async)throw new $ZodAsyncError;return o.then(e=>r(e,n,s))}return r(o,n,s)}}e["~standard"]={validate:r=>{try{const t=safeParse$1(e,r);return t.success?{value:t.data}:{issues:t.error?.issues}}catch(t){return safeParseAsync$1(e,r).then(e=>e.success?{value:e.data}:{issues:e.error?.issues})}},vendor:"zod",version:1}}),$ZodString=$constructor("$ZodString",(e,r)=>{$ZodType.init(e,r),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??string$1(e._zod.bag),e._zod.parse=(t,n)=>{if(r.coerce)try{t.value=String(t.value)}catch(n){}return"string"==typeof t.value||t.issues.push({expected:"string",code:"invalid_type",input:t.value,inst:e}),t}}),$ZodStringFormat=$constructor("$ZodStringFormat",(e,r)=>{$ZodCheckStringFormat.init(e,r),$ZodString.init(e,r)}),$ZodGUID=$constructor("$ZodGUID",(e,r)=>{r.pattern??(r.pattern=guid),$ZodStringFormat.init(e,r)}),$ZodUUID=$constructor("$ZodUUID",(e,r)=>{if(r.version){const e={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[r.version];if(void 0===e)throw new Error(`Invalid UUID version: "${r.version}"`);r.pattern??(r.pattern=uuid(e))}else r.pattern??(r.pattern=uuid());$ZodStringFormat.init(e,r)}),$ZodEmail=$constructor("$ZodEmail",(e,r)=>{r.pattern??(r.pattern=email),$ZodStringFormat.init(e,r)}),$ZodURL=$constructor("$ZodURL",(e,r)=>{$ZodStringFormat.init(e,r),e._zod.check=t=>{try{const n=t.value.trim(),i=new URL(n);return r.hostname&&(r.hostname.lastIndex=0,r.hostname.test(i.hostname)||t.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:hostname.source,input:t.value,inst:e,continue:!r.abort})),r.protocol&&(r.protocol.lastIndex=0,r.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||t.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:r.protocol.source,input:t.value,inst:e,continue:!r.abort})),void(r.normalize?t.value=i.href:t.value=n)}catch(n){t.issues.push({code:"invalid_format",format:"url",input:t.value,inst:e,continue:!r.abort})}}}),$ZodEmoji=$constructor("$ZodEmoji",(e,r)=>{r.pattern??(r.pattern=emoji()),$ZodStringFormat.init(e,r)}),$ZodNanoID=$constructor("$ZodNanoID",(e,r)=>{r.pattern??(r.pattern=nanoid),$ZodStringFormat.init(e,r)}),$ZodCUID=$constructor("$ZodCUID",(e,r)=>{r.pattern??(r.pattern=cuid),$ZodStringFormat.init(e,r)}),$ZodCUID2=$constructor("$ZodCUID2",(e,r)=>{r.pattern??(r.pattern=cuid2),$ZodStringFormat.init(e,r)}),$ZodULID=$constructor("$ZodULID",(e,r)=>{r.pattern??(r.pattern=ulid),$ZodStringFormat.init(e,r)}),$ZodXID=$constructor("$ZodXID",(e,r)=>{r.pattern??(r.pattern=xid),$ZodStringFormat.init(e,r)}),$ZodKSUID=$constructor("$ZodKSUID",(e,r)=>{r.pattern??(r.pattern=ksuid),$ZodStringFormat.init(e,r)}),$ZodISODateTime=$constructor("$ZodISODateTime",(e,r)=>{r.pattern??(r.pattern=datetime$1(r)),$ZodStringFormat.init(e,r)}),$ZodISODate=$constructor("$ZodISODate",(e,r)=>{r.pattern??(r.pattern=date$1),$ZodStringFormat.init(e,r)}),$ZodISOTime=$constructor("$ZodISOTime",(e,r)=>{r.pattern??(r.pattern=time$1(r)),$ZodStringFormat.init(e,r)}),$ZodISODuration=$constructor("$ZodISODuration",(e,r)=>{r.pattern??(r.pattern=duration$1),$ZodStringFormat.init(e,r)}),$ZodIPv4=$constructor("$ZodIPv4",(e,r)=>{r.pattern??(r.pattern=ipv4),$ZodStringFormat.init(e,r),e._zod.onattach.push(e=>{e._zod.bag.format="ipv4"})}),$ZodIPv6=$constructor("$ZodIPv6",(e,r)=>{r.pattern??(r.pattern=ipv6),$ZodStringFormat.init(e,r),e._zod.onattach.push(e=>{e._zod.bag.format="ipv6"}),e._zod.check=t=>{try{new URL(`http://[${t.value}]`)}catch{t.issues.push({code:"invalid_format",format:"ipv6",input:t.value,inst:e,continue:!r.abort})}}}),$ZodCIDRv4=$constructor("$ZodCIDRv4",(e,r)=>{r.pattern??(r.pattern=cidrv4),$ZodStringFormat.init(e,r)}),$ZodCIDRv6=$constructor("$ZodCIDRv6",(e,r)=>{r.pattern??(r.pattern=cidrv6),$ZodStringFormat.init(e,r),e._zod.check=t=>{const n=t.value.split("/");try{if(2!==n.length)throw new Error;const[e,r]=n;if(!r)throw new Error;const t=Number(r);if(`${t}`!==r)throw new Error;if(t<0||t>128)throw new Error;new URL(`http://[${e}]`)}catch{t.issues.push({code:"invalid_format",format:"cidrv6",input:t.value,inst:e,continue:!r.abort})}}});function isValidBase64(e){if(""===e)return!0;if(e.length%4!=0)return!1;try{return atob(e),!0}catch{return!1}}const $ZodBase64=$constructor("$ZodBase64",(e,r)=>{r.pattern??(r.pattern=base64),$ZodStringFormat.init(e,r),e._zod.onattach.push(e=>{e._zod.bag.contentEncoding="base64"}),e._zod.check=t=>{isValidBase64(t.value)||t.issues.push({code:"invalid_format",format:"base64",input:t.value,inst:e,continue:!r.abort})}});function isValidBase64URL(e){if(!base64url.test(e))return!1;const r=e.replace(/[-_]/g,e=>"-"===e?"+":"/");return isValidBase64(r.padEnd(4*Math.ceil(r.length/4),"="))}const $ZodBase64URL=$constructor("$ZodBase64URL",(e,r)=>{r.pattern??(r.pattern=base64url),$ZodStringFormat.init(e,r),e._zod.onattach.push(e=>{e._zod.bag.contentEncoding="base64url"}),e._zod.check=t=>{isValidBase64URL(t.value)||t.issues.push({code:"invalid_format",format:"base64url",input:t.value,inst:e,continue:!r.abort})}}),$ZodE164=$constructor("$ZodE164",(e,r)=>{r.pattern??(r.pattern=e164),$ZodStringFormat.init(e,r)});function isValidJWT(e,r=null){try{const t=e.split(".");if(3!==t.length)return!1;const[n]=t;if(!n)return!1;const i=JSON.parse(atob(n));return(!("typ"in i)||"JWT"===i?.typ)&&(!!i.alg&&(!r||"alg"in i&&i.alg===r))}catch{return!1}}const $ZodJWT=$constructor("$ZodJWT",(e,r)=>{$ZodStringFormat.init(e,r),e._zod.check=t=>{isValidJWT(t.value,r.alg)||t.issues.push({code:"invalid_format",format:"jwt",input:t.value,inst:e,continue:!r.abort})}}),$ZodBoolean=$constructor("$ZodBoolean",(e,r)=>{$ZodType.init(e,r),e._zod.pattern=boolean$1,e._zod.parse=(t,n)=>{if(r.coerce)try{t.value=Boolean(t.value)}catch(e){}const i=t.value;return"boolean"==typeof i||t.issues.push({expected:"boolean",code:"invalid_type",input:i,inst:e}),t}}),$ZodUnknown=$constructor("$ZodUnknown",(e,r)=>{$ZodType.init(e,r),e._zod.parse=e=>e}),$ZodNever=$constructor("$ZodNever",(e,r)=>{$ZodType.init(e,r),e._zod.parse=(r,t)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:e}),r)});function handleArrayResult(e,r,t){e.issues.length&&r.issues.push(...prefixIssues(t,e.issues)),r.value[t]=e.value}const $ZodArray=$constructor("$ZodArray",(e,r)=>{$ZodType.init(e,r),e._zod.parse=(t,n)=>{const i=t.value;if(!Array.isArray(i))return t.issues.push({expected:"array",code:"invalid_type",input:i,inst:e}),t;t.value=Array(i.length);const s=[];for(let e=0;e<i.length;e++){const o=i[e],a=r.element._zod.run({value:o,issues:[]},n);a instanceof Promise?s.push(a.then(r=>handleArrayResult(r,t,e))):handleArrayResult(a,t,e)}return s.length?Promise.all(s).then(()=>t):t}});function handlePropertyResult(e,r,t,n){e.issues.length&&r.issues.push(...prefixIssues(t,e.issues)),void 0===e.value?t in n&&(r.value[t]=void 0):r.value[t]=e.value}function normalizeDef(e){const r=Object.keys(e.shape);for(const t of r)if(!e.shape?.[t]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${t}": expected a Zod schema`);const t=optionalKeys(e.shape);return{...e,keys:r,keySet:new Set(r),numKeys:r.length,optionalKeys:new Set(t)}}function handleCatchall(e,r,t,n,i,s){const o=[],a=i.keySet,c=i.catchall._zod,u=c.def.type;for(const i of Object.keys(r)){if(a.has(i))continue;if("never"===u){o.push(i);continue}const s=c.run({value:r[i],issues:[]},n);s instanceof Promise?e.push(s.then(e=>handlePropertyResult(e,t,i,r))):handlePropertyResult(s,t,i,r)}return o.length&&t.issues.push({code:"unrecognized_keys",keys:o,input:r,inst:s}),e.length?Promise.all(e).then(()=>t):t}const $ZodObject=$constructor("$ZodObject",(e,r)=>{$ZodType.init(e,r);const t=Object.getOwnPropertyDescriptor(r,"shape");if(!t?.get){const e=r.shape;Object.defineProperty(r,"shape",{get:()=>{const t={...e};return Object.defineProperty(r,"shape",{value:t}),t}})}const n=cached(()=>normalizeDef(r));defineLazy(e._zod,"propValues",()=>{const e=r.shape,t={};for(const r in e){const n=e[r]._zod;if(n.values){t[r]??(t[r]=new Set);for(const e of n.values)t[r].add(e)}}return t});const i=isObject,s=r.catchall;let o;e._zod.parse=(r,t)=>{o??(o=n.value);const a=r.value;if(!i(a))return r.issues.push({expected:"object",code:"invalid_type",input:a,inst:e}),r;r.value={};const c=[],u=o.shape;for(const e of o.keys){const n=u[e]._zod.run({value:a[e],issues:[]},t);n instanceof Promise?c.push(n.then(t=>handlePropertyResult(t,r,e,a))):handlePropertyResult(n,r,e,a)}return s?handleCatchall(c,a,r,t,n.value,e):c.length?Promise.all(c).then(()=>r):r}}),$ZodObjectJIT=$constructor("$ZodObjectJIT",(e,r)=>{$ZodObject.init(e,r);const t=e._zod.parse,n=cached(()=>normalizeDef(r));let i;const s=isObject,o=!globalConfig.jitless,a=o&&allowsEval.value,c=r.catchall;let u;e._zod.parse=(l,d)=>{u??(u=n.value);const p=l.value;return s(p)?o&&a&&!1===d?.async&&!0!==d.jitless?(i||(i=(e=>{const r=new Doc(["shape","payload","ctx"]),t=n.value,i=e=>{const r=esc(e);return`shape[${r}]._zod.run({ value: input[${r}], issues: [] }, ctx)`};r.write("const input = payload.value;");const s=Object.create(null);let o=0;for(const e of t.keys)s[e]="key_"+o++;r.write("const newResult = {};");for(const e of t.keys){const t=s[e],n=esc(e);r.write(`const ${t} = ${i(e)};`),r.write(`\n        if (${t}.issues.length) {\n          payload.issues = payload.issues.concat(${t}.issues.map(iss => ({\n            ...iss,\n            path: iss.path ? [${n}, ...iss.path] : [${n}]\n          })));\n        }\n        \n        \n        if (${t}.value === undefined) {\n          if (${n} in input) {\n            newResult[${n}] = undefined;\n          }\n        } else {\n          newResult[${n}] = ${t}.value;\n        }\n        \n      `)}r.write("payload.value = newResult;"),r.write("return payload;");const a=r.compile();return(r,t)=>a(e,r,t)})(r.shape)),l=i(l,d),c?handleCatchall([],p,l,d,u,e):l):t(l,d):(l.issues.push({expected:"object",code:"invalid_type",input:p,inst:e}),l)}});function handleUnionResults(e,r,t,n){for(const t of e)if(0===t.issues.length)return r.value=t.value,r;const i=e.filter(e=>!aborted(e));return 1===i.length?(r.value=i[0].value,i[0]):(r.issues.push({code:"invalid_union",input:r.value,inst:t,errors:e.map(e=>e.issues.map(e=>finalizeIssue(e,n,config())))}),r)}const $ZodUnion=$constructor("$ZodUnion",(e,r)=>{$ZodType.init(e,r),defineLazy(e._zod,"optin",()=>r.options.some(e=>"optional"===e._zod.optin)?"optional":void 0),defineLazy(e._zod,"optout",()=>r.options.some(e=>"optional"===e._zod.optout)?"optional":void 0),defineLazy(e._zod,"values",()=>{if(r.options.every(e=>e._zod.values))return new Set(r.options.flatMap(e=>Array.from(e._zod.values)))}),defineLazy(e._zod,"pattern",()=>{if(r.options.every(e=>e._zod.pattern)){const e=r.options.map(e=>e._zod.pattern);return new RegExp(`^(${e.map(e=>cleanRegex(e.source)).join("|")})$`)}});const t=1===r.options.length,n=r.options[0]._zod.run;e._zod.parse=(i,s)=>{if(t)return n(i,s);let o=!1;const a=[];for(const e of r.options){const r=e._zod.run({value:i.value,issues:[]},s);if(r instanceof Promise)a.push(r),o=!0;else{if(0===r.issues.length)return r;a.push(r)}}return o?Promise.all(a).then(r=>handleUnionResults(r,i,e,s)):handleUnionResults(a,i,e,s)}}),$ZodIntersection=$constructor("$ZodIntersection",(e,r)=>{$ZodType.init(e,r),e._zod.parse=(e,t)=>{const n=e.value,i=r.left._zod.run({value:n,issues:[]},t),s=r.right._zod.run({value:n,issues:[]},t);return i instanceof Promise||s instanceof Promise?Promise.all([i,s]).then(([r,t])=>handleIntersectionResults(e,r,t)):handleIntersectionResults(e,i,s)}});function mergeValues(e,r){if(e===r)return{valid:!0,data:e};if(e instanceof Date&&r instanceof Date&&+e===+r)return{valid:!0,data:e};if(isPlainObject(e)&&isPlainObject(r)){const t=Object.keys(r),n=Object.keys(e).filter(e=>-1!==t.indexOf(e)),i={...e,...r};for(const t of n){const n=mergeValues(e[t],r[t]);if(!n.valid)return{valid:!1,mergeErrorPath:[t,...n.mergeErrorPath]};i[t]=n.data}return{valid:!0,data:i}}if(Array.isArray(e)&&Array.isArray(r)){if(e.length!==r.length)return{valid:!1,mergeErrorPath:[]};const t=[];for(let n=0;n<e.length;n++){const i=mergeValues(e[n],r[n]);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};t.push(i.data)}return{valid:!0,data:t}}return{valid:!1,mergeErrorPath:[]}}function handleIntersectionResults(e,r,t){if(r.issues.length&&e.issues.push(...r.issues),t.issues.length&&e.issues.push(...t.issues),aborted(e))return e;const n=mergeValues(r.value,t.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return e.value=n.data,e}const $ZodRecord=$constructor("$ZodRecord",(e,r)=>{$ZodType.init(e,r),e._zod.parse=(t,n)=>{const i=t.value;if(!isPlainObject(i))return t.issues.push({expected:"record",code:"invalid_type",input:i,inst:e}),t;const s=[];if(r.keyType._zod.values){const o=r.keyType._zod.values;t.value={};for(const e of o)if("string"==typeof e||"number"==typeof e||"symbol"==typeof e){const o=r.valueType._zod.run({value:i[e],issues:[]},n);o instanceof Promise?s.push(o.then(r=>{r.issues.length&&t.issues.push(...prefixIssues(e,r.issues)),t.value[e]=r.value})):(o.issues.length&&t.issues.push(...prefixIssues(e,o.issues)),t.value[e]=o.value)}let a;for(const e in i)o.has(e)||(a=a??[],a.push(e));a&&a.length>0&&t.issues.push({code:"unrecognized_keys",input:i,inst:e,keys:a})}else{t.value={};for(const o of Reflect.ownKeys(i)){if("__proto__"===o)continue;const a=r.keyType._zod.run({value:o,issues:[]},n);if(a instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(a.issues.length){t.issues.push({code:"invalid_key",origin:"record",issues:a.issues.map(e=>finalizeIssue(e,n,config())),input:o,path:[o],inst:e}),t.value[a.value]=a.value;continue}const c=r.valueType._zod.run({value:i[o],issues:[]},n);c instanceof Promise?s.push(c.then(e=>{e.issues.length&&t.issues.push(...prefixIssues(o,e.issues)),t.value[a.value]=e.value})):(c.issues.length&&t.issues.push(...prefixIssues(o,c.issues)),t.value[a.value]=c.value)}}return s.length?Promise.all(s).then(()=>t):t}}),$ZodEnum=$constructor("$ZodEnum",(e,r)=>{$ZodType.init(e,r);const t=getEnumValues(r.entries),n=new Set(t);e._zod.values=n,e._zod.pattern=new RegExp(`^(${t.filter(e=>propertyKeyTypes.has(typeof e)).map(e=>"string"==typeof e?escapeRegex(e):e.toString()).join("|")})$`),e._zod.parse=(r,i)=>{const s=r.value;return n.has(s)||r.issues.push({code:"invalid_value",values:t,input:s,inst:e}),r}}),$ZodLiteral=$constructor("$ZodLiteral",(e,r)=>{if($ZodType.init(e,r),0===r.values.length)throw new Error("Cannot create literal schema with no valid values");e._zod.values=new Set(r.values),e._zod.pattern=new RegExp(`^(${r.values.map(e=>"string"==typeof e?escapeRegex(e):e?escapeRegex(e.toString()):String(e)).join("|")})$`),e._zod.parse=(t,n)=>{const i=t.value;return e._zod.values.has(i)||t.issues.push({code:"invalid_value",values:r.values,input:i,inst:e}),t}}),$ZodTransform=$constructor("$ZodTransform",(e,r)=>{$ZodType.init(e,r),e._zod.parse=(t,n)=>{if("backward"===n.direction)throw new $ZodEncodeError(e.constructor.name);const i=r.transform(t.value,t);if(n.async){return(i instanceof Promise?i:Promise.resolve(i)).then(e=>(t.value=e,t))}if(i instanceof Promise)throw new $ZodAsyncError;return t.value=i,t}});function handleOptionalResult(e,r){return e.issues.length&&void 0===r?{issues:[],value:void 0}:e}const $ZodOptional=$constructor("$ZodOptional",(e,r)=>{$ZodType.init(e,r),e._zod.optin="optional",e._zod.optout="optional",defineLazy(e._zod,"values",()=>r.innerType._zod.values?new Set([...r.innerType._zod.values,void 0]):void 0),defineLazy(e._zod,"pattern",()=>{const e=r.innerType._zod.pattern;return e?new RegExp(`^(${cleanRegex(e.source)})?$`):void 0}),e._zod.parse=(e,t)=>{if("optional"===r.innerType._zod.optin){const n=r.innerType._zod.run(e,t);return n instanceof Promise?n.then(r=>handleOptionalResult(r,e.value)):handleOptionalResult(n,e.value)}return void 0===e.value?e:r.innerType._zod.run(e,t)}}),$ZodNullable=$constructor("$ZodNullable",(e,r)=>{$ZodType.init(e,r),defineLazy(e._zod,"optin",()=>r.innerType._zod.optin),defineLazy(e._zod,"optout",()=>r.innerType._zod.optout),defineLazy(e._zod,"pattern",()=>{const e=r.innerType._zod.pattern;return e?new RegExp(`^(${cleanRegex(e.source)}|null)$`):void 0}),defineLazy(e._zod,"values",()=>r.innerType._zod.values?new Set([...r.innerType._zod.values,null]):void 0),e._zod.parse=(e,t)=>null===e.value?e:r.innerType._zod.run(e,t)}),$ZodDefault=$constructor("$ZodDefault",(e,r)=>{$ZodType.init(e,r),e._zod.optin="optional",defineLazy(e._zod,"values",()=>r.innerType._zod.values),e._zod.parse=(e,t)=>{if("backward"===t.direction)return r.innerType._zod.run(e,t);if(void 0===e.value)return e.value=r.defaultValue,e;const n=r.innerType._zod.run(e,t);return n instanceof Promise?n.then(e=>handleDefaultResult(e,r)):handleDefaultResult(n,r)}});function handleDefaultResult(e,r){return void 0===e.value&&(e.value=r.defaultValue),e}const $ZodPrefault=$constructor("$ZodPrefault",(e,r)=>{$ZodType.init(e,r),e._zod.optin="optional",defineLazy(e._zod,"values",()=>r.innerType._zod.values),e._zod.parse=(e,t)=>("backward"===t.direction||void 0===e.value&&(e.value=r.defaultValue),r.innerType._zod.run(e,t))}),$ZodNonOptional=$constructor("$ZodNonOptional",(e,r)=>{$ZodType.init(e,r),defineLazy(e._zod,"values",()=>{const e=r.innerType._zod.values;return e?new Set([...e].filter(e=>void 0!==e)):void 0}),e._zod.parse=(t,n)=>{const i=r.innerType._zod.run(t,n);return i instanceof Promise?i.then(r=>handleNonOptionalResult(r,e)):handleNonOptionalResult(i,e)}});function handleNonOptionalResult(e,r){return e.issues.length||void 0!==e.value||e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:r}),e}const $ZodCatch=$constructor("$ZodCatch",(e,r)=>{$ZodType.init(e,r),defineLazy(e._zod,"optin",()=>r.innerType._zod.optin),defineLazy(e._zod,"optout",()=>r.innerType._zod.optout),defineLazy(e._zod,"values",()=>r.innerType._zod.values),e._zod.parse=(e,t)=>{if("backward"===t.direction)return r.innerType._zod.run(e,t);const n=r.innerType._zod.run(e,t);return n instanceof Promise?n.then(n=>(e.value=n.value,n.issues.length&&(e.value=r.catchValue({...e,error:{issues:n.issues.map(e=>finalizeIssue(e,t,config()))},input:e.value}),e.issues=[]),e)):(e.value=n.value,n.issues.length&&(e.value=r.catchValue({...e,error:{issues:n.issues.map(e=>finalizeIssue(e,t,config()))},input:e.value}),e.issues=[]),e)}}),$ZodPipe=$constructor("$ZodPipe",(e,r)=>{$ZodType.init(e,r),defineLazy(e._zod,"values",()=>r.in._zod.values),defineLazy(e._zod,"optin",()=>r.in._zod.optin),defineLazy(e._zod,"optout",()=>r.out._zod.optout),defineLazy(e._zod,"propValues",()=>r.in._zod.propValues),e._zod.parse=(e,t)=>{if("backward"===t.direction){const n=r.out._zod.run(e,t);return n instanceof Promise?n.then(e=>handlePipeResult(e,r.in,t)):handlePipeResult(n,r.in,t)}const n=r.in._zod.run(e,t);return n instanceof Promise?n.then(e=>handlePipeResult(e,r.out,t)):handlePipeResult(n,r.out,t)}});function handlePipeResult(e,r,t){return e.issues.length?(e.aborted=!0,e):r._zod.run({value:e.value,issues:e.issues},t)}const $ZodReadonly=$constructor("$ZodReadonly",(e,r)=>{$ZodType.init(e,r),defineLazy(e._zod,"propValues",()=>r.innerType._zod.propValues),defineLazy(e._zod,"values",()=>r.innerType._zod.values),defineLazy(e._zod,"optin",()=>r.innerType._zod.optin),defineLazy(e._zod,"optout",()=>r.innerType._zod.optout),e._zod.parse=(e,t)=>{if("backward"===t.direction)return r.innerType._zod.run(e,t);const n=r.innerType._zod.run(e,t);return n instanceof Promise?n.then(handleReadonlyResult):handleReadonlyResult(n)}});function handleReadonlyResult(e){return e.value=Object.freeze(e.value),e}const $ZodCustom=$constructor("$ZodCustom",(e,r)=>{$ZodCheck.init(e,r),$ZodType.init(e,r),e._zod.parse=(e,r)=>e,e._zod.check=t=>{const n=t.value,i=r.fn(n);if(i instanceof Promise)return i.then(r=>handleRefineResult(r,t,n,e));handleRefineResult(i,t,n,e)}});function handleRefineResult(e,r,t,n){if(!e){const e={code:"custom",input:t,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(e.params=n._zod.def.params),r.issues.push(issue(e))}}class $ZodRegistry{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...r){const t=r[0];if(this._map.set(e,t),t&&"object"==typeof t&&"id"in t){if(this._idmap.has(t.id))throw new Error(`ID ${t.id} already exists in the registry`);this._idmap.set(t.id,e)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){const r=this._map.get(e);return r&&"object"==typeof r&&"id"in r&&this._idmap.delete(r.id),this._map.delete(e),this}get(e){const r=e._zod.parent;if(r){const t={...this.get(r)??{}};delete t.id;const n={...t,...this._map.get(e)};return Object.keys(n).length?n:void 0}return this._map.get(e)}has(e){return this._map.has(e)}}function registry(){return new $ZodRegistry}const globalRegistry=registry();function _string(e,r){return new e({type:"string",...normalizeParams(r)})}function _email(e,r){return new e({type:"string",format:"email",check:"string_format",abort:!1,...normalizeParams(r)})}function _guid(e,r){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...normalizeParams(r)})}function _uuid(e,r){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...normalizeParams(r)})}function _uuidv4(e,r){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...normalizeParams(r)})}function _uuidv6(e,r){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...normalizeParams(r)})}function _uuidv7(e,r){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...normalizeParams(r)})}function _url(e,r){return new e({type:"string",format:"url",check:"string_format",abort:!1,...normalizeParams(r)})}function _emoji(e,r){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...normalizeParams(r)})}function _nanoid(e,r){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...normalizeParams(r)})}function _cuid(e,r){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...normalizeParams(r)})}function _cuid2(e,r){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...normalizeParams(r)})}function _ulid(e,r){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...normalizeParams(r)})}function _xid(e,r){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...normalizeParams(r)})}function _ksuid(e,r){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...normalizeParams(r)})}function _ipv4(e,r){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...normalizeParams(r)})}function _ipv6(e,r){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...normalizeParams(r)})}function _cidrv4(e,r){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...normalizeParams(r)})}function _cidrv6(e,r){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...normalizeParams(r)})}function _base64(e,r){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...normalizeParams(r)})}function _base64url(e,r){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...normalizeParams(r)})}function _e164(e,r){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...normalizeParams(r)})}function _jwt(e,r){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...normalizeParams(r)})}function _isoDateTime(e,r){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...normalizeParams(r)})}function _isoDate(e,r){return new e({type:"string",format:"date",check:"string_format",...normalizeParams(r)})}function _isoTime(e,r){return new e({type:"string",format:"time",check:"string_format",precision:null,...normalizeParams(r)})}function _isoDuration(e,r){return new e({type:"string",format:"duration",check:"string_format",...normalizeParams(r)})}function _boolean(e,r){return new e({type:"boolean",...normalizeParams(r)})}function _unknown(e){return new e({type:"unknown"})}function _never(e,r){return new e({type:"never",...normalizeParams(r)})}function _maxLength(e,r){return new $ZodCheckMaxLength({check:"max_length",...normalizeParams(r),maximum:e})}function _minLength(e,r){return new $ZodCheckMinLength({check:"min_length",...normalizeParams(r),minimum:e})}function _length(e,r){return new $ZodCheckLengthEquals({check:"length_equals",...normalizeParams(r),length:e})}function _regex(e,r){return new $ZodCheckRegex({check:"string_format",format:"regex",...normalizeParams(r),pattern:e})}function _lowercase(e){return new $ZodCheckLowerCase({check:"string_format",format:"lowercase",...normalizeParams(e)})}function _uppercase(e){return new $ZodCheckUpperCase({check:"string_format",format:"uppercase",...normalizeParams(e)})}function _includes(e,r){return new $ZodCheckIncludes({check:"string_format",format:"includes",...normalizeParams(r),includes:e})}function _startsWith(e,r){return new $ZodCheckStartsWith({check:"string_format",format:"starts_with",...normalizeParams(r),prefix:e})}function _endsWith(e,r){return new $ZodCheckEndsWith({check:"string_format",format:"ends_with",...normalizeParams(r),suffix:e})}function _overwrite(e){return new $ZodCheckOverwrite({check:"overwrite",tx:e})}function _normalize(e){return _overwrite(r=>r.normalize(e))}function _trim(){return _overwrite(e=>e.trim())}function _toLowerCase(){return _overwrite(e=>e.toLowerCase())}function _toUpperCase(){return _overwrite(e=>e.toUpperCase())}function _array(e,r,t){return new e({type:"array",element:r,...normalizeParams(t)})}function _refine(e,r,t){return new e({type:"custom",check:"custom",fn:r,...normalizeParams(t)})}function _superRefine(e){const r=_check(t=>(t.addIssue=e=>{if("string"==typeof e)t.issues.push(issue(e,t.value,r._zod.def));else{const n=e;n.fatal&&(n.continue=!1),n.code??(n.code="custom"),n.input??(n.input=t.value),n.inst??(n.inst=r),n.continue??(n.continue=!r._zod.def.abort),t.issues.push(issue(n))}},e(t.value,t)));return r}function _check(e,r){const t=new $ZodCheck({check:"custom",...normalizeParams(r)});return t._zod.check=e,t}const ZodISODateTime=$constructor("ZodISODateTime",(e,r)=>{$ZodISODateTime.init(e,r),ZodStringFormat.init(e,r)});function datetime(e){return _isoDateTime(ZodISODateTime,e)}const ZodISODate=$constructor("ZodISODate",(e,r)=>{$ZodISODate.init(e,r),ZodStringFormat.init(e,r)});function date(e){return _isoDate(ZodISODate,e)}const ZodISOTime=$constructor("ZodISOTime",(e,r)=>{$ZodISOTime.init(e,r),ZodStringFormat.init(e,r)});function time(e){return _isoTime(ZodISOTime,e)}const ZodISODuration=$constructor("ZodISODuration",(e,r)=>{$ZodISODuration.init(e,r),ZodStringFormat.init(e,r)});function duration(e){return _isoDuration(ZodISODuration,e)}const initializer=(e,r)=>{$ZodError.init(e,r),e.name="ZodError",Object.defineProperties(e,{format:{value:r=>formatError(e,r)},flatten:{value:r=>flattenError(e,r)},addIssue:{value:r=>{e.issues.push(r),e.message=JSON.stringify(e.issues,jsonStringifyReplacer,2)}},addIssues:{value:r=>{e.issues.push(...r),e.message=JSON.stringify(e.issues,jsonStringifyReplacer,2)}},isEmpty:{get:()=>0===e.issues.length}})},ZodRealError=$constructor("ZodError",initializer,{Parent:Error}),parse=_parse(ZodRealError),parseAsync=_parseAsync(ZodRealError),safeParse=_safeParse(ZodRealError),safeParseAsync=_safeParseAsync(ZodRealError),encode=_encode(ZodRealError),decode=_decode(ZodRealError),encodeAsync=_encodeAsync(ZodRealError),decodeAsync=_decodeAsync(ZodRealError),safeEncode=_safeEncode(ZodRealError),safeDecode=_safeDecode(ZodRealError),safeEncodeAsync=_safeEncodeAsync(ZodRealError),safeDecodeAsync=_safeDecodeAsync(ZodRealError),ZodType=$constructor("ZodType",(e,r)=>($ZodType.init(e,r),e.def=r,e.type=r.type,Object.defineProperty(e,"_def",{value:r}),e.check=(...t)=>e.clone(mergeDefs(r,{checks:[...r.checks??[],...t.map(e=>"function"==typeof e?{_zod:{check:e,def:{check:"custom"},onattach:[]}}:e)]})),e.clone=(r,t)=>clone(e,r,t),e.brand=()=>e,e.register=(r,t)=>(r.add(e,t),e),e.parse=(r,t)=>parse(e,r,t,{callee:e.parse}),e.safeParse=(r,t)=>safeParse(e,r,t),e.parseAsync=async(r,t)=>parseAsync(e,r,t,{callee:e.parseAsync}),e.safeParseAsync=async(r,t)=>safeParseAsync(e,r,t),e.spa=e.safeParseAsync,e.encode=(r,t)=>encode(e,r,t),e.decode=(r,t)=>decode(e,r,t),e.encodeAsync=async(r,t)=>encodeAsync(e,r,t),e.decodeAsync=async(r,t)=>decodeAsync(e,r,t),e.safeEncode=(r,t)=>safeEncode(e,r,t),e.safeDecode=(r,t)=>safeDecode(e,r,t),e.safeEncodeAsync=async(r,t)=>safeEncodeAsync(e,r,t),e.safeDecodeAsync=async(r,t)=>safeDecodeAsync(e,r,t),e.refine=(r,t)=>e.check(refine(r,t)),e.superRefine=r=>e.check(superRefine(r)),e.overwrite=r=>e.check(_overwrite(r)),e.optional=()=>optional(e),e.nullable=()=>nullable(e),e.nullish=()=>optional(nullable(e)),e.nonoptional=r=>nonoptional(e,r),e.array=()=>array(e),e.or=r=>union([e,r]),e.and=r=>intersection(e,r),e.transform=r=>pipe(e,transform(r)),e.default=r=>_default(e,r),e.prefault=r=>prefault(e,r),e.catch=r=>_catch(e,r),e.pipe=r=>pipe(e,r),e.readonly=()=>readonly(e),e.describe=r=>{const t=e.clone();return globalRegistry.add(t,{description:r}),t},Object.defineProperty(e,"description",{get:()=>globalRegistry.get(e)?.description,configurable:!0}),e.meta=(...r)=>{if(0===r.length)return globalRegistry.get(e);const t=e.clone();return globalRegistry.add(t,r[0]),t},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),_ZodString=$constructor("_ZodString",(e,r)=>{$ZodString.init(e,r),ZodType.init(e,r);const t=e._zod.bag;e.format=t.format??null,e.minLength=t.minimum??null,e.maxLength=t.maximum??null,e.regex=(...r)=>e.check(_regex(...r)),e.includes=(...r)=>e.check(_includes(...r)),e.startsWith=(...r)=>e.check(_startsWith(...r)),e.endsWith=(...r)=>e.check(_endsWith(...r)),e.min=(...r)=>e.check(_minLength(...r)),e.max=(...r)=>e.check(_maxLength(...r)),e.length=(...r)=>e.check(_length(...r)),e.nonempty=(...r)=>e.check(_minLength(1,...r)),e.lowercase=r=>e.check(_lowercase(r)),e.uppercase=r=>e.check(_uppercase(r)),e.trim=()=>e.check(_trim()),e.normalize=(...r)=>e.check(_normalize(...r)),e.toLowerCase=()=>e.check(_toLowerCase()),e.toUpperCase=()=>e.check(_toUpperCase())}),ZodString=$constructor("ZodString",(e,r)=>{$ZodString.init(e,r),_ZodString.init(e,r),e.email=r=>e.check(_email(ZodEmail,r)),e.url=r=>e.check(_url(ZodURL,r)),e.jwt=r=>e.check(_jwt(ZodJWT,r)),e.emoji=r=>e.check(_emoji(ZodEmoji,r)),e.guid=r=>e.check(_guid(ZodGUID,r)),e.uuid=r=>e.check(_uuid(ZodUUID,r)),e.uuidv4=r=>e.check(_uuidv4(ZodUUID,r)),e.uuidv6=r=>e.check(_uuidv6(ZodUUID,r)),e.uuidv7=r=>e.check(_uuidv7(ZodUUID,r)),e.nanoid=r=>e.check(_nanoid(ZodNanoID,r)),e.guid=r=>e.check(_guid(ZodGUID,r)),e.cuid=r=>e.check(_cuid(ZodCUID,r)),e.cuid2=r=>e.check(_cuid2(ZodCUID2,r)),e.ulid=r=>e.check(_ulid(ZodULID,r)),e.base64=r=>e.check(_base64(ZodBase64,r)),e.base64url=r=>e.check(_base64url(ZodBase64URL,r)),e.xid=r=>e.check(_xid(ZodXID,r)),e.ksuid=r=>e.check(_ksuid(ZodKSUID,r)),e.ipv4=r=>e.check(_ipv4(ZodIPv4,r)),e.ipv6=r=>e.check(_ipv6(ZodIPv6,r)),e.cidrv4=r=>e.check(_cidrv4(ZodCIDRv4,r)),e.cidrv6=r=>e.check(_cidrv6(ZodCIDRv6,r)),e.e164=r=>e.check(_e164(ZodE164,r)),e.datetime=r=>e.check(datetime(r)),e.date=r=>e.check(date(r)),e.time=r=>e.check(time(r)),e.duration=r=>e.check(duration(r))});function string(e){return _string(ZodString,e)}const ZodStringFormat=$constructor("ZodStringFormat",(e,r)=>{$ZodStringFormat.init(e,r),_ZodString.init(e,r)}),ZodEmail=$constructor("ZodEmail",(e,r)=>{$ZodEmail.init(e,r),ZodStringFormat.init(e,r)}),ZodGUID=$constructor("ZodGUID",(e,r)=>{$ZodGUID.init(e,r),ZodStringFormat.init(e,r)}),ZodUUID=$constructor("ZodUUID",(e,r)=>{$ZodUUID.init(e,r),ZodStringFormat.init(e,r)}),ZodURL=$constructor("ZodURL",(e,r)=>{$ZodURL.init(e,r),ZodStringFormat.init(e,r)}),ZodEmoji=$constructor("ZodEmoji",(e,r)=>{$ZodEmoji.init(e,r),ZodStringFormat.init(e,r)}),ZodNanoID=$constructor("ZodNanoID",(e,r)=>{$ZodNanoID.init(e,r),ZodStringFormat.init(e,r)}),ZodCUID=$constructor("ZodCUID",(e,r)=>{$ZodCUID.init(e,r),ZodStringFormat.init(e,r)}),ZodCUID2=$constructor("ZodCUID2",(e,r)=>{$ZodCUID2.init(e,r),ZodStringFormat.init(e,r)}),ZodULID=$constructor("ZodULID",(e,r)=>{$ZodULID.init(e,r),ZodStringFormat.init(e,r)}),ZodXID=$constructor("ZodXID",(e,r)=>{$ZodXID.init(e,r),ZodStringFormat.init(e,r)}),ZodKSUID=$constructor("ZodKSUID",(e,r)=>{$ZodKSUID.init(e,r),ZodStringFormat.init(e,r)}),ZodIPv4=$constructor("ZodIPv4",(e,r)=>{$ZodIPv4.init(e,r),ZodStringFormat.init(e,r)}),ZodIPv6=$constructor("ZodIPv6",(e,r)=>{$ZodIPv6.init(e,r),ZodStringFormat.init(e,r)}),ZodCIDRv4=$constructor("ZodCIDRv4",(e,r)=>{$ZodCIDRv4.init(e,r),ZodStringFormat.init(e,r)}),ZodCIDRv6=$constructor("ZodCIDRv6",(e,r)=>{$ZodCIDRv6.init(e,r),ZodStringFormat.init(e,r)}),ZodBase64=$constructor("ZodBase64",(e,r)=>{$ZodBase64.init(e,r),ZodStringFormat.init(e,r)}),ZodBase64URL=$constructor("ZodBase64URL",(e,r)=>{$ZodBase64URL.init(e,r),ZodStringFormat.init(e,r)}),ZodE164=$constructor("ZodE164",(e,r)=>{$ZodE164.init(e,r),ZodStringFormat.init(e,r)}),ZodJWT=$constructor("ZodJWT",(e,r)=>{$ZodJWT.init(e,r),ZodStringFormat.init(e,r)}),ZodBoolean=$constructor("ZodBoolean",(e,r)=>{$ZodBoolean.init(e,r),ZodType.init(e,r)});function boolean(e){return _boolean(ZodBoolean,e)}const ZodUnknown=$constructor("ZodUnknown",(e,r)=>{$ZodUnknown.init(e,r),ZodType.init(e,r)});function unknown(){return _unknown(ZodUnknown)}const ZodNever=$constructor("ZodNever",(e,r)=>{$ZodNever.init(e,r),ZodType.init(e,r)});function never(e){return _never(ZodNever,e)}const ZodArray=$constructor("ZodArray",(e,r)=>{$ZodArray.init(e,r),ZodType.init(e,r),e.element=r.element,e.min=(r,t)=>e.check(_minLength(r,t)),e.nonempty=r=>e.check(_minLength(1,r)),e.max=(r,t)=>e.check(_maxLength(r,t)),e.length=(r,t)=>e.check(_length(r,t)),e.unwrap=()=>e.element});function array(e,r){return _array(ZodArray,e,r)}const ZodObject=$constructor("ZodObject",(e,r)=>{$ZodObjectJIT.init(e,r),ZodType.init(e,r),defineLazy(e,"shape",()=>r.shape),e.keyof=()=>_enum(Object.keys(e._zod.def.shape)),e.catchall=r=>e.clone({...e._zod.def,catchall:r}),e.passthrough=()=>e.clone({...e._zod.def,catchall:unknown()}),e.loose=()=>e.clone({...e._zod.def,catchall:unknown()}),e.strict=()=>e.clone({...e._zod.def,catchall:never()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=r=>extend(e,r),e.safeExtend=r=>safeExtend(e,r),e.merge=r=>merge(e,r),e.pick=r=>pick(e,r),e.omit=r=>omit(e,r),e.partial=(...r)=>partial(ZodOptional,e,r[0]),e.required=(...r)=>required(ZodNonOptional,e,r[0])});function object(e,r){const t={type:"object",shape:e??{},...normalizeParams(r)};return new ZodObject(t)}const ZodUnion=$constructor("ZodUnion",(e,r)=>{$ZodUnion.init(e,r),ZodType.init(e,r),e.options=r.options});function union(e,r){return new ZodUnion({type:"union",options:e,...normalizeParams(r)})}const ZodIntersection=$constructor("ZodIntersection",(e,r)=>{$ZodIntersection.init(e,r),ZodType.init(e,r)});function intersection(e,r){return new ZodIntersection({type:"intersection",left:e,right:r})}const ZodRecord=$constructor("ZodRecord",(e,r)=>{$ZodRecord.init(e,r),ZodType.init(e,r),e.keyType=r.keyType,e.valueType=r.valueType});function record(e,r,t){return new ZodRecord({type:"record",keyType:e,valueType:r,...normalizeParams(t)})}const ZodEnum=$constructor("ZodEnum",(e,r)=>{$ZodEnum.init(e,r),ZodType.init(e,r),e.enum=r.entries,e.options=Object.values(r.entries);const t=new Set(Object.keys(r.entries));e.extract=(e,n)=>{const i={};for(const n of e){if(!t.has(n))throw new Error(`Key ${n} not found in enum`);i[n]=r.entries[n]}return new ZodEnum({...r,checks:[],...normalizeParams(n),entries:i})},e.exclude=(e,n)=>{const i={...r.entries};for(const r of e){if(!t.has(r))throw new Error(`Key ${r} not found in enum`);delete i[r]}return new ZodEnum({...r,checks:[],...normalizeParams(n),entries:i})}});function _enum(e,r){const t=Array.isArray(e)?Object.fromEntries(e.map(e=>[e,e])):e;return new ZodEnum({type:"enum",entries:t,...normalizeParams(r)})}const ZodLiteral=$constructor("ZodLiteral",(e,r)=>{$ZodLiteral.init(e,r),ZodType.init(e,r),e.values=new Set(r.values),Object.defineProperty(e,"value",{get(){if(r.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return r.values[0]}})});function literal(e,r){return new ZodLiteral({type:"literal",values:Array.isArray(e)?e:[e],...normalizeParams(r)})}const ZodTransform=$constructor("ZodTransform",(e,r)=>{$ZodTransform.init(e,r),ZodType.init(e,r),e._zod.parse=(t,n)=>{if("backward"===n.direction)throw new $ZodEncodeError(e.constructor.name);t.addIssue=n=>{if("string"==typeof n)t.issues.push(issue(n,t.value,r));else{const r=n;r.fatal&&(r.continue=!1),r.code??(r.code="custom"),r.input??(r.input=t.value),r.inst??(r.inst=e),t.issues.push(issue(r))}};const i=r.transform(t.value,t);return i instanceof Promise?i.then(e=>(t.value=e,t)):(t.value=i,t)}});function transform(e){return new ZodTransform({type:"transform",transform:e})}const ZodOptional=$constructor("ZodOptional",(e,r)=>{$ZodOptional.init(e,r),ZodType.init(e,r),e.unwrap=()=>e._zod.def.innerType});function optional(e){return new ZodOptional({type:"optional",innerType:e})}const ZodNullable=$constructor("ZodNullable",(e,r)=>{$ZodNullable.init(e,r),ZodType.init(e,r),e.unwrap=()=>e._zod.def.innerType});function nullable(e){return new ZodNullable({type:"nullable",innerType:e})}const ZodDefault=$constructor("ZodDefault",(e,r)=>{$ZodDefault.init(e,r),ZodType.init(e,r),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function _default(e,r){return new ZodDefault({type:"default",innerType:e,get defaultValue(){return"function"==typeof r?r():shallowClone(r)}})}const ZodPrefault=$constructor("ZodPrefault",(e,r)=>{$ZodPrefault.init(e,r),ZodType.init(e,r),e.unwrap=()=>e._zod.def.innerType});function prefault(e,r){return new ZodPrefault({type:"prefault",innerType:e,get defaultValue(){return"function"==typeof r?r():shallowClone(r)}})}const ZodNonOptional=$constructor("ZodNonOptional",(e,r)=>{$ZodNonOptional.init(e,r),ZodType.init(e,r),e.unwrap=()=>e._zod.def.innerType});function nonoptional(e,r){return new ZodNonOptional({type:"nonoptional",innerType:e,...normalizeParams(r)})}const ZodCatch=$constructor("ZodCatch",(e,r)=>{$ZodCatch.init(e,r),ZodType.init(e,r),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function _catch(e,r){return new ZodCatch({type:"catch",innerType:e,catchValue:"function"==typeof r?r:()=>r})}const ZodPipe=$constructor("ZodPipe",(e,r)=>{$ZodPipe.init(e,r),ZodType.init(e,r),e.in=r.in,e.out=r.out});function pipe(e,r){return new ZodPipe({type:"pipe",in:e,out:r})}const ZodReadonly=$constructor("ZodReadonly",(e,r)=>{$ZodReadonly.init(e,r),ZodType.init(e,r),e.unwrap=()=>e._zod.def.innerType});function readonly(e){return new ZodReadonly({type:"readonly",innerType:e})}const ZodCustom=$constructor("ZodCustom",(e,r)=>{$ZodCustom.init(e,r),ZodType.init(e,r)});function refine(e,r={}){return _refine(ZodCustom,e,r)}function superRefine(e){return _superRefine(e)}const EXTENSION_PKG_KEY="directus:extension",SplitEntrypoint=object({app:string(),api:string()}),ExtensionSandboxRequestedScopes=object({request:optional(object({urls:array(string()),methods:array(union([literal("GET"),literal("POST"),literal("PATCH"),literal("PUT"),literal("DELETE")]))})),log:optional(object({})),sleep:optional(object({}))}),ExtensionSandboxOptions=optional(object({enabled:boolean(),requestedScopes:ExtensionSandboxRequestedScopes})),ExtensionOptionsBundleEntry=union([object({type:_enum(API_EXTENSION_TYPES),name:string(),source:string()}),object({type:_enum(APP_EXTENSION_TYPES),name:string(),source:string()}),object({type:_enum(HYBRID_EXTENSION_TYPES),name:string(),source:SplitEntrypoint})]),ExtensionOptionsBase=object({host:string(),hidden:boolean().optional()}),ExtensionOptionsApp=object({type:_enum(APP_EXTENSION_TYPES),path:string(),source:string()}),ExtensionOptionsApi=object({type:_enum(API_EXTENSION_TYPES),path:string(),source:string(),sandbox:ExtensionSandboxOptions}),ExtensionOptionsHybrid=object({type:_enum(HYBRID_EXTENSION_TYPES),path:SplitEntrypoint,source:SplitEntrypoint,sandbox:ExtensionSandboxOptions}),ExtensionOptionsBundle=object({type:literal("bundle"),partial:boolean().optional(),path:SplitEntrypoint,entries:array(ExtensionOptionsBundleEntry)});array(ExtensionOptionsBundleEntry);const ExtensionOptions=ExtensionOptionsBase.and(union([ExtensionOptionsApp,ExtensionOptionsApi,ExtensionOptionsHybrid,ExtensionOptionsBundle]));function defineHook(e){return e}object({name:string(),version:string(),type:union([literal("module"),literal("commonjs")]).optional(),description:string().optional(),icon:string().optional(),dependencies:record(string(),string()).optional(),devDependencies:record(string(),string()).optional(),[EXTENSION_PKG_KEY]:ExtensionOptions});var parser={},hasRequiredParser,DLList_1,hasRequiredDLList,Events_1,hasRequiredEvents,Queues_1,hasRequiredQueues,BottleneckError_1,hasRequiredBottleneckError,Job_1,hasRequiredJob,LocalDatastore_1,hasRequiredLocalDatastore;function requireParser(){return hasRequiredParser||(hasRequiredParser=1,parser.load=function(e,r,t={}){var n,i,s;for(n in r)s=r[n],t[n]=null!=(i=e[n])?i:s;return t},parser.overwrite=function(e,r,t={}){var n,i;for(n in e)i=e[n],void 0!==r[n]&&(t[n]=i);return t}),parser}function requireDLList(){return hasRequiredDLList?DLList_1:(hasRequiredDLList=1,DLList_1=class{constructor(e,r){this.incr=e,this.decr=r,this._first=null,this._last=null,this.length=0}push(e){var r;this.length++,"function"==typeof this.incr&&this.incr(),r={value:e,prev:this._last,next:null},null!=this._last?(this._last.next=r,this._last=r):this._first=this._last=r}shift(){var e;if(null!=this._first)return this.length--,"function"==typeof this.decr&&this.decr(),e=this._first.value,null!=(this._first=this._first.next)?this._first.prev=null:this._last=null,e}first(){if(null!=this._first)return this._first.value}getArray(){var e,r,t;for(e=this._first,t=[];null!=e;)t.push((r=e,e=e.next,r.value));return t}forEachShift(e){var r;for(r=this.shift();null!=r;)e(r),r=this.shift()}debug(){var e,r,t,n,i;for(e=this._first,i=[];null!=e;)i.push((r=e,e=e.next,{value:r.value,prev:null!=(t=r.prev)?t.value:void 0,next:null!=(n=r.next)?n.value:void 0}));return i}})}function requireEvents(){if(hasRequiredEvents)return Events_1;function e(e,r,t,n,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void t(e)}a.done?r(c):Promise.resolve(c).then(n,i)}function r(r){return function(){var t=this,n=arguments;return new Promise(function(i,s){var o=r.apply(t,n);function a(r){e(o,i,s,a,c,"next",r)}function c(r){e(o,i,s,a,c,"throw",r)}a(void 0)})}}var t;return hasRequiredEvents=1,t=class{constructor(e){if(this.instance=e,this._events={},null!=this.instance.on||null!=this.instance.once||null!=this.instance.removeAllListeners)throw new Error("An Emitter already exists for this object");this.instance.on=(e,r)=>this._addListener(e,"many",r),this.instance.once=(e,r)=>this._addListener(e,"once",r),this.instance.removeAllListeners=(e=null)=>null!=e?delete this._events[e]:this._events={}}_addListener(e,r,t){var n;return null==(n=this._events)[e]&&(n[e]=[]),this._events[e].push({cb:t,status:r}),this.instance}listenerCount(e){return null!=this._events[e]?this._events[e].length:0}trigger(e,...t){var n=this;return r(function*(){var i,s;try{if("debug"!==e&&n.trigger("debug",`Event triggered: ${e}`,t),null==n._events[e])return;return n._events[e]=n._events[e].filter(function(e){return"none"!==e.status}),s=n._events[e].map(function(){var e=r(function*(e){var r,i;if("none"!==e.status){"once"===e.status&&(e.status="none");try{return"function"==typeof(null!=(i="function"==typeof e.cb?e.cb(...t):void 0)?i.then:void 0)?yield i:i}catch(e){return r=e,n.trigger("error",r),null}}});return function(r){return e.apply(this,arguments)}}()),(yield Promise.all(s)).find(function(e){return null!=e})}catch(e){return i=e,n.trigger("error",i),null}})()}},Events_1=t}function requireQueues(){return hasRequiredQueues?Queues_1:(hasRequiredQueues=1,e=requireDLList(),r=requireEvents(),Queues_1=class{constructor(t){this.Events=new r(this),this._length=0,this._lists=function(){var r,n,i;for(i=[],r=1,n=t;1<=n?r<=n:r>=n;1<=n?++r:--r)i.push(new e(()=>this.incr(),()=>this.decr()));return i}.call(this)}incr(){if(0===this._length++)return this.Events.trigger("leftzero")}decr(){if(0===--this._length)return this.Events.trigger("zero")}push(e){return this._lists[e.options.priority].push(e)}queued(e){return null!=e?this._lists[e].length:this._length}shiftAll(e){return this._lists.forEach(function(r){return r.forEachShift(e)})}getFirst(e=this._lists){var r,t,n;for(r=0,t=e.length;r<t;r++)if((n=e[r]).length>0)return n;return[]}shiftLastFrom(e){return this.getFirst(this._lists.slice(e).reverse()).shift()}});var e,r}function requireBottleneckError(){return hasRequiredBottleneckError?BottleneckError_1:(hasRequiredBottleneckError=1,e=class extends Error{},BottleneckError_1=e);var e}function requireJob(){if(hasRequiredJob)return Job_1;function e(e,r,t,n,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void t(e)}a.done?r(c):Promise.resolve(c).then(n,i)}function r(r){return function(){var t=this,n=arguments;return new Promise(function(i,s){var o=r.apply(t,n);function a(r){e(o,i,s,a,c,"next",r)}function c(r){e(o,i,s,a,c,"throw",r)}a(void 0)})}}var t,n;return hasRequiredJob=1,n=requireParser(),t=requireBottleneckError(),Job_1=class{constructor(e,r,t,i,s,o,a,c){this.task=e,this.args=r,this.rejectOnDrop=s,this.Events=o,this._states=a,this.Promise=c,this.options=n.load(t,i),this.options.priority=this._sanitizePriority(this.options.priority),this.options.id===i.id&&(this.options.id=`${this.options.id}-${this._randomIndex()}`),this.promise=new this.Promise((e,r)=>{this._resolve=e,this._reject=r}),this.retryCount=0}_sanitizePriority(e){var r;return(r=~~e!==e?5:e)<0?0:r>9?9:r}_randomIndex(){return Math.random().toString(36).slice(2)}doDrop({error:e,message:r="This job has been dropped by Bottleneck"}={}){return!!this._states.remove(this.options.id)&&(this.rejectOnDrop&&this._reject(null!=e?e:new t(r)),this.Events.trigger("dropped",{args:this.args,options:this.options,task:this.task,promise:this.promise}),!0)}_assertStatus(e){var r;if((r=this._states.jobStatus(this.options.id))!==e&&("DONE"!==e||null!==r))throw new t(`Invalid job status ${r}, expected ${e}. Please open an issue at https://github.com/SGrondin/bottleneck/issues`)}doReceive(){return this._states.start(this.options.id),this.Events.trigger("received",{args:this.args,options:this.options})}doQueue(e,r){return this._assertStatus("RECEIVED"),this._states.next(this.options.id),this.Events.trigger("queued",{args:this.args,options:this.options,reachedHWM:e,blocked:r})}doRun(){return 0===this.retryCount?(this._assertStatus("QUEUED"),this._states.next(this.options.id)):this._assertStatus("EXECUTING"),this.Events.trigger("scheduled",{args:this.args,options:this.options})}doExecute(e,t,n,i){var s=this;return r(function*(){var r,o,a;0===s.retryCount?(s._assertStatus("RUNNING"),s._states.next(s.options.id)):s._assertStatus("EXECUTING"),o={args:s.args,options:s.options,retryCount:s.retryCount},s.Events.trigger("executing",o);try{if(a=yield null!=e?e.schedule(s.options,s.task,...s.args):s.task(...s.args),t())return s.doDone(o),yield i(s.options,o),s._assertStatus("DONE"),s._resolve(a)}catch(e){return r=e,s._onFailure(r,o,t,n,i)}})()}doExpire(e,r,n){var i,s;return this._states.jobStatus("RUNNING"===this.options.id)&&this._states.next(this.options.id),this._assertStatus("EXECUTING"),s={args:this.args,options:this.options,retryCount:this.retryCount},i=new t(`This job timed out after ${this.options.expiration} ms.`),this._onFailure(i,s,e,r,n)}_onFailure(e,t,n,i,s){var o=this;return r(function*(){var r,a;if(n())return null!=(r=yield o.Events.trigger("failed",e,t))?(a=~~r,o.Events.trigger("retry",`Retrying ${o.options.id} after ${a} ms`,t),o.retryCount++,i(a)):(o.doDone(t),yield s(o.options,t),o._assertStatus("DONE"),o._reject(e))})()}doDone(e){return this._assertStatus("EXECUTING"),this._states.next(this.options.id),this.Events.trigger("done",e)}}}function requireLocalDatastore(){if(hasRequiredLocalDatastore)return LocalDatastore_1;function e(e,r,t,n,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void t(e)}a.done?r(c):Promise.resolve(c).then(n,i)}function r(r){return function(){var t=this,n=arguments;return new Promise(function(i,s){var o=r.apply(t,n);function a(r){e(o,i,s,a,c,"next",r)}function c(r){e(o,i,s,a,c,"throw",r)}a(void 0)})}}var t,n,i;return hasRequiredLocalDatastore=1,i=requireParser(),t=requireBottleneckError(),n=class{constructor(e,r,t){this.instance=e,this.storeOptions=r,this.clientId=this.instance._randomIndex(),i.load(t,t,this),this._nextRequest=this._lastReservoirRefresh=this._lastReservoirIncrease=Date.now(),this._running=0,this._done=0,this._unblockTime=0,this.ready=this.Promise.resolve(),this.clients={},this._startHeartbeat()}_startHeartbeat(){var e;return null==this.heartbeat&&(null!=this.storeOptions.reservoirRefreshInterval&&null!=this.storeOptions.reservoirRefreshAmount||null!=this.storeOptions.reservoirIncreaseInterval&&null!=this.storeOptions.reservoirIncreaseAmount)?"function"==typeof(e=this.heartbeat=setInterval(()=>{var e,r,t,n,i;if(n=Date.now(),null!=this.storeOptions.reservoirRefreshInterval&&n>=this._lastReservoirRefresh+this.storeOptions.reservoirRefreshInterval&&(this._lastReservoirRefresh=n,this.storeOptions.reservoir=this.storeOptions.reservoirRefreshAmount,this.instance._drainAll(this.computeCapacity())),null!=this.storeOptions.reservoirIncreaseInterval&&n>=this._lastReservoirIncrease+this.storeOptions.reservoirIncreaseInterval){var s=this.storeOptions;if(e=s.reservoirIncreaseAmount,t=s.reservoirIncreaseMaximum,i=s.reservoir,this._lastReservoirIncrease=n,(r=null!=t?Math.min(e,t-i):e)>0)return this.storeOptions.reservoir+=r,this.instance._drainAll(this.computeCapacity())}},this.heartbeatInterval)).unref?e.unref():void 0:clearInterval(this.heartbeat)}__publish__(e){var t=this;return r(function*(){return yield t.yieldLoop(),t.instance.Events.trigger("message",e.toString())})()}__disconnect__(e){var t=this;return r(function*(){return yield t.yieldLoop(),clearInterval(t.heartbeat),t.Promise.resolve()})()}yieldLoop(e=0){return new this.Promise(function(r,t){return setTimeout(r,e)})}computePenalty(){var e;return null!=(e=this.storeOptions.penalty)?e:15*this.storeOptions.minTime||5e3}__updateSettings__(e){var t=this;return r(function*(){return yield t.yieldLoop(),i.overwrite(e,e,t.storeOptions),t._startHeartbeat(),t.instance._drainAll(t.computeCapacity()),!0})()}__running__(){var e=this;return r(function*(){return yield e.yieldLoop(),e._running})()}__queued__(){var e=this;return r(function*(){return yield e.yieldLoop(),e.instance.queued()})()}__done__(){var e=this;return r(function*(){return yield e.yieldLoop(),e._done})()}__groupCheck__(e){var t=this;return r(function*(){return yield t.yieldLoop(),t._nextRequest+t.timeout<e})()}computeCapacity(){var e,r,t=this.storeOptions;return e=t.maxConcurrent,r=t.reservoir,null!=e&&null!=r?Math.min(e-this._running,r):null!=e?e-this._running:null!=r?r:null}conditionsCheck(e){var r;return null==(r=this.computeCapacity())||e<=r}__incrementReservoir__(e){var t=this;return r(function*(){var r;return yield t.yieldLoop(),r=t.storeOptions.reservoir+=e,t.instance._drainAll(t.computeCapacity()),r})()}__currentReservoir__(){var e=this;return r(function*(){return yield e.yieldLoop(),e.storeOptions.reservoir})()}isBlocked(e){return this._unblockTime>=e}check(e,r){return this.conditionsCheck(e)&&this._nextRequest-r<=0}__check__(e){var t=this;return r(function*(){var r;return yield t.yieldLoop(),r=Date.now(),t.check(e,r)})()}__register__(e,t,n){var i=this;return r(function*(){var e,r;return yield i.yieldLoop(),e=Date.now(),i.conditionsCheck(t)?(i._running+=t,null!=i.storeOptions.reservoir&&(i.storeOptions.reservoir-=t),r=Math.max(i._nextRequest-e,0),i._nextRequest=e+r+i.storeOptions.minTime,{success:!0,wait:r,reservoir:i.storeOptions.reservoir}):{success:!1}})()}strategyIsBlock(){return 3===this.storeOptions.strategy}__submit__(e,n){var i=this;return r(function*(){var r,s,o;if(yield i.yieldLoop(),null!=i.storeOptions.maxConcurrent&&n>i.storeOptions.maxConcurrent)throw new t(`Impossible to add a job having a weight of ${n} to a limiter having a maxConcurrent setting of ${i.storeOptions.maxConcurrent}`);return s=Date.now(),o=null!=i.storeOptions.highWater&&e===i.storeOptions.highWater&&!i.check(n,s),(r=i.strategyIsBlock()&&(o||i.isBlocked(s)))&&(i._unblockTime=s+i.computePenalty(),i._nextRequest=i._unblockTime+i.storeOptions.minTime,i.instance._dropAllQueued()),{reachedHWM:o,blocked:r,strategy:i.storeOptions.strategy}})()}__free__(e,t){var n=this;return r(function*(){return yield n.yieldLoop(),n._running-=t,n._done+=t,n.instance._drainAll(n.computeCapacity()),{running:n._running}})()}},LocalDatastore_1=n}var Scripts={},require$$0={"blacklist_client.lua":"local blacklist = ARGV[num_static_argv + 1]\n\nif redis.call('zscore', client_last_seen_key, blacklist) then\n  redis.call('zadd', client_last_seen_key, 0, blacklist)\nend\n\n\nreturn {}\n","check.lua":"local weight = tonumber(ARGV[num_static_argv + 1])\n\nlocal capacity = process_tick(now, false)['capacity']\nlocal nextRequest = tonumber(redis.call('hget', settings_key, 'nextRequest'))\n\nreturn conditions_check(capacity, weight) and nextRequest - now <= 0\n","conditions_check.lua":"local conditions_check = function (capacity, weight)\n  return capacity == nil or weight <= capacity\nend\n","current_reservoir.lua":"return process_tick(now, false)['reservoir']\n","done.lua":"process_tick(now, false)\n\nreturn tonumber(redis.call('hget', settings_key, 'done'))\n","free.lua":"local index = ARGV[num_static_argv + 1]\n\nredis.call('zadd', job_expirations_key, 0, index)\n\nreturn process_tick(now, false)['running']\n","get_time.lua":"redis.replicate_commands()\n\nlocal get_time = function ()\n  local time = redis.call('time')\n\n  return tonumber(time[1]..string.sub(time[2], 1, 3))\nend\n","group_check.lua":"return not (redis.call('exists', settings_key) == 1)\n","heartbeat.lua":"process_tick(now, true)\n","increment_reservoir.lua":"local incr = tonumber(ARGV[num_static_argv + 1])\n\nredis.call('hincrby', settings_key, 'reservoir', incr)\n\nlocal reservoir = process_tick(now, true)['reservoir']\n\nlocal groupTimeout = tonumber(redis.call('hget', settings_key, 'groupTimeout'))\nrefresh_expiration(0, 0, groupTimeout)\n\nreturn reservoir\n","init.lua":"local clear = tonumber(ARGV[num_static_argv + 1])\nlocal limiter_version = ARGV[num_static_argv + 2]\nlocal num_local_argv = num_static_argv + 2\n\nif clear == 1 then\n  redis.call('del', unpack(KEYS))\nend\n\nif redis.call('exists', settings_key) == 0 then\n  -- Create\n  local args = {'hmset', settings_key}\n\n  for i = num_local_argv + 1, #ARGV do\n    table.insert(args, ARGV[i])\n  end\n\n  redis.call(unpack(args))\n  redis.call('hmset', settings_key,\n    'nextRequest', now,\n    'lastReservoirRefresh', now,\n    'lastReservoirIncrease', now,\n    'running', 0,\n    'done', 0,\n    'unblockTime', 0,\n    'capacityPriorityCounter', 0\n  )\n\nelse\n  -- Apply migrations\n  local settings = redis.call('hmget', settings_key,\n    'id',\n    'version'\n  )\n  local id = settings[1]\n  local current_version = settings[2]\n\n  if current_version ~= limiter_version then\n    local version_digits = {}\n    for k, v in string.gmatch(current_version, \"([^.]+)\") do\n      table.insert(version_digits, tonumber(k))\n    end\n\n    -- 2.10.0\n    if version_digits[2] < 10 then\n      redis.call('hsetnx', settings_key, 'reservoirRefreshInterval', '')\n      redis.call('hsetnx', settings_key, 'reservoirRefreshAmount', '')\n      redis.call('hsetnx', settings_key, 'lastReservoirRefresh', '')\n      redis.call('hsetnx', settings_key, 'done', 0)\n      redis.call('hset', settings_key, 'version', '2.10.0')\n    end\n\n    -- 2.11.1\n    if version_digits[2] < 11 or (version_digits[2] == 11 and version_digits[3] < 1) then\n      if redis.call('hstrlen', settings_key, 'lastReservoirRefresh') == 0 then\n        redis.call('hmset', settings_key,\n          'lastReservoirRefresh', now,\n          'version', '2.11.1'\n        )\n      end\n    end\n\n    -- 2.14.0\n    if version_digits[2] < 14 then\n      local old_running_key = 'b_'..id..'_running'\n      local old_executing_key = 'b_'..id..'_executing'\n\n      if redis.call('exists', old_running_key) == 1 then\n        redis.call('rename', old_running_key, job_weights_key)\n      end\n      if redis.call('exists', old_executing_key) == 1 then\n        redis.call('rename', old_executing_key, job_expirations_key)\n      end\n      redis.call('hset', settings_key, 'version', '2.14.0')\n    end\n\n    -- 2.15.2\n    if version_digits[2] < 15 or (version_digits[2] == 15 and version_digits[3] < 2) then\n      redis.call('hsetnx', settings_key, 'capacityPriorityCounter', 0)\n      redis.call('hset', settings_key, 'version', '2.15.2')\n    end\n\n    -- 2.17.0\n    if version_digits[2] < 17 then\n      redis.call('hsetnx', settings_key, 'clientTimeout', 10000)\n      redis.call('hset', settings_key, 'version', '2.17.0')\n    end\n\n    -- 2.18.0\n    if version_digits[2] < 18 then\n      redis.call('hsetnx', settings_key, 'reservoirIncreaseInterval', '')\n      redis.call('hsetnx', settings_key, 'reservoirIncreaseAmount', '')\n      redis.call('hsetnx', settings_key, 'reservoirIncreaseMaximum', '')\n      redis.call('hsetnx', settings_key, 'lastReservoirIncrease', now)\n      redis.call('hset', settings_key, 'version', '2.18.0')\n    end\n\n  end\n\n  process_tick(now, false)\nend\n\nlocal groupTimeout = tonumber(redis.call('hget', settings_key, 'groupTimeout'))\nrefresh_expiration(0, 0, groupTimeout)\n\nreturn {}\n","process_tick.lua":"local process_tick = function (now, always_publish)\n\n  local compute_capacity = function (maxConcurrent, running, reservoir)\n    if maxConcurrent ~= nil and reservoir ~= nil then\n      return math.min((maxConcurrent - running), reservoir)\n    elseif maxConcurrent ~= nil then\n      return maxConcurrent - running\n    elseif reservoir ~= nil then\n      return reservoir\n    else\n      return nil\n    end\n  end\n\n  local settings = redis.call('hmget', settings_key,\n    'id',\n    'maxConcurrent',\n    'running',\n    'reservoir',\n    'reservoirRefreshInterval',\n    'reservoirRefreshAmount',\n    'lastReservoirRefresh',\n    'reservoirIncreaseInterval',\n    'reservoirIncreaseAmount',\n    'reservoirIncreaseMaximum',\n    'lastReservoirIncrease',\n    'capacityPriorityCounter',\n    'clientTimeout'\n  )\n  local id = settings[1]\n  local maxConcurrent = tonumber(settings[2])\n  local running = tonumber(settings[3])\n  local reservoir = tonumber(settings[4])\n  local reservoirRefreshInterval = tonumber(settings[5])\n  local reservoirRefreshAmount = tonumber(settings[6])\n  local lastReservoirRefresh = tonumber(settings[7])\n  local reservoirIncreaseInterval = tonumber(settings[8])\n  local reservoirIncreaseAmount = tonumber(settings[9])\n  local reservoirIncreaseMaximum = tonumber(settings[10])\n  local lastReservoirIncrease = tonumber(settings[11])\n  local capacityPriorityCounter = tonumber(settings[12])\n  local clientTimeout = tonumber(settings[13])\n\n  local initial_capacity = compute_capacity(maxConcurrent, running, reservoir)\n\n  --\n  -- Process 'running' changes\n  --\n  local expired = redis.call('zrangebyscore', job_expirations_key, '-inf', '('..now)\n\n  if #expired > 0 then\n    redis.call('zremrangebyscore', job_expirations_key, '-inf', '('..now)\n\n    local flush_batch = function (batch, acc)\n      local weights = redis.call('hmget', job_weights_key, unpack(batch))\n                      redis.call('hdel',  job_weights_key, unpack(batch))\n      local clients = redis.call('hmget', job_clients_key, unpack(batch))\n                      redis.call('hdel',  job_clients_key, unpack(batch))\n\n      -- Calculate sum of removed weights\n      for i = 1, #weights do\n        acc['total'] = acc['total'] + (tonumber(weights[i]) or 0)\n      end\n\n      -- Calculate sum of removed weights by client\n      local client_weights = {}\n      for i = 1, #clients do\n        local removed = tonumber(weights[i]) or 0\n        if removed > 0 then\n          acc['client_weights'][clients[i]] = (acc['client_weights'][clients[i]] or 0) + removed\n        end\n      end\n    end\n\n    local acc = {\n      ['total'] = 0,\n      ['client_weights'] = {}\n    }\n    local batch_size = 1000\n\n    -- Compute changes to Zsets and apply changes to Hashes\n    for i = 1, #expired, batch_size do\n      local batch = {}\n      for j = i, math.min(i + batch_size - 1, #expired) do\n        table.insert(batch, expired[j])\n      end\n\n      flush_batch(batch, acc)\n    end\n\n    -- Apply changes to Zsets\n    if acc['total'] > 0 then\n      redis.call('hincrby', settings_key, 'done', acc['total'])\n      running = tonumber(redis.call('hincrby', settings_key, 'running', -acc['total']))\n    end\n\n    for client, weight in pairs(acc['client_weights']) do\n      redis.call('zincrby', client_running_key, -weight, client)\n    end\n  end\n\n  --\n  -- Process 'reservoir' changes\n  --\n  local reservoirRefreshActive = reservoirRefreshInterval ~= nil and reservoirRefreshAmount ~= nil\n  if reservoirRefreshActive and now >= lastReservoirRefresh + reservoirRefreshInterval then\n    reservoir = reservoirRefreshAmount\n    redis.call('hmset', settings_key,\n      'reservoir', reservoir,\n      'lastReservoirRefresh', now\n    )\n  end\n\n  local reservoirIncreaseActive = reservoirIncreaseInterval ~= nil and reservoirIncreaseAmount ~= nil\n  if reservoirIncreaseActive and now >= lastReservoirIncrease + reservoirIncreaseInterval then\n    local num_intervals = math.floor((now - lastReservoirIncrease) / reservoirIncreaseInterval)\n    local incr = reservoirIncreaseAmount * num_intervals\n    if reservoirIncreaseMaximum ~= nil then\n      incr = math.min(incr, reservoirIncreaseMaximum - (reservoir or 0))\n    end\n    if incr > 0 then\n      reservoir = (reservoir or 0) + incr\n    end\n    redis.call('hmset', settings_key,\n      'reservoir', reservoir,\n      'lastReservoirIncrease', lastReservoirIncrease + (num_intervals * reservoirIncreaseInterval)\n    )\n  end\n\n  --\n  -- Clear unresponsive clients\n  --\n  local unresponsive = redis.call('zrangebyscore', client_last_seen_key, '-inf', (now - clientTimeout))\n  local unresponsive_lookup = {}\n  local terminated_clients = {}\n  for i = 1, #unresponsive do\n    unresponsive_lookup[unresponsive[i]] = true\n    if tonumber(redis.call('zscore', client_running_key, unresponsive[i])) == 0 then\n      table.insert(terminated_clients, unresponsive[i])\n    end\n  end\n  if #terminated_clients > 0 then\n    redis.call('zrem', client_running_key,         unpack(terminated_clients))\n    redis.call('hdel', client_num_queued_key,      unpack(terminated_clients))\n    redis.call('zrem', client_last_registered_key, unpack(terminated_clients))\n    redis.call('zrem', client_last_seen_key,       unpack(terminated_clients))\n  end\n\n  --\n  -- Broadcast capacity changes\n  --\n  local final_capacity = compute_capacity(maxConcurrent, running, reservoir)\n\n  if always_publish or (initial_capacity ~= nil and final_capacity == nil) then\n    -- always_publish or was not unlimited, now unlimited\n    redis.call('publish', 'b_'..id, 'capacity:'..(final_capacity or ''))\n\n  elseif initial_capacity ~= nil and final_capacity ~= nil and final_capacity > initial_capacity then\n    -- capacity was increased\n    -- send the capacity message to the limiter having the lowest number of running jobs\n    -- the tiebreaker is the limiter having not registered a job in the longest time\n\n    local lowest_concurrency_value = nil\n    local lowest_concurrency_clients = {}\n    local lowest_concurrency_last_registered = {}\n    local client_concurrencies = redis.call('zrange', client_running_key, 0, -1, 'withscores')\n\n    for i = 1, #client_concurrencies, 2 do\n      local client = client_concurrencies[i]\n      local concurrency = tonumber(client_concurrencies[i+1])\n\n      if (\n        lowest_concurrency_value == nil or lowest_concurrency_value == concurrency\n      ) and (\n        not unresponsive_lookup[client]\n      ) and (\n        tonumber(redis.call('hget', client_num_queued_key, client)) > 0\n      ) then\n        lowest_concurrency_value = concurrency\n        table.insert(lowest_concurrency_clients, client)\n        local last_registered = tonumber(redis.call('zscore', client_last_registered_key, client))\n        table.insert(lowest_concurrency_last_registered, last_registered)\n      end\n    end\n\n    if #lowest_concurrency_clients > 0 then\n      local position = 1\n      local earliest = lowest_concurrency_last_registered[1]\n\n      for i,v in ipairs(lowest_concurrency_last_registered) do\n        if v < earliest then\n          position = i\n          earliest = v\n        end\n      end\n\n      local next_client = lowest_concurrency_clients[position]\n      redis.call('publish', 'b_'..id,\n        'capacity-priority:'..(final_capacity or '')..\n        ':'..next_client..\n        ':'..capacityPriorityCounter\n      )\n      redis.call('hincrby', settings_key, 'capacityPriorityCounter', '1')\n    else\n      redis.call('publish', 'b_'..id, 'capacity:'..(final_capacity or ''))\n    end\n  end\n\n  return {\n    ['capacity'] = final_capacity,\n    ['running'] = running,\n    ['reservoir'] = reservoir\n  }\nend\n","queued.lua":"local clientTimeout = tonumber(redis.call('hget', settings_key, 'clientTimeout'))\nlocal valid_clients = redis.call('zrangebyscore', client_last_seen_key, (now - clientTimeout), 'inf')\nlocal client_queued = redis.call('hmget', client_num_queued_key, unpack(valid_clients))\n\nlocal sum = 0\nfor i = 1, #client_queued do\n  sum = sum + tonumber(client_queued[i])\nend\n\nreturn sum\n","refresh_expiration.lua":"local refresh_expiration = function (now, nextRequest, groupTimeout)\n\n  if groupTimeout ~= nil then\n    local ttl = (nextRequest + groupTimeout) - now\n\n    for i = 1, #KEYS do\n      redis.call('pexpire', KEYS[i], ttl)\n    end\n  end\n\nend\n","refs.lua":"local settings_key = KEYS[1]\nlocal job_weights_key = KEYS[2]\nlocal job_expirations_key = KEYS[3]\nlocal job_clients_key = KEYS[4]\nlocal client_running_key = KEYS[5]\nlocal client_num_queued_key = KEYS[6]\nlocal client_last_registered_key = KEYS[7]\nlocal client_last_seen_key = KEYS[8]\n\nlocal now = tonumber(ARGV[1])\nlocal client = ARGV[2]\n\nlocal num_static_argv = 2\n","register.lua":"local index = ARGV[num_static_argv + 1]\nlocal weight = tonumber(ARGV[num_static_argv + 2])\nlocal expiration = tonumber(ARGV[num_static_argv + 3])\n\nlocal state = process_tick(now, false)\nlocal capacity = state['capacity']\nlocal reservoir = state['reservoir']\n\nlocal settings = redis.call('hmget', settings_key,\n  'nextRequest',\n  'minTime',\n  'groupTimeout'\n)\nlocal nextRequest = tonumber(settings[1])\nlocal minTime = tonumber(settings[2])\nlocal groupTimeout = tonumber(settings[3])\n\nif conditions_check(capacity, weight) then\n\n  redis.call('hincrby', settings_key, 'running', weight)\n  redis.call('hset', job_weights_key, index, weight)\n  if expiration ~= nil then\n    redis.call('zadd', job_expirations_key, now + expiration, index)\n  end\n  redis.call('hset', job_clients_key, index, client)\n  redis.call('zincrby', client_running_key, weight, client)\n  redis.call('hincrby', client_num_queued_key, client, -1)\n  redis.call('zadd', client_last_registered_key, now, client)\n\n  local wait = math.max(nextRequest - now, 0)\n  local newNextRequest = now + wait + minTime\n\n  if reservoir == nil then\n    redis.call('hset', settings_key,\n      'nextRequest', newNextRequest\n    )\n  else\n    reservoir = reservoir - weight\n    redis.call('hmset', settings_key,\n      'reservoir', reservoir,\n      'nextRequest', newNextRequest\n    )\n  end\n\n  refresh_expiration(now, newNextRequest, groupTimeout)\n\n  return {true, wait, reservoir}\n\nelse\n  return {false}\nend\n","register_client.lua":"local queued = tonumber(ARGV[num_static_argv + 1])\n\n-- Could have been re-registered concurrently\nif not redis.call('zscore', client_last_seen_key, client) then\n  redis.call('zadd', client_running_key, 0, client)\n  redis.call('hset', client_num_queued_key, client, queued)\n  redis.call('zadd', client_last_registered_key, 0, client)\nend\n\nredis.call('zadd', client_last_seen_key, now, client)\n\nreturn {}\n","running.lua":"return process_tick(now, false)['running']\n","submit.lua":"local queueLength = tonumber(ARGV[num_static_argv + 1])\nlocal weight = tonumber(ARGV[num_static_argv + 2])\n\nlocal capacity = process_tick(now, false)['capacity']\n\nlocal settings = redis.call('hmget', settings_key,\n  'id',\n  'maxConcurrent',\n  'highWater',\n  'nextRequest',\n  'strategy',\n  'unblockTime',\n  'penalty',\n  'minTime',\n  'groupTimeout'\n)\nlocal id = settings[1]\nlocal maxConcurrent = tonumber(settings[2])\nlocal highWater = tonumber(settings[3])\nlocal nextRequest = tonumber(settings[4])\nlocal strategy = tonumber(settings[5])\nlocal unblockTime = tonumber(settings[6])\nlocal penalty = tonumber(settings[7])\nlocal minTime = tonumber(settings[8])\nlocal groupTimeout = tonumber(settings[9])\n\nif maxConcurrent ~= nil and weight > maxConcurrent then\n  return redis.error_reply('OVERWEIGHT:'..weight..':'..maxConcurrent)\nend\n\nlocal reachedHWM = (highWater ~= nil and queueLength == highWater\n  and not (\n    conditions_check(capacity, weight)\n    and nextRequest - now <= 0\n  )\n)\n\nlocal blocked = strategy == 3 and (reachedHWM or unblockTime >= now)\n\nif blocked then\n  local computedPenalty = penalty\n  if computedPenalty == nil then\n    if minTime == 0 then\n      computedPenalty = 5000\n    else\n      computedPenalty = 15 * minTime\n    end\n  end\n\n  local newNextRequest = now + computedPenalty + minTime\n\n  redis.call('hmset', settings_key,\n    'unblockTime', now + computedPenalty,\n    'nextRequest', newNextRequest\n  )\n\n  local clients_queued_reset = redis.call('hkeys', client_num_queued_key)\n  local queued_reset = {}\n  for i = 1, #clients_queued_reset do\n    table.insert(queued_reset, clients_queued_reset[i])\n    table.insert(queued_reset, 0)\n  end\n  redis.call('hmset', client_num_queued_key, unpack(queued_reset))\n\n  redis.call('publish', 'b_'..id, 'blocked:')\n\n  refresh_expiration(now, newNextRequest, groupTimeout)\nend\n\nif not blocked and not reachedHWM then\n  redis.call('hincrby', client_num_queued_key, client, 1)\nend\n\nreturn {reachedHWM, blocked, strategy}\n","update_settings.lua":"local args = {'hmset', settings_key}\n\nfor i = num_static_argv + 1, #ARGV do\n  table.insert(args, ARGV[i])\nend\n\nredis.call(unpack(args))\n\nprocess_tick(now, true)\n\nlocal groupTimeout = tonumber(redis.call('hget', settings_key, 'groupTimeout'))\nrefresh_expiration(0, 0, groupTimeout)\n\nreturn {}\n","validate_client.lua":"if not redis.call('zscore', client_last_seen_key, client) then\n  return redis.error_reply('UNKNOWN_CLIENT')\nend\n\nredis.call('zadd', client_last_seen_key, now, client)\n","validate_keys.lua":"if not (redis.call('exists', settings_key) == 1) then\n  return redis.error_reply('SETTINGS_KEY_NOT_FOUND')\nend\n"},hasRequiredScripts,RedisConnection_1,hasRequiredRedisConnection,IORedisConnection_1,hasRequiredIORedisConnection,RedisDatastore_1,hasRequiredRedisDatastore,States_1,hasRequiredStates,Sync_1,hasRequiredSync;function requireScripts(){return hasRequiredScripts||(hasRequiredScripts=1,e=Scripts,r={refs:(t=require$$0)["refs.lua"],validate_keys:t["validate_keys.lua"],validate_client:t["validate_client.lua"],refresh_expiration:t["refresh_expiration.lua"],process_tick:t["process_tick.lua"],conditions_check:t["conditions_check.lua"],get_time:t["get_time.lua"]},e.allKeys=function(e){return[`b_${e}_settings`,`b_${e}_job_weights`,`b_${e}_job_expirations`,`b_${e}_job_clients`,`b_${e}_client_running`,`b_${e}_client_num_queued`,`b_${e}_client_last_registered`,`b_${e}_client_last_seen`]},n={init:{keys:e.allKeys,headers:["process_tick"],refresh_expiration:!0,code:t["init.lua"]},group_check:{keys:e.allKeys,headers:[],refresh_expiration:!1,code:t["group_check.lua"]},register_client:{keys:e.allKeys,headers:["validate_keys"],refresh_expiration:!1,code:t["register_client.lua"]},blacklist_client:{keys:e.allKeys,headers:["validate_keys","validate_client"],refresh_expiration:!1,code:t["blacklist_client.lua"]},heartbeat:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!1,code:t["heartbeat.lua"]},update_settings:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!0,code:t["update_settings.lua"]},running:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!1,code:t["running.lua"]},queued:{keys:e.allKeys,headers:["validate_keys","validate_client"],refresh_expiration:!1,code:t["queued.lua"]},done:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!1,code:t["done.lua"]},check:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick","conditions_check"],refresh_expiration:!1,code:t["check.lua"]},submit:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick","conditions_check"],refresh_expiration:!0,code:t["submit.lua"]},register:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick","conditions_check"],refresh_expiration:!0,code:t["register.lua"]},free:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!0,code:t["free.lua"]},current_reservoir:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!1,code:t["current_reservoir.lua"]},increment_reservoir:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!0,code:t["increment_reservoir.lua"]}},e.names=Object.keys(n),e.keys=function(e,r){return n[e].keys(r)},e.payload=function(e){var t;return t=n[e],Array.prototype.concat(r.refs,t.headers.map(function(e){return r[e]}),t.refresh_expiration?r.refresh_expiration:"",t.code).join("\n")}),Scripts;var e,r,t,n}function requireRedisConnection(){if(hasRequiredRedisConnection)return RedisConnection_1;function asyncGeneratorStep(e,r,t,n,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void t(e)}a.done?r(c):Promise.resolve(c).then(n,i)}function _asyncToGenerator(e){return function(){var r=this,t=arguments;return new Promise(function(n,i){var s=e.apply(r,t);function o(e){asyncGeneratorStep(s,n,i,o,a,"next",e)}function a(e){asyncGeneratorStep(s,n,i,o,a,"throw",e)}o(void 0)})}}var Events,RedisConnection,Scripts,parser;return hasRequiredRedisConnection=1,parser=requireParser(),Events=requireEvents(),Scripts=requireScripts(),RedisConnection=function(){class RedisConnection{constructor(options={}){parser.load(options,this.defaults,this),null==this.Redis&&(this.Redis=eval("require")("redis")),null==this.Events&&(this.Events=new Events(this)),this.terminated=!1,null==this.client&&(this.client=this.Redis.createClient(this.clientOptions)),this.subscriber=this.client.duplicate(),this.limiters={},this.shas={},this.ready=this.Promise.all([this._setup(this.client,!1),this._setup(this.subscriber,!0)]).then(()=>this._loadScripts()).then(()=>({client:this.client,subscriber:this.subscriber}))}_setup(e,r){return e.setMaxListeners(0),new this.Promise((t,n)=>(e.on("error",e=>this.Events.trigger("error",e)),r&&e.on("message",(e,r)=>{var t;return null!=(t=this.limiters[e])?t._store.onMessage(e,r):void 0}),e.ready?t():e.once("ready",t)))}_loadScript(e){return new this.Promise((r,t)=>{var n;return n=Scripts.payload(e),this.client.multi([["script","load",n]]).exec((n,i)=>null!=n?t(n):(this.shas[e]=i[0],r(i[0])))})}_loadScripts(){return this.Promise.all(Scripts.names.map(e=>this._loadScript(e)))}__runCommand__(e){var r=this;return _asyncToGenerator(function*(){return yield r.ready,new r.Promise((t,n)=>r.client.multi([e]).exec_atomic(function(e,r){return null!=e?n(e):t(r[0])}))})()}__addLimiter__(e){return this.Promise.all([e.channel(),e.channel_client()].map(r=>new this.Promise((t,n)=>{var i;return i=n=>{if(n===r)return this.subscriber.removeListener("subscribe",i),this.limiters[r]=e,t()},this.subscriber.on("subscribe",i),this.subscriber.subscribe(r)})))}__removeLimiter__(e){var r=this;return this.Promise.all([e.channel(),e.channel_client()].map(function(){var e=_asyncToGenerator(function*(e){return r.terminated||(yield new r.Promise((t,n)=>r.subscriber.unsubscribe(e,function(r,i){return null!=r?n(r):i===e?t():void 0}))),delete r.limiters[e]});return function(r){return e.apply(this,arguments)}}()))}__scriptArgs__(e,r,t,n){var i;return i=Scripts.keys(e,r),[this.shas[e],i.length].concat(i,t,n)}__scriptFn__(e){return this.client.evalsha.bind(this.client)}disconnect(e=!0){var r,t,n,i;for(r=0,n=(i=Object.keys(this.limiters)).length;r<n;r++)t=i[r],clearInterval(this.limiters[t]._store.heartbeat);return this.limiters={},this.terminated=!0,this.client.end(e),this.subscriber.end(e),this.Promise.resolve()}}return RedisConnection.prototype.datastore="redis",RedisConnection.prototype.defaults={Redis:null,clientOptions:{},client:null,Promise:Promise,Events:null},RedisConnection}.call(void 0),RedisConnection_1=RedisConnection,RedisConnection_1}function requireIORedisConnection(){if(hasRequiredIORedisConnection)return IORedisConnection_1;function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,r){var t=[],n=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done)&&(t.push(o.value),!r||t.length!==r);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}return t}function _arrayWithHoles(e){if(Array.isArray(e))return e}function asyncGeneratorStep(e,r,t,n,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void t(e)}a.done?r(c):Promise.resolve(c).then(n,i)}function _asyncToGenerator(e){return function(){var r=this,t=arguments;return new Promise(function(n,i){var s=e.apply(r,t);function o(e){asyncGeneratorStep(s,n,i,o,a,"next",e)}function a(e){asyncGeneratorStep(s,n,i,o,a,"throw",e)}o(void 0)})}}var Events,IORedisConnection,Scripts,parser;return hasRequiredIORedisConnection=1,parser=requireParser(),Events=requireEvents(),Scripts=requireScripts(),IORedisConnection=function(){class IORedisConnection{constructor(options={}){parser.load(options,this.defaults,this),null==this.Redis&&(this.Redis=eval("require")("ioredis")),null==this.Events&&(this.Events=new Events(this)),this.terminated=!1,null!=this.clusterNodes?(this.client=new this.Redis.Cluster(this.clusterNodes,this.clientOptions),this.subscriber=new this.Redis.Cluster(this.clusterNodes,this.clientOptions)):null!=this.client&&null==this.client.duplicate?this.subscriber=new this.Redis.Cluster(this.client.startupNodes,this.client.options):(null==this.client&&(this.client=new this.Redis(this.clientOptions)),this.subscriber=this.client.duplicate()),this.limiters={},this.ready=this.Promise.all([this._setup(this.client,!1),this._setup(this.subscriber,!0)]).then(()=>(this._loadScripts(),{client:this.client,subscriber:this.subscriber}))}_setup(e,r){return e.setMaxListeners(0),new this.Promise((t,n)=>(e.on("error",e=>this.Events.trigger("error",e)),r&&e.on("message",(e,r)=>{var t;return null!=(t=this.limiters[e])?t._store.onMessage(e,r):void 0}),"ready"===e.status?t():e.once("ready",t)))}_loadScripts(){return Scripts.names.forEach(e=>this.client.defineCommand(e,{lua:Scripts.payload(e)}))}__runCommand__(e){var r=this;return _asyncToGenerator(function*(){yield r.ready;var t=_slicedToArray(yield r.client.pipeline([e]).exec(),1),n=_slicedToArray(t[0],2);return n[0],n[1]})()}__addLimiter__(e){return this.Promise.all([e.channel(),e.channel_client()].map(r=>new this.Promise((t,n)=>this.subscriber.subscribe(r,()=>(this.limiters[r]=e,t())))))}__removeLimiter__(e){var r=this;return[e.channel(),e.channel_client()].forEach(function(){var e=_asyncToGenerator(function*(e){return r.terminated||(yield r.subscriber.unsubscribe(e)),delete r.limiters[e]});return function(r){return e.apply(this,arguments)}}())}__scriptArgs__(e,r,t,n){var i;return[(i=Scripts.keys(e,r)).length].concat(i,t,n)}__scriptFn__(e){return this.client[e].bind(this.client)}disconnect(e=!0){var r,t,n,i;for(r=0,n=(i=Object.keys(this.limiters)).length;r<n;r++)t=i[r],clearInterval(this.limiters[t]._store.heartbeat);return this.limiters={},this.terminated=!0,e?this.Promise.all([this.client.quit(),this.subscriber.quit()]):(this.client.disconnect(),this.subscriber.disconnect(),this.Promise.resolve())}}return IORedisConnection.prototype.datastore="ioredis",IORedisConnection.prototype.defaults={Redis:null,clientOptions:{},clusterNodes:null,client:null,Promise:Promise,Events:null},IORedisConnection}.call(void 0),IORedisConnection_1=IORedisConnection,IORedisConnection_1}function requireRedisDatastore(){if(hasRequiredRedisDatastore)return RedisDatastore_1;function e(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=[],n=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done)&&(t.push(o.value),!r||t.length!==r);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function r(e,r,t,n,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void t(e)}a.done?r(c):Promise.resolve(c).then(n,i)}function t(e){return function(){var t=this,n=arguments;return new Promise(function(i,s){var o=e.apply(t,n);function a(e){r(o,i,s,a,c,"next",e)}function c(e){r(o,i,s,a,c,"throw",e)}a(void 0)})}}var n,i,s,o,a;return hasRequiredRedisDatastore=1,a=requireParser(),n=requireBottleneckError(),s=requireRedisConnection(),i=requireIORedisConnection(),o=class{constructor(e,r,t){this.instance=e,this.storeOptions=r,this.originalId=this.instance.id,this.clientId=this.instance._randomIndex(),a.load(t,t,this),this.clients={},this.capacityPriorityCounters={},this.sharedConnection=null!=this.connection,null==this.connection&&(this.connection="redis"===this.instance.datastore?new s({Redis:this.Redis,clientOptions:this.clientOptions,Promise:this.Promise,Events:this.instance.Events}):"ioredis"===this.instance.datastore?new i({Redis:this.Redis,clientOptions:this.clientOptions,clusterNodes:this.clusterNodes,Promise:this.Promise,Events:this.instance.Events}):void 0),this.instance.connection=this.connection,this.instance.datastore=this.connection.datastore,this.ready=this.connection.ready.then(e=>(this.clients=e,this.runScript("init",this.prepareInitSettings(this.clearDatastore)))).then(()=>this.connection.__addLimiter__(this.instance)).then(()=>this.runScript("register_client",[this.instance.queued()])).then(()=>{var e;return"function"==typeof(e=this.heartbeat=setInterval(()=>this.runScript("heartbeat",[]).catch(e=>this.instance.Events.trigger("error",e)),this.heartbeatInterval)).unref&&e.unref(),this.clients})}__publish__(e){var r=this;return t(function*(){return(yield r.ready).client.publish(r.instance.channel(),`message:${e.toString()}`)})()}onMessage(r,n){var i=this;return t(function*(){var r,s,o,a,c,u,l,d,p,h;try{l=n.indexOf(":");var f=[n.slice(0,l),n.slice(l+1)];if(o=f[1],"capacity"===(h=f[0]))return yield i.instance._drainAll(o.length>0?~~o:void 0);if("capacity-priority"===h){var m=e(o.split(":"),3);return p=m[0],d=m[1],s=m[2],r=p.length>0?~~p:void 0,d===i.clientId?(a=yield i.instance._drainAll(r),u=null!=r?r-(a||0):"",yield i.clients.client.publish(i.instance.channel(),`capacity-priority:${u}::${s}`)):""===d?(clearTimeout(i.capacityPriorityCounters[s]),delete i.capacityPriorityCounters[s],i.instance._drainAll(r)):i.capacityPriorityCounters[s]=setTimeout(t(function*(){var e;try{return delete i.capacityPriorityCounters[s],yield i.runScript("blacklist_client",[d]),yield i.instance._drainAll(r)}catch(r){return e=r,i.instance.Events.trigger("error",e)}}),1e3)}if("message"===h)return i.instance.Events.trigger("message",o);if("blocked"===h)return yield i.instance._dropAllQueued()}catch(e){return c=e,i.instance.Events.trigger("error",c)}})()}__disconnect__(e){return clearInterval(this.heartbeat),this.sharedConnection?this.connection.__removeLimiter__(this.instance):this.connection.disconnect(e)}runScript(e,r){var n=this;return t(function*(){return"init"!==e&&"register_client"!==e&&(yield n.ready),new n.Promise((t,i)=>{var s,o;return s=[Date.now(),n.clientId].concat(r),n.instance.Events.trigger("debug",`Calling Redis script: ${e}.lua`,s),o=n.connection.__scriptArgs__(e,n.originalId,s,function(e,r){return null!=e?i(e):t(r)}),n.connection.__scriptFn__(e)(...o)}).catch(t=>"SETTINGS_KEY_NOT_FOUND"===t.message?"heartbeat"===e?n.Promise.resolve():n.runScript("init",n.prepareInitSettings(!1)).then(()=>n.runScript(e,r)):"UNKNOWN_CLIENT"===t.message?n.runScript("register_client",[n.instance.queued()]).then(()=>n.runScript(e,r)):n.Promise.reject(t))})()}prepareArray(e){var r,t,n,i;for(n=[],r=0,t=e.length;r<t;r++)i=e[r],n.push(null!=i?i.toString():"");return n}prepareObject(e){var r,t,n;for(t in r=[],e)n=e[t],r.push(t,null!=n?n.toString():"");return r}prepareInitSettings(e){var r;return(r=this.prepareObject(Object.assign({},this.storeOptions,{id:this.originalId,version:this.instance.version,groupTimeout:this.timeout,clientTimeout:this.clientTimeout}))).unshift(e?1:0,this.instance.version),r}convertBool(e){return!!e}__updateSettings__(e){var r=this;return t(function*(){return yield r.runScript("update_settings",r.prepareObject(e)),a.overwrite(e,e,r.storeOptions)})()}__running__(){return this.runScript("running",[])}__queued__(){return this.runScript("queued",[])}__done__(){return this.runScript("done",[])}__groupCheck__(){var e=this;return t(function*(){return e.convertBool(yield e.runScript("group_check",[]))})()}__incrementReservoir__(e){return this.runScript("increment_reservoir",[e])}__currentReservoir__(){return this.runScript("current_reservoir",[])}__check__(e){var r=this;return t(function*(){return r.convertBool(yield r.runScript("check",r.prepareArray([e])))})()}__register__(r,n,i){var s=this;return t(function*(){var t,o,a,c=e(yield s.runScript("register",s.prepareArray([r,n,i])),3);return o=c[0],a=c[1],t=c[2],{success:s.convertBool(o),wait:a,reservoir:t}})()}__submit__(r,i){var s=this;return t(function*(){var t,o,a,c,u;try{var l=e(yield s.runScript("submit",s.prepareArray([r,i])),3);return c=l[0],t=l[1],u=l[2],{reachedHWM:s.convertBool(c),blocked:s.convertBool(t),strategy:u}}catch(r){if(0===(o=r).message.indexOf("OVERWEIGHT")){var d=e(o.message.split(":"),3);throw d[0],i=d[1],a=d[2],new n(`Impossible to add a job having a weight of ${i} to a limiter having a maxConcurrent setting of ${a}`)}throw o}})()}__free__(e,r){var n=this;return t(function*(){return{running:yield n.runScript("free",n.prepareArray([e]))}})()}},RedisDatastore_1=o}function requireStates(){return hasRequiredStates?States_1:(hasRequiredStates=1,e=requireBottleneckError(),States_1=class{constructor(e){this.status=e,this._jobs={},this.counts=this.status.map(function(){return 0})}next(e){var r,t;return t=(r=this._jobs[e])+1,null!=r&&t<this.status.length?(this.counts[r]--,this.counts[t]++,this._jobs[e]++):null!=r?(this.counts[r]--,delete this._jobs[e]):void 0}start(e){return this._jobs[e]=0,this.counts[0]++}remove(e){var r;return null!=(r=this._jobs[e])&&(this.counts[r]--,delete this._jobs[e]),null!=r}jobStatus(e){var r;return null!=(r=this.status[this._jobs[e]])?r:null}statusJobs(r){var t,n,i,s;if(null!=r){if((n=this.status.indexOf(r))<0)throw new e(`status must be one of ${this.status.join(", ")}`);for(t in s=[],i=this._jobs)i[t]===n&&s.push(t);return s}return Object.keys(this._jobs)}statusCounts(){return this.counts.reduce((e,r,t)=>(e[this.status[t]]=r,e),{})}});var e}function requireSync(){if(hasRequiredSync)return Sync_1;function e(e,r,t,n,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void t(e)}a.done?r(c):Promise.resolve(c).then(n,i)}function r(r){return function(){var t=this,n=arguments;return new Promise(function(i,s){var o=r.apply(t,n);function a(r){e(o,i,s,a,c,"next",r)}function c(r){e(o,i,s,a,c,"throw",r)}a(void 0)})}}var t;return hasRequiredSync=1,t=requireDLList(),Sync_1=class{constructor(e,r){this.schedule=this.schedule.bind(this),this.name=e,this.Promise=r,this._running=0,this._queue=new t}isEmpty(){return 0===this._queue.length}_tryToRun(){var e=this;return r(function*(){var t,n,i,s,o,a,c;if(e._running<1&&e._queue.length>0){e._running++;var u=e._queue.shift();return c=u.task,t=u.args,o=u.resolve,s=u.reject,n=yield r(function*(){try{return a=yield c(...t),function(){return o(a)}}catch(e){return i=e,function(){return s(i)}}})(),e._running--,e._tryToRun(),n()}})()}schedule(e,...r){var t,n,i;return i=n=null,t=new this.Promise(function(e,r){return i=e,n=r}),this._queue.push({task:e,args:r,resolve:i,reject:n}),this._tryToRun(),t}}}var version="2.19.5",require$$8={version:version},Group_1,hasRequiredGroup,Batcher_1,hasRequiredBatcher,Bottleneck_1,hasRequiredBottleneck,lib,hasRequiredLib;function requireGroup(){if(hasRequiredGroup)return Group_1;function e(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=[],n=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done)&&(t.push(o.value),!r||t.length!==r);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function r(e,r,t,n,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void t(e)}a.done?r(c):Promise.resolve(c).then(n,i)}function t(e){return function(){var t=this,n=arguments;return new Promise(function(i,s){var o=e.apply(t,n);function a(e){r(o,i,s,a,c,"next",e)}function c(e){r(o,i,s,a,c,"throw",e)}a(void 0)})}}var n,i,s,o,a,c;return hasRequiredGroup=1,c=requireParser(),n=requireEvents(),o=requireRedisConnection(),s=requireIORedisConnection(),a=requireScripts(),i=function(){class r{constructor(e={}){this.deleteKey=this.deleteKey.bind(this),this.limiterOptions=e,c.load(this.limiterOptions,this.defaults,this),this.Events=new n(this),this.instances={},this.Bottleneck=requireBottleneck(),this._startAutoCleanup(),this.sharedConnection=null!=this.connection,null==this.connection&&("redis"===this.limiterOptions.datastore?this.connection=new o(Object.assign({},this.limiterOptions,{Events:this.Events})):"ioredis"===this.limiterOptions.datastore&&(this.connection=new s(Object.assign({},this.limiterOptions,{Events:this.Events}))))}key(e=""){var r;return null!=(r=this.instances[e])?r:(()=>{var r;return r=this.instances[e]=new this.Bottleneck(Object.assign(this.limiterOptions,{id:`${this.id}-${e}`,timeout:this.timeout,connection:this.connection})),this.Events.trigger("created",r,e),r})()}deleteKey(e=""){var r=this;return t(function*(){var t,n;return n=r.instances[e],r.connection&&(t=yield r.connection.__runCommand__(["del",...a.allKeys(`${r.id}-${e}`)])),null!=n&&(delete r.instances[e],yield n.disconnect()),null!=n||t>0})()}limiters(){var e,r,t,n;for(e in t=[],r=this.instances)n=r[e],t.push({key:e,limiter:n});return t}keys(){return Object.keys(this.instances)}clusterKeys(){var r=this;return t(function*(){var t,n,i,s,o,a,c;if(null==r.connection)return r.Promise.resolve(r.keys());for(o=[],t=null,c=`b_${r.id}-`.length,9;0!==t;){var u=e(yield r.connection.__runCommand__(["scan",null!=t?t:0,"match",`b_${r.id}-*_settings`,"count",1e4]),2);for(t=~~u[0],i=0,a=(n=u[1]).length;i<a;i++)s=n[i],o.push(s.slice(c,-9))}return o})()}_startAutoCleanup(){var e,r=this;return clearInterval(this.interval),"function"==typeof(e=this.interval=setInterval(t(function*(){var e,t,n,i,s,o;for(t in s=Date.now(),i=[],n=r.instances){o=n[t];try{(yield o._store.__groupCheck__(s))?i.push(r.deleteKey(t)):i.push(void 0)}catch(r){e=r,i.push(o.Events.trigger("error",e))}}return i}),this.timeout/2)).unref?e.unref():void 0}updateSettings(e={}){if(c.overwrite(e,this.defaults,this),c.overwrite(e,e,this.limiterOptions),null!=e.timeout)return this._startAutoCleanup()}disconnect(e=!0){var r;if(!this.sharedConnection)return null!=(r=this.connection)?r.disconnect(e):void 0}}return r.prototype.defaults={timeout:3e5,connection:null,Promise:Promise,id:"group-key"},r}.call(void 0),Group_1=i}function requireBatcher(){return hasRequiredBatcher?Batcher_1:(hasRequiredBatcher=1,t=requireParser(),r=requireEvents(),e=function(){class e{constructor(e={}){this.options=e,t.load(this.options,this.defaults,this),this.Events=new r(this),this._arr=[],this._resetPromise(),this._lastFlush=Date.now()}_resetPromise(){return this._promise=new this.Promise((e,r)=>this._resolve=e)}_flush(){return clearTimeout(this._timeout),this._lastFlush=Date.now(),this._resolve(),this.Events.trigger("batch",this._arr),this._arr=[],this._resetPromise()}add(e){var r;return this._arr.push(e),r=this._promise,this._arr.length===this.maxSize?this._flush():null!=this.maxTime&&1===this._arr.length&&(this._timeout=setTimeout(()=>this._flush(),this.maxTime)),r}}return e.prototype.defaults={maxTime:null,maxSize:null,Promise:Promise},e}.call(void 0),Batcher_1=e);var e,r,t}function requireBottleneck(){if(hasRequiredBottleneck)return Bottleneck_1;function e(e,r){return n(e)||function(e,r){var t=[],n=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done)&&(t.push(o.value),!r||t.length!==r);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}return t}(e,r)||t()}function r(e){return n(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||t()}function t(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function n(e){if(Array.isArray(e))return e}function i(e,r,t,n,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void t(e)}a.done?r(c):Promise.resolve(c).then(n,i)}function s(e){return function(){var r=this,t=arguments;return new Promise(function(n,s){var o=e.apply(r,t);function a(e){i(o,n,s,a,c,"next",e)}function c(e){i(o,n,s,a,c,"throw",e)}a(void 0)})}}hasRequiredBottleneck=1;var o,a,c,u,l,d,p,h,f,m=[].splice;return f=requireParser(),l=requireQueues(),c=requireJob(),u=requireLocalDatastore(),d=requireRedisDatastore(),a=requireEvents(),p=requireStates(),h=requireSync(),o=function(){class t{constructor(e={},...r){var n,i;this._addToQueue=this._addToQueue.bind(this),this._validateOptions(e,r),f.load(e,this.instanceDefaults,this),this._queues=new l(10),this._scheduled={},this._states=new p(["RECEIVED","QUEUED","RUNNING","EXECUTING"].concat(this.trackDoneStatus?["DONE"]:[])),this._limiter=null,this.Events=new a(this),this._submitLock=new h("submit",this.Promise),this._registerLock=new h("register",this.Promise),i=f.load(e,this.storeDefaults,{}),this._store=function(){if("redis"===this.datastore||"ioredis"===this.datastore||null!=this.connection)return n=f.load(e,this.redisStoreDefaults,{}),new d(this,i,n);if("local"===this.datastore)return n=f.load(e,this.localStoreDefaults,{}),new u(this,i,n);throw new t.prototype.BottleneckError(`Invalid datastore type: ${this.datastore}`)}.call(this),this._queues.on("leftzero",()=>{var e;return null!=(e=this._store.heartbeat)&&"function"==typeof e.ref?e.ref():void 0}),this._queues.on("zero",()=>{var e;return null!=(e=this._store.heartbeat)&&"function"==typeof e.unref?e.unref():void 0})}_validateOptions(e,r){if(null==e||"object"!=typeof e||0!==r.length)throw new t.prototype.BottleneckError("Bottleneck v2 takes a single object argument. Refer to https://github.com/SGrondin/bottleneck#upgrading-to-v2 if you're upgrading from Bottleneck v1.")}ready(){return this._store.ready}clients(){return this._store.clients}channel(){return`b_${this.id}`}channel_client(){return`b_${this.id}_${this._store.clientId}`}publish(e){return this._store.__publish__(e)}disconnect(e=!0){return this._store.__disconnect__(e)}chain(e){return this._limiter=e,this}queued(e){return this._queues.queued(e)}clusterQueued(){return this._store.__queued__()}empty(){return 0===this.queued()&&this._submitLock.isEmpty()}running(){return this._store.__running__()}done(){return this._store.__done__()}jobStatus(e){return this._states.jobStatus(e)}jobs(e){return this._states.statusJobs(e)}counts(){return this._states.statusCounts()}_randomIndex(){return Math.random().toString(36).slice(2)}check(e=1){return this._store.__check__(e)}_clearGlobalState(e){return null!=this._scheduled[e]&&(clearTimeout(this._scheduled[e].expiration),delete this._scheduled[e],!0)}_free(e,r,t,n){var i=this;return s(function*(){var r,s;try{if(s=(yield i._store.__free__(e,t.weight)).running,i.Events.trigger("debug",`Freed ${t.id}`,n),0===s&&i.empty())return i.Events.trigger("idle")}catch(e){return r=e,i.Events.trigger("error",r)}})()}_run(e,r,t){var n,i,s;return r.doRun(),n=this._clearGlobalState.bind(this,e),s=this._run.bind(this,e,r),i=this._free.bind(this,e,r),this._scheduled[e]={timeout:setTimeout(()=>r.doExecute(this._limiter,n,s,i),t),expiration:null!=r.options.expiration?setTimeout(function(){return r.doExpire(n,s,i)},t+r.options.expiration):void 0,job:r}}_drainOne(e){return this._registerLock.schedule(()=>{var r,t,n,i,s;if(0===this.queued())return this.Promise.resolve(null);s=this._queues.getFirst();var o=n=s.first();return i=o.options,r=o.args,null!=e&&i.weight>e?this.Promise.resolve(null):(this.Events.trigger("debug",`Draining ${i.id}`,{args:r,options:i}),t=this._randomIndex(),this._store.__register__(t,i.weight,i.expiration).then(({success:e,wait:o,reservoir:a})=>{var c;return this.Events.trigger("debug",`Drained ${i.id}`,{success:e,args:r,options:i}),e?(s.shift(),(c=this.empty())&&this.Events.trigger("empty"),0===a&&this.Events.trigger("depleted",c),this._run(t,n,o),this.Promise.resolve(i.weight)):this.Promise.resolve(null)}))})}_drainAll(e,r=0){return this._drainOne(e).then(t=>{var n;return null!=t?(n=null!=e?e-t:e,this._drainAll(n,r+t)):this.Promise.resolve(r)}).catch(e=>this.Events.trigger("error",e))}_dropAllQueued(e){return this._queues.shiftAll(function(r){return r.doDrop({message:e})})}stop(e={}){var r,n;return e=f.load(e,this.stopDefaults),n=e=>{var r;return r=()=>{var r;return(r=this._states.counts)[0]+r[1]+r[2]+r[3]===e},new this.Promise((e,t)=>r()?e():this.on("done",()=>{if(r())return this.removeAllListeners("done"),e()}))},r=e.dropWaitingJobs?(this._run=function(r,t){return t.doDrop({message:e.dropErrorMessage})},this._drainOne=()=>this.Promise.resolve(null),this._registerLock.schedule(()=>this._submitLock.schedule(()=>{var r,t,i;for(r in t=this._scheduled)i=t[r],"RUNNING"===this.jobStatus(i.job.options.id)&&(clearTimeout(i.timeout),clearTimeout(i.expiration),i.job.doDrop({message:e.dropErrorMessage}));return this._dropAllQueued(e.dropErrorMessage),n(0)}))):this.schedule({priority:9,weight:0},()=>n(1)),this._receive=function(r){return r._reject(new t.prototype.BottleneckError(e.enqueueErrorMessage))},this.stop=()=>this.Promise.reject(new t.prototype.BottleneckError("stop() has already been called")),r}_addToQueue(e){var r=this;return s(function*(){var n,i,s,o,a,c,u;n=e.args,o=e.options;try{var l=yield r._store.__submit__(r.queued(),o.weight);a=l.reachedHWM,i=l.blocked,u=l.strategy}catch(t){return s=t,r.Events.trigger("debug",`Could not queue ${o.id}`,{args:n,options:o,error:s}),e.doDrop({error:s}),!1}return i?(e.doDrop(),!0):a&&(null!=(c=u===t.prototype.strategy.LEAK?r._queues.shiftLastFrom(o.priority):u===t.prototype.strategy.OVERFLOW_PRIORITY?r._queues.shiftLastFrom(o.priority+1):u===t.prototype.strategy.OVERFLOW?e:void 0)&&c.doDrop(),null==c||u===t.prototype.strategy.OVERFLOW)?(null==c&&e.doDrop(),a):(e.doQueue(a,i),r._queues.push(e),yield r._drainAll(),a)})()}_receive(e){return null!=this._states.jobStatus(e.options.id)?(e._reject(new t.prototype.BottleneckError(`A job with the same id already exists (id=${e.options.id})`)),!1):(e.doReceive(),this._submitLock.schedule(this._addToQueue,e))}submit(...t){var n,i,s,o,a,u,l,d,p;"function"==typeof t[0]?(u=r(t),i=u[0],t=u.slice(1),l=e(m.call(t,-1),1),n=l[0],o=f.load({},this.jobDefaults)):(o=(d=r(t))[0],i=d[1],t=d.slice(2),p=e(m.call(t,-1),1),n=p[0],o=f.load(o,this.jobDefaults));return a=(...e)=>new this.Promise(function(r,t){return i(...e,function(...e){return(null!=e[0]?t:r)(e)})}),(s=new c(a,t,o,this.jobDefaults,this.rejectOnDrop,this.Events,this._states,this.Promise)).promise.then(function(e){return"function"==typeof n?n(...e):void 0}).catch(function(e){return Array.isArray(e)?"function"==typeof n?n(...e):void 0:"function"==typeof n?n(e):void 0}),this._receive(s)}schedule(...e){var t,n,i;if("function"==typeof e[0]){var s=r(e);i=s[0],e=s.slice(1),n={}}else{var o=r(e);n=o[0],i=o[1],e=o.slice(2)}return t=new c(i,e,n,this.jobDefaults,this.rejectOnDrop,this.Events,this._states,this.Promise),this._receive(t),t.promise}wrap(e){var r,t;return r=this.schedule.bind(this),(t=function(...t){return r(e.bind(this),...t)}).withOptions=function(t,...n){return r(t,e,...n)},t}updateSettings(e={}){var r=this;return s(function*(){return yield r._store.__updateSettings__(f.overwrite(e,r.storeDefaults)),f.overwrite(e,r.instanceDefaults,r),r})()}currentReservoir(){return this._store.__currentReservoir__()}incrementReservoir(e=0){return this._store.__incrementReservoir__(e)}}return t.default=t,t.Events=a,t.version=t.prototype.version=require$$8.version,t.strategy=t.prototype.strategy={LEAK:1,OVERFLOW:2,OVERFLOW_PRIORITY:4,BLOCK:3},t.BottleneckError=t.prototype.BottleneckError=requireBottleneckError(),t.Group=t.prototype.Group=requireGroup(),t.RedisConnection=t.prototype.RedisConnection=requireRedisConnection(),t.IORedisConnection=t.prototype.IORedisConnection=requireIORedisConnection(),t.Batcher=t.prototype.Batcher=requireBatcher(),t.prototype.jobDefaults={priority:5,weight:1,expiration:null,id:"<no-id>"},t.prototype.storeDefaults={maxConcurrent:null,minTime:0,highWater:null,strategy:t.prototype.strategy.LEAK,penalty:null,reservoir:null,reservoirRefreshInterval:null,reservoirRefreshAmount:null,reservoirIncreaseInterval:null,reservoirIncreaseAmount:null,reservoirIncreaseMaximum:null},t.prototype.localStoreDefaults={Promise:Promise,timeout:null,heartbeatInterval:250},t.prototype.redisStoreDefaults={Promise:Promise,timeout:null,heartbeatInterval:5e3,clientTimeout:1e4,Redis:null,clientOptions:{},clusterNodes:null,clearDatastore:!1,connection:null},t.prototype.instanceDefaults={datastore:"local",connection:null,id:"<no-id>",rejectOnDrop:!0,trackDoneStatus:!1,Promise:Promise},t.prototype.stopDefaults={enqueueErrorMessage:"This limiter has been stopped and cannot accept new jobs.",dropWaitingJobs:!0,dropErrorMessage:"This limiter has been stopped."},t}.call(void 0),Bottleneck_1=o}function requireLib(){return hasRequiredLib?lib:(hasRequiredLib=1,lib=requireBottleneck())}var libExports=requireLib(),Bottleneck=getDefaultExportFromCjs(libExports),he$1={exports:{}},he=he$1.exports,hasRequiredHe;function requireHe(){return hasRequiredHe||(hasRequiredHe=1,function(e,r){!function(t){var n=r,i=e&&e.exports==n&&e,s="object"==typeof commonjsGlobal&&commonjsGlobal;s.global!==s&&s.window!==s||(t=s);var o=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,a=/[\x01-\x7F]/g,c=/[\x01-\t\x0B\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,u=/<\u20D2|=\u20E5|>\u20D2|\u205F\u200A|\u219D\u0338|\u2202\u0338|\u2220\u20D2|\u2229\uFE00|\u222A\uFE00|\u223C\u20D2|\u223D\u0331|\u223E\u0333|\u2242\u0338|\u224B\u0338|\u224D\u20D2|\u224E\u0338|\u224F\u0338|\u2250\u0338|\u2261\u20E5|\u2264\u20D2|\u2265\u20D2|\u2266\u0338|\u2267\u0338|\u2268\uFE00|\u2269\uFE00|\u226A\u0338|\u226A\u20D2|\u226B\u0338|\u226B\u20D2|\u227F\u0338|\u2282\u20D2|\u2283\u20D2|\u228A\uFE00|\u228B\uFE00|\u228F\u0338|\u2290\u0338|\u2293\uFE00|\u2294\uFE00|\u22B4\u20D2|\u22B5\u20D2|\u22D8\u0338|\u22D9\u0338|\u22DA\uFE00|\u22DB\uFE00|\u22F5\u0338|\u22F9\u0338|\u2933\u0338|\u29CF\u0338|\u29D0\u0338|\u2A6D\u0338|\u2A70\u0338|\u2A7D\u0338|\u2A7E\u0338|\u2AA1\u0338|\u2AA2\u0338|\u2AAC\uFE00|\u2AAD\uFE00|\u2AAF\u0338|\u2AB0\u0338|\u2AC5\u0338|\u2AC6\u0338|\u2ACB\uFE00|\u2ACC\uFE00|\u2AFD\u20E5|[\xA0-\u0113\u0116-\u0122\u0124-\u012B\u012E-\u014D\u0150-\u017E\u0192\u01B5\u01F5\u0237\u02C6\u02C7\u02D8-\u02DD\u0311\u0391-\u03A1\u03A3-\u03A9\u03B1-\u03C9\u03D1\u03D2\u03D5\u03D6\u03DC\u03DD\u03F0\u03F1\u03F5\u03F6\u0401-\u040C\u040E-\u044F\u0451-\u045C\u045E\u045F\u2002-\u2005\u2007-\u2010\u2013-\u2016\u2018-\u201A\u201C-\u201E\u2020-\u2022\u2025\u2026\u2030-\u2035\u2039\u203A\u203E\u2041\u2043\u2044\u204F\u2057\u205F-\u2063\u20AC\u20DB\u20DC\u2102\u2105\u210A-\u2113\u2115-\u211E\u2122\u2124\u2127-\u2129\u212C\u212D\u212F-\u2131\u2133-\u2138\u2145-\u2148\u2153-\u215E\u2190-\u219B\u219D-\u21A7\u21A9-\u21AE\u21B0-\u21B3\u21B5-\u21B7\u21BA-\u21DB\u21DD\u21E4\u21E5\u21F5\u21FD-\u2205\u2207-\u2209\u220B\u220C\u220F-\u2214\u2216-\u2218\u221A\u221D-\u2238\u223A-\u2257\u2259\u225A\u225C\u225F-\u2262\u2264-\u228B\u228D-\u229B\u229D-\u22A5\u22A7-\u22B0\u22B2-\u22BB\u22BD-\u22DB\u22DE-\u22E3\u22E6-\u22F7\u22F9-\u22FE\u2305\u2306\u2308-\u2310\u2312\u2313\u2315\u2316\u231C-\u231F\u2322\u2323\u232D\u232E\u2336\u233D\u233F\u237C\u23B0\u23B1\u23B4-\u23B6\u23DC-\u23DF\u23E2\u23E7\u2423\u24C8\u2500\u2502\u250C\u2510\u2514\u2518\u251C\u2524\u252C\u2534\u253C\u2550-\u256C\u2580\u2584\u2588\u2591-\u2593\u25A1\u25AA\u25AB\u25AD\u25AE\u25B1\u25B3-\u25B5\u25B8\u25B9\u25BD-\u25BF\u25C2\u25C3\u25CA\u25CB\u25EC\u25EF\u25F8-\u25FC\u2605\u2606\u260E\u2640\u2642\u2660\u2663\u2665\u2666\u266A\u266D-\u266F\u2713\u2717\u2720\u2736\u2758\u2772\u2773\u27C8\u27C9\u27E6-\u27ED\u27F5-\u27FA\u27FC\u27FF\u2902-\u2905\u290C-\u2913\u2916\u2919-\u2920\u2923-\u292A\u2933\u2935-\u2939\u293C\u293D\u2945\u2948-\u294B\u294E-\u2976\u2978\u2979\u297B-\u297F\u2985\u2986\u298B-\u2996\u299A\u299C\u299D\u29A4-\u29B7\u29B9\u29BB\u29BC\u29BE-\u29C5\u29C9\u29CD-\u29D0\u29DC-\u29DE\u29E3-\u29E5\u29EB\u29F4\u29F6\u2A00-\u2A02\u2A04\u2A06\u2A0C\u2A0D\u2A10-\u2A17\u2A22-\u2A27\u2A29\u2A2A\u2A2D-\u2A31\u2A33-\u2A3C\u2A3F\u2A40\u2A42-\u2A4D\u2A50\u2A53-\u2A58\u2A5A-\u2A5D\u2A5F\u2A66\u2A6A\u2A6D-\u2A75\u2A77-\u2A9A\u2A9D-\u2AA2\u2AA4-\u2AB0\u2AB3-\u2AC8\u2ACB\u2ACC\u2ACF-\u2ADB\u2AE4\u2AE6-\u2AE9\u2AEB-\u2AF3\u2AFD\uFB00-\uFB04]|\uD835[\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDD6B]/g,l={"":"shy","":"zwnj","":"zwj","":"lrm","":"ic","":"it","":"af","":"rlm","":"ZeroWidthSpace","":"NoBreak","":"DownBreve","":"tdot","":"DotDot","\t":"Tab","\n":"NewLine","":"puncsp","":"MediumSpace","":"thinsp","":"hairsp","":"emsp13","":"ensp","":"emsp14","":"emsp","":"numsp","":"nbsp","":"ThickSpace","":"oline",_:"lowbar","":"dash","":"ndash","":"mdash","":"horbar",",":"comma",";":"semi","":"bsemi",":":"colon","":"Colone","!":"excl","":"iexcl","?":"quest","":"iquest",".":"period","":"nldr","":"mldr","":"middot","'":"apos","":"lsquo","":"rsquo","":"sbquo","":"lsaquo","":"rsaquo",'"':"quot","":"ldquo","":"rdquo","":"bdquo","":"laquo","":"raquo","(":"lpar",")":"rpar","[":"lsqb","]":"rsqb","{":"lcub","}":"rcub","":"lceil","":"rceil","":"lfloor","":"rfloor","":"lopar","":"ropar","":"lbrke","":"rbrke","":"lbrkslu","":"rbrksld","":"lbrksld","":"rbrkslu","":"langd","":"rangd","":"lparlt","":"rpargt","":"gtlPar","":"ltrPar","":"lobrk","":"robrk","":"lang","":"rang","":"Lang","":"Rang","":"loang","":"roang","":"lbbrk","":"rbbrk","":"Vert","":"sect","":"para","@":"commat","*":"ast","/":"sol",undefined:null,"&":"amp","#":"num","%":"percnt","":"permil","":"pertenk","":"dagger","":"Dagger","":"bull","":"hybull","":"prime","":"Prime","":"tprime","":"qprime","":"bprime","":"caret","`":"grave","":"acute","":"tilde","^":"Hat","":"macr","":"breve","":"dot","":"die","":"ring","":"dblac","":"cedil","":"ogon","":"circ","":"caron","":"deg","":"copy","":"reg","":"copysr","":"wp","":"rx","":"mho","":"iiota","":"larr","":"nlarr","":"rarr","":"nrarr","":"uarr","":"darr","":"harr","":"nharr","":"varr","":"nwarr","":"nearr","":"searr","":"swarr","":"rarrw","":"nrarrw","":"Larr","":"Uarr","":"Rarr","":"Darr","":"larrtl","":"rarrtl","":"mapstoleft","":"mapstoup","":"map","":"mapstodown","":"larrhk","":"rarrhk","":"larrlp","":"rarrlp","":"harrw","":"lsh","":"rsh","":"ldsh","":"rdsh","":"crarr","":"cularr","":"curarr","":"olarr","":"orarr","":"lharu","":"lhard","":"uharr","":"uharl","":"rharu","":"rhard","":"dharr","":"dharl","":"rlarr","":"udarr","":"lrarr","":"llarr","":"uuarr","":"rrarr","":"ddarr","":"lrhar","":"rlhar","":"lArr","":"nlArr","":"uArr","":"rArr","":"nrArr","":"dArr","":"iff","":"nhArr","":"vArr","":"nwArr","":"neArr","":"seArr","":"swArr","":"lAarr","":"rAarr","":"zigrarr","":"larrb","":"rarrb","":"duarr","":"loarr","":"roarr","":"hoarr","":"forall","":"comp","":"part","":"npart","":"exist","":"nexist","":"empty","":"Del","":"in","":"notin","":"ni","":"notni","":"bepsi","":"prod","":"coprod","":"sum","+":"plus","":"pm","":"div","":"times","<":"lt","":"nlt","<":"nvlt","=":"equals","":"ne","=":"bne","":"Equal",">":"gt","":"ngt",">":"nvgt","":"not","|":"vert","":"brvbar","":"minus","":"mp","":"plusdo","":"frasl","":"setmn","":"lowast","":"compfn","":"Sqrt","":"prop","":"infin","":"angrt","":"ang","":"nang","":"angmsd","":"angsph","":"mid","":"nmid","":"par","":"npar","":"and","":"or","":"cap","":"caps","":"cup","":"cups","":"int","":"Int","":"tint","":"qint","":"oint","":"Conint","":"Cconint","":"cwint","":"cwconint","":"awconint","":"there4","":"becaus","":"ratio","":"Colon","":"minusd","":"mDDot","":"homtht","":"sim","":"nsim","":"nvsim","":"bsim","":"race","":"ac","":"acE","":"acd","":"wr","":"esim","":"nesim","":"sime","":"nsime","":"cong","":"ncong","":"simne","":"ap","":"nap","":"ape","":"apid","":"napid","":"bcong","":"CupCap","":"NotCupCap","":"nvap","":"bump","":"nbump","":"bumpe","":"nbumpe","":"doteq","":"nedot","":"eDot","":"efDot","":"erDot","":"colone","":"ecolon","":"ecir","":"cire","":"wedgeq","":"veeeq","":"trie","":"equest","":"equiv","":"nequiv","":"bnequiv","":"le","":"nle","":"nvle","":"ge","":"nge","":"nvge","":"lE","":"nlE","":"gE","":"ngE","":"lvnE","":"lnE","":"gnE","":"gvnE","":"ll","":"nLtv","":"nLt","":"gg","":"nGtv","":"nGt","":"twixt","":"lsim","":"nlsim","":"gsim","":"ngsim","":"lg","":"ntlg","":"gl","":"ntgl","":"pr","":"npr","":"sc","":"nsc","":"prcue","":"nprcue","":"sccue","":"nsccue","":"prsim","":"scsim","":"NotSucceedsTilde","":"sub","":"nsub","":"vnsub","":"sup","":"nsup","":"vnsup","":"sube","":"nsube","":"supe","":"nsupe","":"vsubne","":"subne","":"vsupne","":"supne","":"cupdot","":"uplus","":"sqsub","":"NotSquareSubset","":"sqsup","":"NotSquareSuperset","":"sqsube","":"nsqsube","":"sqsupe","":"nsqsupe","":"sqcap","":"sqcaps","":"sqcup","":"sqcups","":"oplus","":"ominus","":"otimes","":"osol","":"odot","":"ocir","":"oast","":"odash","":"plusb","":"minusb","":"timesb","":"sdotb","":"vdash","":"nvdash","":"dashv","":"top","":"bot","":"models","":"vDash","":"nvDash","":"Vdash","":"nVdash","":"Vvdash","":"VDash","":"nVDash","":"prurel","":"vltri","":"nltri","":"vrtri","":"nrtri","":"ltrie","":"nltrie","":"nvltrie","":"rtrie","":"nrtrie","":"nvrtrie","":"origof","":"imof","":"mumap","":"hercon","":"intcal","":"veebar","":"barvee","":"angrtvb","":"lrtri","":"Wedge","":"Vee","":"xcap","":"xcup","":"diam","":"sdot","":"Star","":"divonx","":"bowtie","":"ltimes","":"rtimes","":"lthree","":"rthree","":"bsime","":"cuvee","":"cuwed","":"Sub","":"Sup","":"Cap","":"Cup","":"fork","":"epar","":"ltdot","":"gtdot","":"Ll","":"nLl","":"Gg","":"nGg","":"lesg","":"leg","":"gel","":"gesl","":"cuepr","":"cuesc","":"lnsim","":"gnsim","":"prnsim","":"scnsim","":"vellip","":"ctdot","":"utdot","":"dtdot","":"disin","":"isinsv","":"isins","":"isindot","":"notindot","":"notinvc","":"notinvb","":"isinE","":"notinE","":"nisd","":"xnis","":"nis","":"notnivc","":"notnivb","":"barwed","":"Barwed","":"drcrop","":"dlcrop","":"urcrop","":"ulcrop","":"bnot","":"profline","":"profsurf","":"telrec","":"target","":"ulcorn","":"urcorn","":"dlcorn","":"drcorn","":"frown","":"smile","":"cylcty","":"profalar","":"topbot","":"ovbar","":"solbar","":"angzarr","":"lmoust","":"rmoust","":"tbrk","":"bbrk","":"bbrktbrk","":"OverParenthesis","":"UnderParenthesis","":"OverBrace","":"UnderBrace","":"trpezium","":"elinters","":"blank","":"boxh","":"boxv","":"boxdr","":"boxdl","":"boxur","":"boxul","":"boxvr","":"boxvl","":"boxhd","":"boxhu","":"boxvh","":"boxH","":"boxV","":"boxdR","":"boxDr","":"boxDR","":"boxdL","":"boxDl","":"boxDL","":"boxuR","":"boxUr","":"boxUR","":"boxuL","":"boxUl","":"boxUL","":"boxvR","":"boxVr","":"boxVR","":"boxvL","":"boxVl","":"boxVL","":"boxHd","":"boxhD","":"boxHD","":"boxHu","":"boxhU","":"boxHU","":"boxvH","":"boxVh","":"boxVH","":"uhblk","":"lhblk","":"block","":"blk14","":"blk12","":"blk34","":"squ","":"squf","":"EmptyVerySmallSquare","":"rect","":"marker","":"fltns","":"xutri","":"utrif","":"utri","":"rtrif","":"rtri","":"xdtri","":"dtrif","":"dtri","":"ltrif","":"ltri","":"loz","":"cir","":"tridot","":"xcirc","":"ultri","":"urtri","":"lltri","":"EmptySmallSquare","":"FilledSmallSquare","":"starf","":"star","":"phone","":"female","":"male","":"spades","":"clubs","":"hearts","":"diams","":"sung","":"check","":"cross","":"malt","":"sext","":"VerticalSeparator","":"bsolhsub","":"suphsol","":"xlarr","":"xrarr","":"xharr","":"xlArr","":"xrArr","":"xhArr","":"xmap","":"dzigrarr","":"nvlArr","":"nvrArr","":"nvHarr","":"Map","":"lbarr","":"rbarr","":"lBarr","":"rBarr","":"RBarr","":"DDotrahd","":"UpArrowBar","":"DownArrowBar","":"Rarrtl","":"latail","":"ratail","":"lAtail","":"rAtail","":"larrfs","":"rarrfs","":"larrbfs","":"rarrbfs","":"nwarhk","":"nearhk","":"searhk","":"swarhk","":"nwnear","":"toea","":"tosa","":"swnwar","":"rarrc","":"nrarrc","":"cudarrr","":"ldca","":"rdca","":"cudarrl","":"larrpl","":"curarrm","":"cularrp","":"rarrpl","":"harrcir","":"Uarrocir","":"lurdshar","":"ldrushar","":"LeftRightVector","":"RightUpDownVector","":"DownLeftRightVector","":"LeftUpDownVector","":"LeftVectorBar","":"RightVectorBar","":"RightUpVectorBar","":"RightDownVectorBar","":"DownLeftVectorBar","":"DownRightVectorBar","":"LeftUpVectorBar","":"LeftDownVectorBar","":"LeftTeeVector","":"RightTeeVector","":"RightUpTeeVector","":"RightDownTeeVector","":"DownLeftTeeVector","":"DownRightTeeVector","":"LeftUpTeeVector","":"LeftDownTeeVector","":"lHar","":"uHar","":"rHar","":"dHar","":"luruhar","":"ldrdhar","":"ruluhar","":"rdldhar","":"lharul","":"llhard","":"rharul","":"lrhard","":"udhar","":"duhar","":"RoundImplies","":"erarr","":"simrarr","":"larrsim","":"rarrsim","":"rarrap","":"ltlarr","":"gtrarr","":"subrarr","":"suplarr","":"lfisht","":"rfisht","":"ufisht","":"dfisht","":"vzigzag","":"vangrt","":"angrtvbd","":"ange","":"range","":"dwangle","":"uwangle","":"angmsdaa","":"angmsdab","":"angmsdac","":"angmsdad","":"angmsdae","":"angmsdaf","":"angmsdag","":"angmsdah","":"bemptyv","":"demptyv","":"cemptyv","":"raemptyv","":"laemptyv","":"ohbar","":"omid","":"opar","":"operp","":"olcross","":"odsold","":"olcir","":"ofcir","":"olt","":"ogt","":"cirscir","":"cirE","":"solb","":"bsolb","":"boxbox","":"trisb","":"rtriltri","":"LeftTriangleBar","":"NotLeftTriangleBar","":"RightTriangleBar","":"NotRightTriangleBar","":"iinfin","":"infintie","":"nvinfin","":"eparsl","":"smeparsl","":"eqvparsl","":"lozf","":"RuleDelayed","":"dsol","":"xodot","":"xoplus","":"xotime","":"xuplus","":"xsqcup","":"fpartint","":"cirfnint","":"awint","":"rppolint","":"scpolint","":"npolint","":"pointint","":"quatint","":"intlarhk","":"pluscir","":"plusacir","":"simplus","":"plusdu","":"plussim","":"plustwo","":"mcomma","":"minusdu","":"loplus","":"roplus","":"Cross","":"timesd","":"timesbar","":"smashp","":"lotimes","":"rotimes","":"otimesas","":"Otimes","":"odiv","":"triplus","":"triminus","":"tritime","":"iprod","":"amalg","":"capdot","":"ncup","":"ncap","":"capand","":"cupor","":"cupcap","":"capcup","":"cupbrcap","":"capbrcup","":"cupcup","":"capcap","":"ccups","":"ccaps","":"ccupssm","":"And","":"Or","":"andand","":"oror","":"orslope","":"andslope","":"andv","":"orv","":"andd","":"ord","":"wedbar","":"sdote","":"simdot","":"congdot","":"ncongdot","":"easter","":"apacir","":"apE","":"napE","":"eplus","":"pluse","":"Esim","":"eDDot","":"equivDD","":"ltcir","":"gtcir","":"ltquest","":"gtquest","":"les","":"nles","":"ges","":"nges","":"lesdot","":"gesdot","":"lesdoto","":"gesdoto","":"lesdotor","":"gesdotol","":"lap","":"gap","":"lne","":"gne","":"lnap","":"gnap","":"lEg","":"gEl","":"lsime","":"gsime","":"lsimg","":"gsiml","":"lgE","":"glE","":"lesges","":"gesles","":"els","":"egs","":"elsdot","":"egsdot","":"el","":"eg","":"siml","":"simg","":"simlE","":"simgE","":"LessLess","":"NotNestedLessLess","":"GreaterGreater","":"NotNestedGreaterGreater","":"glj","":"gla","":"ltcc","":"gtcc","":"lescc","":"gescc","":"smt","":"lat","":"smte","":"smtes","":"late","":"lates","":"bumpE","":"pre","":"npre","":"sce","":"nsce","":"prE","":"scE","":"prnE","":"scnE","":"prap","":"scap","":"prnap","":"scnap","":"Pr","":"Sc","":"subdot","":"supdot","":"subplus","":"supplus","":"submult","":"supmult","":"subedot","":"supedot","":"subE","":"nsubE","":"supE","":"nsupE","":"subsim","":"supsim","":"vsubnE","":"subnE","":"vsupnE","":"supnE","":"csub","":"csup","":"csube","":"csupe","":"subsup","":"supsub","":"subsub","":"supsup","":"suphsub","":"supdsub","":"forkv","":"topfork","":"mlcp","":"Dashv","":"Vdashl","":"Barv","":"vBar","":"vBarv","":"Vbar","":"Not","":"bNot","":"rnmid","":"cirmid","":"midcir","":"topcir","":"nhpar","":"parsim","":"parsl","":"nparsl","":"flat","":"natur","":"sharp","":"curren","":"cent",$:"dollar","":"pound","":"yen","":"euro","":"sup1","":"half","":"frac13","":"frac14","":"frac15","":"frac16","":"frac18","":"sup2","":"frac23","":"frac25","":"sup3","":"frac34","":"frac35","":"frac38","":"frac45","":"frac56","":"frac58","":"frac78","":"ascr","":"aopf","":"afr","":"Aopf","":"Afr","":"Ascr","":"ordf","":"aacute","":"Aacute","":"agrave","":"Agrave","":"abreve","":"Abreve","":"acirc","":"Acirc","":"aring","":"angst","":"auml","":"Auml","":"atilde","":"Atilde","":"aogon","":"Aogon","":"amacr","":"Amacr","":"aelig","":"AElig","":"bscr","":"bopf","":"bfr","":"Bopf","":"Bscr","":"Bfr","":"cfr","":"cscr","":"copf","":"Cfr","":"Cscr","":"Copf","":"cacute","":"Cacute","":"ccirc","":"Ccirc","":"ccaron","":"Ccaron","":"cdot","":"Cdot","":"ccedil","":"Ccedil","":"incare","":"dfr","":"dd","":"dopf","":"dscr","":"Dscr","":"Dfr","":"DD","":"Dopf","":"dcaron","":"Dcaron","":"dstrok","":"Dstrok","":"eth","":"ETH","":"ee","":"escr","":"efr","":"eopf","":"Escr","":"Efr","":"Eopf","":"eacute","":"Eacute","":"egrave","":"Egrave","":"ecirc","":"Ecirc","":"ecaron","":"Ecaron","":"euml","":"Euml","":"edot","":"Edot","":"eogon","":"Eogon","":"emacr","":"Emacr","":"ffr","":"fopf","":"fscr","":"Ffr","":"Fopf","":"Fscr","":"fflig","":"ffilig","":"ffllig","":"filig",fj:"fjlig","":"fllig","":"fnof","":"gscr","":"gopf","":"gfr","":"Gscr","":"Gopf","":"Gfr","":"gacute","":"gbreve","":"Gbreve","":"gcirc","":"Gcirc","":"gdot","":"Gdot","":"Gcedil","":"hfr","":"planckh","":"hscr","":"hopf","":"Hscr","":"Hfr","":"Hopf","":"hcirc","":"Hcirc","":"hbar","":"hstrok","":"Hstrok","":"iopf","":"ifr","":"iscr","":"ii","":"Iopf","":"Iscr","":"Im","":"iacute","":"Iacute","":"igrave","":"Igrave","":"icirc","":"Icirc","":"iuml","":"Iuml","":"itilde","":"Itilde","":"Idot","":"iogon","":"Iogon","":"imacr","":"Imacr","":"ijlig","":"IJlig","":"imath","":"jscr","":"jopf","":"jfr","":"Jscr","":"Jfr","":"Jopf","":"jcirc","":"Jcirc","":"jmath","":"kopf","":"kscr","":"kfr","":"Kscr","":"Kopf","":"Kfr","":"kcedil","":"Kcedil","":"lfr","":"lscr","":"ell","":"lopf","":"Lscr","":"Lfr","":"Lopf","":"lacute","":"Lacute","":"lcaron","":"Lcaron","":"lcedil","":"Lcedil","":"lstrok","":"Lstrok","":"lmidot","":"Lmidot","":"mfr","":"mopf","":"mscr","":"Mfr","":"Mopf","":"Mscr","":"nfr","":"nopf","":"nscr","":"Nopf","":"Nscr","":"Nfr","":"nacute","":"Nacute","":"ncaron","":"Ncaron","":"ntilde","":"Ntilde","":"ncedil","":"Ncedil","":"numero","":"eng","":"ENG","":"oopf","":"ofr","":"oscr","":"Oscr","":"Ofr","":"Oopf","":"ordm","":"oacute","":"Oacute","":"ograve","":"Ograve","":"ocirc","":"Ocirc","":"ouml","":"Ouml","":"odblac","":"Odblac","":"otilde","":"Otilde","":"oslash","":"Oslash","":"omacr","":"Omacr","":"oelig","":"OElig","":"pfr","":"pscr","":"popf","":"Popf","":"Pfr","":"Pscr","":"qopf","":"qfr","":"qscr","":"Qscr","":"Qfr","":"Qopf","":"kgreen","":"rfr","":"ropf","":"rscr","":"Rscr","":"Re","":"Ropf","":"racute","":"Racute","":"rcaron","":"Rcaron","":"rcedil","":"Rcedil","":"sopf","":"sscr","":"sfr","":"Sopf","":"Sfr","":"Sscr","":"oS","":"sacute","":"Sacute","":"scirc","":"Scirc","":"scaron","":"Scaron","":"scedil","":"Scedil","":"szlig","":"tfr","":"tscr","":"topf","":"Tscr","":"Tfr","":"Topf","":"tcaron","":"Tcaron","":"tcedil","":"Tcedil","":"trade","":"tstrok","":"Tstrok","":"uscr","":"uopf","":"ufr","":"Uopf","":"Ufr","":"Uscr","":"uacute","":"Uacute","":"ugrave","":"Ugrave","":"ubreve","":"Ubreve","":"ucirc","":"Ucirc","":"uring","":"Uring","":"uuml","":"Uuml","":"udblac","":"Udblac","":"utilde","":"Utilde","":"uogon","":"Uogon","":"umacr","":"Umacr","":"vfr","":"vopf","":"vscr","":"Vfr","":"Vopf","":"Vscr","":"wopf","":"wscr","":"wfr","":"Wscr","":"Wopf","":"Wfr","":"wcirc","":"Wcirc","":"xfr","":"xscr","":"xopf","":"Xopf","":"Xfr","":"Xscr","":"yfr","":"yscr","":"yopf","":"Yscr","":"Yfr","":"Yopf","":"yacute","":"Yacute","":"ycirc","":"Ycirc","":"yuml","":"Yuml","":"zscr","":"zfr","":"zopf","":"Zfr","":"Zopf","":"Zscr","":"zacute","":"Zacute","":"zcaron","":"Zcaron","":"zdot","":"Zdot","":"imped","":"thorn","":"THORN","":"napos","":"alpha","":"Alpha","":"beta","":"Beta","":"gamma","":"Gamma","":"delta","":"Delta","":"epsi","":"epsiv","":"Epsilon","":"gammad","":"Gammad","":"zeta","":"Zeta","":"eta","":"Eta","":"theta","":"thetav","":"Theta","":"iota","":"Iota","":"kappa","":"kappav","":"Kappa","":"lambda","":"Lambda","":"mu","":"micro","":"Mu","":"nu","":"Nu","":"xi","":"Xi","":"omicron","":"Omicron","":"pi","":"piv","":"Pi","":"rho","":"rhov","":"Rho","":"sigma","":"Sigma","":"sigmaf","":"tau","":"Tau","":"upsi","":"Upsilon","":"Upsi","":"phi","":"phiv","":"Phi","":"chi","":"Chi","":"psi","":"Psi","":"omega","":"ohm","":"acy","":"Acy","":"bcy","":"Bcy","":"vcy","":"Vcy","":"gcy","":"Gcy","":"gjcy","":"GJcy","":"dcy","":"Dcy","":"djcy","":"DJcy","":"iecy","":"IEcy","":"iocy","":"IOcy","":"jukcy","":"Jukcy","":"zhcy","":"ZHcy","":"zcy","":"Zcy","":"dscy","":"DScy","":"icy","":"Icy","":"iukcy","":"Iukcy","":"yicy","":"YIcy","":"jcy","":"Jcy","":"jsercy","":"Jsercy","":"kcy","":"Kcy","":"kjcy","":"KJcy","":"lcy","":"Lcy","":"ljcy","":"LJcy","":"mcy","":"Mcy","":"ncy","":"Ncy","":"njcy","":"NJcy","":"ocy","":"Ocy","":"pcy","":"Pcy","":"rcy","":"Rcy","":"scy","":"Scy","":"tcy","":"Tcy","":"tshcy","":"TSHcy","":"ucy","":"Ucy","":"ubrcy","":"Ubrcy","":"fcy","":"Fcy","":"khcy","":"KHcy","":"tscy","":"TScy","":"chcy","":"CHcy","":"dzcy","":"DZcy","":"shcy","":"SHcy","":"shchcy","":"SHCHcy","":"hardcy","":"HARDcy","":"ycy","":"Ycy","":"softcy","":"SOFTcy","":"ecy","":"Ecy","":"yucy","":"YUcy","":"yacy","":"YAcy","":"aleph","":"beth","":"gimel","":"daleth"},d=/["&'<>`]/g,p={'"':"&quot;","&":"&amp;","'":"&#x27;","<":"&lt;",">":"&gt;","`":"&#x60;"},h=/&#(?:[xX][^a-fA-F0-9]|[^0-9xX])/,f=/[\0-\x08\x0B\x0E-\x1F\x7F-\x9F\uFDD0-\uFDEF\uFFFE\uFFFF]|[\uD83F\uD87F\uD8BF\uD8FF\uD93F\uD97F\uD9BF\uD9FF\uDA3F\uDA7F\uDABF\uDAFF\uDB3F\uDB7F\uDBBF\uDBFF][\uDFFE\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,m=/&(CounterClockwiseContourIntegral|DoubleLongLeftRightArrow|ClockwiseContourIntegral|NotNestedGreaterGreater|NotSquareSupersetEqual|DiacriticalDoubleAcute|NotRightTriangleEqual|NotSucceedsSlantEqual|NotPrecedesSlantEqual|CloseCurlyDoubleQuote|NegativeVeryThinSpace|DoubleContourIntegral|FilledVerySmallSquare|CapitalDifferentialD|OpenCurlyDoubleQuote|EmptyVerySmallSquare|NestedGreaterGreater|DoubleLongRightArrow|NotLeftTriangleEqual|NotGreaterSlantEqual|ReverseUpEquilibrium|DoubleLeftRightArrow|NotSquareSubsetEqual|NotDoubleVerticalBar|RightArrowLeftArrow|NotGreaterFullEqual|NotRightTriangleBar|SquareSupersetEqual|DownLeftRightVector|DoubleLongLeftArrow|leftrightsquigarrow|LeftArrowRightArrow|NegativeMediumSpace|blacktriangleright|RightDownVectorBar|PrecedesSlantEqual|RightDoubleBracket|SucceedsSlantEqual|NotLeftTriangleBar|RightTriangleEqual|SquareIntersection|RightDownTeeVector|ReverseEquilibrium|NegativeThickSpace|longleftrightarrow|Longleftrightarrow|LongLeftRightArrow|DownRightTeeVector|DownRightVectorBar|GreaterSlantEqual|SquareSubsetEqual|LeftDownVectorBar|LeftDoubleBracket|VerticalSeparator|rightleftharpoons|NotGreaterGreater|NotSquareSuperset|blacktriangleleft|blacktriangledown|NegativeThinSpace|LeftDownTeeVector|NotLessSlantEqual|leftrightharpoons|DoubleUpDownArrow|DoubleVerticalBar|LeftTriangleEqual|FilledSmallSquare|twoheadrightarrow|NotNestedLessLess|DownLeftTeeVector|DownLeftVectorBar|RightAngleBracket|NotTildeFullEqual|NotReverseElement|RightUpDownVector|DiacriticalTilde|NotSucceedsTilde|circlearrowright|NotPrecedesEqual|rightharpoondown|DoubleRightArrow|NotSucceedsEqual|NonBreakingSpace|NotRightTriangle|LessEqualGreater|RightUpTeeVector|LeftAngleBracket|GreaterFullEqual|DownArrowUpArrow|RightUpVectorBar|twoheadleftarrow|GreaterEqualLess|downharpoonright|RightTriangleBar|ntrianglerighteq|NotSupersetEqual|LeftUpDownVector|DiacriticalAcute|rightrightarrows|vartriangleright|UpArrowDownArrow|DiacriticalGrave|UnderParenthesis|EmptySmallSquare|LeftUpVectorBar|leftrightarrows|DownRightVector|downharpoonleft|trianglerighteq|ShortRightArrow|OverParenthesis|DoubleLeftArrow|DoubleDownArrow|NotSquareSubset|bigtriangledown|ntrianglelefteq|UpperRightArrow|curvearrowright|vartriangleleft|NotLeftTriangle|nleftrightarrow|LowerRightArrow|NotHumpDownHump|NotGreaterTilde|rightthreetimes|LeftUpTeeVector|NotGreaterEqual|straightepsilon|LeftTriangleBar|rightsquigarrow|ContourIntegral|rightleftarrows|CloseCurlyQuote|RightDownVector|LeftRightVector|nLeftrightarrow|leftharpoondown|circlearrowleft|SquareSuperset|OpenCurlyQuote|hookrightarrow|HorizontalLine|DiacriticalDot|NotLessGreater|ntriangleright|DoubleRightTee|InvisibleComma|InvisibleTimes|LowerLeftArrow|DownLeftVector|NotSubsetEqual|curvearrowleft|trianglelefteq|NotVerticalBar|TildeFullEqual|downdownarrows|NotGreaterLess|RightTeeVector|ZeroWidthSpace|looparrowright|LongRightArrow|doublebarwedge|ShortLeftArrow|ShortDownArrow|RightVectorBar|GreaterGreater|ReverseElement|rightharpoonup|LessSlantEqual|leftthreetimes|upharpoonright|rightarrowtail|LeftDownVector|Longrightarrow|NestedLessLess|UpperLeftArrow|nshortparallel|leftleftarrows|leftrightarrow|Leftrightarrow|LeftRightArrow|longrightarrow|upharpoonleft|RightArrowBar|ApplyFunction|LeftTeeVector|leftarrowtail|NotEqualTilde|varsubsetneqq|varsupsetneqq|RightTeeArrow|SucceedsEqual|SucceedsTilde|LeftVectorBar|SupersetEqual|hookleftarrow|DifferentialD|VerticalTilde|VeryThinSpace|blacktriangle|bigtriangleup|LessFullEqual|divideontimes|leftharpoonup|UpEquilibrium|ntriangleleft|RightTriangle|measuredangle|shortparallel|longleftarrow|Longleftarrow|LongLeftArrow|DoubleLeftTee|Poincareplane|PrecedesEqual|triangleright|DoubleUpArrow|RightUpVector|fallingdotseq|looparrowleft|PrecedesTilde|NotTildeEqual|NotTildeTilde|smallsetminus|Proportional|triangleleft|triangledown|UnderBracket|NotHumpEqual|exponentiale|ExponentialE|NotLessTilde|HilbertSpace|RightCeiling|blacklozenge|varsupsetneq|HumpDownHump|GreaterEqual|VerticalLine|LeftTeeArrow|NotLessEqual|DownTeeArrow|LeftTriangle|varsubsetneq|Intersection|NotCongruent|DownArrowBar|LeftUpVector|LeftArrowBar|risingdotseq|GreaterTilde|RoundImplies|SquareSubset|ShortUpArrow|NotSuperset|quaternions|precnapprox|backepsilon|preccurlyeq|OverBracket|blacksquare|MediumSpace|VerticalBar|circledcirc|circleddash|CircleMinus|CircleTimes|LessGreater|curlyeqprec|curlyeqsucc|diamondsuit|UpDownArrow|Updownarrow|RuleDelayed|Rrightarrow|updownarrow|RightVector|nRightarrow|nrightarrow|eqslantless|LeftCeiling|Equilibrium|SmallCircle|expectation|NotSucceeds|thickapprox|GreaterLess|SquareUnion|NotPrecedes|NotLessLess|straightphi|succnapprox|succcurlyeq|SubsetEqual|sqsupseteq|Proportion|Laplacetrf|ImaginaryI|supsetneqq|NotGreater|gtreqqless|NotElement|ThickSpace|TildeEqual|TildeTilde|Fouriertrf|rmoustache|EqualTilde|eqslantgtr|UnderBrace|LeftVector|UpArrowBar|nLeftarrow|nsubseteqq|subsetneqq|nsupseteqq|nleftarrow|succapprox|lessapprox|UpTeeArrow|upuparrows|curlywedge|lesseqqgtr|varepsilon|varnothing|RightFloor|complement|CirclePlus|sqsubseteq|Lleftarrow|circledast|RightArrow|Rightarrow|rightarrow|lmoustache|Bernoullis|precapprox|mapstoleft|mapstodown|longmapsto|dotsquare|downarrow|DoubleDot|nsubseteq|supsetneq|leftarrow|nsupseteq|subsetneq|ThinSpace|ngeqslant|subseteqq|HumpEqual|NotSubset|triangleq|NotCupCap|lesseqgtr|heartsuit|TripleDot|Leftarrow|Coproduct|Congruent|varpropto|complexes|gvertneqq|LeftArrow|LessTilde|supseteqq|MinusPlus|CircleDot|nleqslant|NotExists|gtreqless|nparallel|UnionPlus|LeftFloor|checkmark|CenterDot|centerdot|Mellintrf|gtrapprox|bigotimes|OverBrace|spadesuit|therefore|pitchfork|rationals|PlusMinus|Backslash|Therefore|DownBreve|backsimeq|backprime|DownArrow|nshortmid|Downarrow|lvertneqq|eqvparsl|imagline|imagpart|infintie|integers|Integral|intercal|LessLess|Uarrocir|intlarhk|sqsupset|angmsdaf|sqsubset|llcorner|vartheta|cupbrcap|lnapprox|Superset|SuchThat|succnsim|succneqq|angmsdag|biguplus|curlyvee|trpezium|Succeeds|NotTilde|bigwedge|angmsdah|angrtvbd|triminus|cwconint|fpartint|lrcorner|smeparsl|subseteq|urcorner|lurdshar|laemptyv|DDotrahd|approxeq|ldrushar|awconint|mapstoup|backcong|shortmid|triangle|geqslant|gesdotol|timesbar|circledR|circledS|setminus|multimap|naturals|scpolint|ncongdot|RightTee|boxminus|gnapprox|boxtimes|andslope|thicksim|angmsdaa|varsigma|cirfnint|rtriltri|angmsdab|rppolint|angmsdac|barwedge|drbkarow|clubsuit|thetasym|bsolhsub|capbrcup|dzigrarr|doteqdot|DotEqual|dotminus|UnderBar|NotEqual|realpart|otimesas|ulcorner|hksearow|hkswarow|parallel|PartialD|elinters|emptyset|plusacir|bbrktbrk|angmsdad|pointint|bigoplus|angmsdae|Precedes|bigsqcup|varkappa|notindot|supseteq|precneqq|precnsim|profalar|profline|profsurf|leqslant|lesdotor|raemptyv|subplus|notnivb|notnivc|subrarr|zigrarr|vzigzag|submult|subedot|Element|between|cirscir|larrbfs|larrsim|lotimes|lbrksld|lbrkslu|lozenge|ldrdhar|dbkarow|bigcirc|epsilon|simrarr|simplus|ltquest|Epsilon|luruhar|gtquest|maltese|npolint|eqcolon|npreceq|bigodot|ddagger|gtrless|bnequiv|harrcir|ddotseq|equivDD|backsim|demptyv|nsqsube|nsqsupe|Upsilon|nsubset|upsilon|minusdu|nsucceq|swarrow|nsupset|coloneq|searrow|boxplus|napprox|natural|asympeq|alefsym|congdot|nearrow|bigstar|diamond|supplus|tritime|LeftTee|nvinfin|triplus|NewLine|nvltrie|nvrtrie|nwarrow|nexists|Diamond|ruluhar|Implies|supmult|angzarr|suplarr|suphsub|questeq|because|digamma|Because|olcross|bemptyv|omicron|Omicron|rotimes|NoBreak|intprod|angrtvb|orderof|uwangle|suphsol|lesdoto|orslope|DownTee|realine|cudarrl|rdldhar|OverBar|supedot|lessdot|supdsub|topfork|succsim|rbrkslu|rbrksld|pertenk|cudarrr|isindot|planckh|lessgtr|pluscir|gesdoto|plussim|plustwo|lesssim|cularrp|rarrsim|Cayleys|notinva|notinvb|notinvc|UpArrow|Uparrow|uparrow|NotLess|dwangle|precsim|Product|curarrm|Cconint|dotplus|rarrbfs|ccupssm|Cedilla|cemptyv|notniva|quatint|frac35|frac38|frac45|frac56|frac58|frac78|tridot|xoplus|gacute|gammad|Gammad|lfisht|lfloor|bigcup|sqsupe|gbreve|Gbreve|lharul|sqsube|sqcups|Gcedil|apacir|llhard|lmidot|Lmidot|lmoust|andand|sqcaps|approx|Abreve|spades|circeq|tprime|divide|topcir|Assign|topbot|gesdot|divonx|xuplus|timesd|gesles|atilde|solbar|SOFTcy|loplus|timesb|lowast|lowbar|dlcorn|dlcrop|softcy|dollar|lparlt|thksim|lrhard|Atilde|lsaquo|smashp|bigvee|thinsp|wreath|bkarow|lsquor|lstrok|Lstrok|lthree|ltimes|ltlarr|DotDot|simdot|ltrPar|weierp|xsqcup|angmsd|sigmav|sigmaf|zeetrf|Zcaron|zcaron|mapsto|vsupne|thetav|cirmid|marker|mcomma|Zacute|vsubnE|there4|gtlPar|vsubne|bottom|gtrarr|SHCHcy|shchcy|midast|midcir|middot|minusb|minusd|gtrdot|bowtie|sfrown|mnplus|models|colone|seswar|Colone|mstpos|searhk|gtrsim|nacute|Nacute|boxbox|telrec|hairsp|Tcedil|nbumpe|scnsim|ncaron|Ncaron|ncedil|Ncedil|hamilt|Scedil|nearhk|hardcy|HARDcy|tcedil|Tcaron|commat|nequiv|nesear|tcaron|target|hearts|nexist|varrho|scedil|Scaron|scaron|hellip|Sacute|sacute|hercon|swnwar|compfn|rtimes|rthree|rsquor|rsaquo|zacute|wedgeq|homtht|barvee|barwed|Barwed|rpargt|horbar|conint|swarhk|roplus|nltrie|hslash|hstrok|Hstrok|rmoust|Conint|bprime|hybull|hyphen|iacute|Iacute|supsup|supsub|supsim|varphi|coprod|brvbar|agrave|Supset|supset|igrave|Igrave|notinE|Agrave|iiiint|iinfin|copysr|wedbar|Verbar|vangrt|becaus|incare|verbar|inodot|bullet|drcorn|intcal|drcrop|cularr|vellip|Utilde|bumpeq|cupcap|dstrok|Dstrok|CupCap|cupcup|cupdot|eacute|Eacute|supdot|iquest|easter|ecaron|Ecaron|ecolon|isinsv|utilde|itilde|Itilde|curarr|succeq|Bumpeq|cacute|ulcrop|nparsl|Cacute|nprcue|egrave|Egrave|nrarrc|nrarrw|subsup|subsub|nrtrie|jsercy|nsccue|Jsercy|kappav|kcedil|Kcedil|subsim|ulcorn|nsimeq|egsdot|veebar|kgreen|capand|elsdot|Subset|subset|curren|aacute|lacute|Lacute|emptyv|ntilde|Ntilde|lagran|lambda|Lambda|capcap|Ugrave|langle|subdot|emsp13|numero|emsp14|nvdash|nvDash|nVdash|nVDash|ugrave|ufisht|nvHarr|larrfs|nvlArr|larrhk|larrlp|larrpl|nvrArr|Udblac|nwarhk|larrtl|nwnear|oacute|Oacute|latail|lAtail|sstarf|lbrace|odblac|Odblac|lbrack|udblac|odsold|eparsl|lcaron|Lcaron|ograve|Ograve|lcedil|Lcedil|Aacute|ssmile|ssetmn|squarf|ldquor|capcup|ominus|cylcty|rharul|eqcirc|dagger|rfloor|rfisht|Dagger|daleth|equals|origof|capdot|equest|dcaron|Dcaron|rdquor|oslash|Oslash|otilde|Otilde|otimes|Otimes|urcrop|Ubreve|ubreve|Yacute|Uacute|uacute|Rcedil|rcedil|urcorn|parsim|Rcaron|Vdashl|rcaron|Tstrok|percnt|period|permil|Exists|yacute|rbrack|rbrace|phmmat|ccaron|Ccaron|planck|ccedil|plankv|tstrok|female|plusdo|plusdu|ffilig|plusmn|ffllig|Ccedil|rAtail|dfisht|bernou|ratail|Rarrtl|rarrtl|angsph|rarrpl|rarrlp|rarrhk|xwedge|xotime|forall|ForAll|Vvdash|vsupnE|preceq|bigcap|frac12|frac13|frac14|primes|rarrfs|prnsim|frac15|Square|frac16|square|lesdot|frac18|frac23|propto|prurel|rarrap|rangle|puncsp|frac25|Racute|qprime|racute|lesges|frac34|abreve|AElig|eqsim|utdot|setmn|urtri|Equal|Uring|seArr|uring|searr|dashv|Dashv|mumap|nabla|iogon|Iogon|sdote|sdotb|scsim|napid|napos|equiv|natur|Acirc|dblac|erarr|nbump|iprod|erDot|ucirc|awint|esdot|angrt|ncong|isinE|scnap|Scirc|scirc|ndash|isins|Ubrcy|nearr|neArr|isinv|nedot|ubrcy|acute|Ycirc|iukcy|Iukcy|xutri|nesim|caret|jcirc|Jcirc|caron|twixt|ddarr|sccue|exist|jmath|sbquo|ngeqq|angst|ccaps|lceil|ngsim|UpTee|delta|Delta|rtrif|nharr|nhArr|nhpar|rtrie|jukcy|Jukcy|kappa|rsquo|Kappa|nlarr|nlArr|TSHcy|rrarr|aogon|Aogon|fflig|xrarr|tshcy|ccirc|nleqq|filig|upsih|nless|dharl|nlsim|fjlig|ropar|nltri|dharr|robrk|roarr|fllig|fltns|roang|rnmid|subnE|subne|lAarr|trisb|Ccirc|acirc|ccups|blank|VDash|forkv|Vdash|langd|cedil|blk12|blk14|laquo|strns|diams|notin|vDash|larrb|blk34|block|disin|uplus|vdash|vBarv|aelig|starf|Wedge|check|xrArr|lates|lbarr|lBarr|notni|lbbrk|bcong|frasl|lbrke|frown|vrtri|vprop|vnsup|gamma|Gamma|wedge|xodot|bdquo|srarr|doteq|ldquo|boxdl|boxdL|gcirc|Gcirc|boxDl|boxDL|boxdr|boxdR|boxDr|TRADE|trade|rlhar|boxDR|vnsub|npart|vltri|rlarr|boxhd|boxhD|nprec|gescc|nrarr|nrArr|boxHd|boxHD|boxhu|boxhU|nrtri|boxHu|clubs|boxHU|times|colon|Colon|gimel|xlArr|Tilde|nsime|tilde|nsmid|nspar|THORN|thorn|xlarr|nsube|nsubE|thkap|xhArr|comma|nsucc|boxul|boxuL|nsupe|nsupE|gneqq|gnsim|boxUl|boxUL|grave|boxur|boxuR|boxUr|boxUR|lescc|angle|bepsi|boxvh|varpi|boxvH|numsp|Theta|gsime|gsiml|theta|boxVh|boxVH|boxvl|gtcir|gtdot|boxvL|boxVl|boxVL|crarr|cross|Cross|nvsim|boxvr|nwarr|nwArr|sqsup|dtdot|Uogon|lhard|lharu|dtrif|ocirc|Ocirc|lhblk|duarr|odash|sqsub|Hacek|sqcup|llarr|duhar|oelig|OElig|ofcir|boxvR|uogon|lltri|boxVr|csube|uuarr|ohbar|csupe|ctdot|olarr|olcir|harrw|oline|sqcap|omacr|Omacr|omega|Omega|boxVR|aleph|lneqq|lnsim|loang|loarr|rharu|lobrk|hcirc|operp|oplus|rhard|Hcirc|orarr|Union|order|ecirc|Ecirc|cuepr|szlig|cuesc|breve|reals|eDDot|Breve|hoarr|lopar|utrif|rdquo|Umacr|umacr|efDot|swArr|ultri|alpha|rceil|ovbar|swarr|Wcirc|wcirc|smtes|smile|bsemi|lrarr|aring|parsl|lrhar|bsime|uhblk|lrtri|cupor|Aring|uharr|uharl|slarr|rbrke|bsolb|lsime|rbbrk|RBarr|lsimg|phone|rBarr|rbarr|icirc|lsquo|Icirc|emacr|Emacr|ratio|simne|plusb|simlE|simgE|simeq|pluse|ltcir|ltdot|empty|xharr|xdtri|iexcl|Alpha|ltrie|rarrw|pound|ltrif|xcirc|bumpe|prcue|bumpE|asymp|amacr|cuvee|Sigma|sigma|iiint|udhar|iiota|ijlig|IJlig|supnE|imacr|Imacr|prime|Prime|image|prnap|eogon|Eogon|rarrc|mdash|mDDot|cuwed|imath|supne|imped|Amacr|udarr|prsim|micro|rarrb|cwint|raquo|infin|eplus|range|rangd|Ucirc|radic|minus|amalg|veeeq|rAarr|epsiv|ycirc|quest|sharp|quot|zwnj|Qscr|race|qscr|Qopf|qopf|qint|rang|Rang|Zscr|zscr|Zopf|zopf|rarr|rArr|Rarr|Pscr|pscr|prop|prod|prnE|prec|ZHcy|zhcy|prap|Zeta|zeta|Popf|popf|Zdot|plus|zdot|Yuml|yuml|phiv|YUcy|yucy|Yscr|yscr|perp|Yopf|yopf|part|para|YIcy|Ouml|rcub|yicy|YAcy|rdca|ouml|osol|Oscr|rdsh|yacy|real|oscr|xvee|andd|rect|andv|Xscr|oror|ordm|ordf|xscr|ange|aopf|Aopf|rHar|Xopf|opar|Oopf|xopf|xnis|rhov|oopf|omid|xmap|oint|apid|apos|ogon|ascr|Ascr|odot|odiv|xcup|xcap|ocir|oast|nvlt|nvle|nvgt|nvge|nvap|Wscr|wscr|auml|ntlg|ntgl|nsup|nsub|nsim|Nscr|nscr|nsce|Wopf|ring|npre|wopf|npar|Auml|Barv|bbrk|Nopf|nopf|nmid|nLtv|beta|ropf|Ropf|Beta|beth|nles|rpar|nleq|bnot|bNot|nldr|NJcy|rscr|Rscr|Vscr|vscr|rsqb|njcy|bopf|nisd|Bopf|rtri|Vopf|nGtv|ngtr|vopf|boxh|boxH|boxv|nges|ngeq|boxV|bscr|scap|Bscr|bsim|Vert|vert|bsol|bull|bump|caps|cdot|ncup|scnE|ncap|nbsp|napE|Cdot|cent|sdot|Vbar|nang|vBar|chcy|Mscr|mscr|sect|semi|CHcy|Mopf|mopf|sext|circ|cire|mldr|mlcp|cirE|comp|shcy|SHcy|vArr|varr|cong|copf|Copf|copy|COPY|malt|male|macr|lvnE|cscr|ltri|sime|ltcc|simg|Cscr|siml|csub|Uuml|lsqb|lsim|uuml|csup|Lscr|lscr|utri|smid|lpar|cups|smte|lozf|darr|Lopf|Uscr|solb|lopf|sopf|Sopf|lneq|uscr|spar|dArr|lnap|Darr|dash|Sqrt|LJcy|ljcy|lHar|dHar|Upsi|upsi|diam|lesg|djcy|DJcy|leqq|dopf|Dopf|dscr|Dscr|dscy|ldsh|ldca|squf|DScy|sscr|Sscr|dsol|lcub|late|star|Star|Uopf|Larr|lArr|larr|uopf|dtri|dzcy|sube|subE|Lang|lang|Kscr|kscr|Kopf|kopf|KJcy|kjcy|KHcy|khcy|DZcy|ecir|edot|eDot|Jscr|jscr|succ|Jopf|jopf|Edot|uHar|emsp|ensp|Iuml|iuml|eopf|isin|Iscr|iscr|Eopf|epar|sung|epsi|escr|sup1|sup2|sup3|Iota|iota|supe|supE|Iopf|iopf|IOcy|iocy|Escr|esim|Esim|imof|Uarr|QUOT|uArr|uarr|euml|IEcy|iecy|Idot|Euml|euro|excl|Hscr|hscr|Hopf|hopf|TScy|tscy|Tscr|hbar|tscr|flat|tbrk|fnof|hArr|harr|half|fopf|Fopf|tdot|gvnE|fork|trie|gtcc|fscr|Fscr|gdot|gsim|Gscr|gscr|Gopf|gopf|gneq|Gdot|tosa|gnap|Topf|topf|geqq|toea|GJcy|gjcy|tint|gesl|mid|Sfr|ggg|top|ges|gla|glE|glj|geq|gne|gEl|gel|gnE|Gcy|gcy|gap|Tfr|tfr|Tcy|tcy|Hat|Tau|Ffr|tau|Tab|hfr|Hfr|ffr|Fcy|fcy|icy|Icy|iff|ETH|eth|ifr|Ifr|Eta|eta|int|Int|Sup|sup|ucy|Ucy|Sum|sum|jcy|ENG|ufr|Ufr|eng|Jcy|jfr|els|ell|egs|Efr|efr|Jfr|uml|kcy|Kcy|Ecy|ecy|kfr|Kfr|lap|Sub|sub|lat|lcy|Lcy|leg|Dot|dot|lEg|leq|les|squ|div|die|lfr|Lfr|lgE|Dfr|dfr|Del|deg|Dcy|dcy|lne|lnE|sol|loz|smt|Cup|lrm|cup|lsh|Lsh|sim|shy|map|Map|mcy|Mcy|mfr|Mfr|mho|gfr|Gfr|sfr|cir|Chi|chi|nap|Cfr|vcy|Vcy|cfr|Scy|scy|ncy|Ncy|vee|Vee|Cap|cap|nfr|scE|sce|Nfr|nge|ngE|nGg|vfr|Vfr|ngt|bot|nGt|nis|niv|Rsh|rsh|nle|nlE|bne|Bfr|bfr|nLl|nlt|nLt|Bcy|bcy|not|Not|rlm|wfr|Wfr|npr|nsc|num|ocy|ast|Ocy|ofr|xfr|Xfr|Ofr|ogt|ohm|apE|olt|Rho|ape|rho|Rfr|rfr|ord|REG|ang|reg|orv|And|and|AMP|Rcy|amp|Afr|ycy|Ycy|yen|yfr|Yfr|rcy|par|pcy|Pcy|pfr|Pfr|phi|Phi|afr|Acy|acy|zcy|Zcy|piv|acE|acd|zfr|Zfr|pre|prE|psi|Psi|qfr|Qfr|zwj|Or|ge|Gg|gt|gg|el|oS|lt|Lt|LT|Re|lg|gl|eg|ne|Im|it|le|DD|wp|wr|nu|Nu|dd|lE|Sc|sc|pi|Pi|ee|af|ll|Ll|rx|gE|xi|pm|Xi|ic|pr|Pr|in|ni|mp|mu|ac|Mu|or|ap|Gt|GT|ii);|&(Aacute|Agrave|Atilde|Ccedil|Eacute|Egrave|Iacute|Igrave|Ntilde|Oacute|Ograve|Oslash|Otilde|Uacute|Ugrave|Yacute|aacute|agrave|atilde|brvbar|ccedil|curren|divide|eacute|egrave|frac12|frac14|frac34|iacute|igrave|iquest|middot|ntilde|oacute|ograve|oslash|otilde|plusmn|uacute|ugrave|yacute|AElig|Acirc|Aring|Ecirc|Icirc|Ocirc|THORN|Ucirc|acirc|acute|aelig|aring|cedil|ecirc|icirc|iexcl|laquo|micro|ocirc|pound|raquo|szlig|thorn|times|ucirc|Auml|COPY|Euml|Iuml|Ouml|QUOT|Uuml|auml|cent|copy|euml|iuml|macr|nbsp|ordf|ordm|ouml|para|quot|sect|sup1|sup2|sup3|uuml|yuml|AMP|ETH|REG|amp|deg|eth|not|reg|shy|uml|yen|GT|LT|gt|lt)(?!;)([=a-zA-Z0-9]?)|&#([0-9]+)(;?)|&#[xX]([a-fA-F0-9]+)(;?)|&([0-9a-zA-Z]+)/g,g={aacute:"",Aacute:"",abreve:"",Abreve:"",ac:"",acd:"",acE:"",acirc:"",Acirc:"",acute:"",acy:"",Acy:"",aelig:"",AElig:"",af:"",afr:"",Afr:"",agrave:"",Agrave:"",alefsym:"",aleph:"",alpha:"",Alpha:"",amacr:"",Amacr:"",amalg:"",amp:"&",AMP:"&",and:"",And:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",aogon:"",Aogon:"",aopf:"",Aopf:"",ap:"",apacir:"",ape:"",apE:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",aring:"",Aring:"",ascr:"",Ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",atilde:"",Atilde:"",auml:"",Auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",barwed:"",Barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",bcy:"",Bcy:"",bdquo:"",becaus:"",because:"",Because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",beta:"",Beta:"",beth:"",between:"",bfr:"",Bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bnot:"",bNot:"",bopf:"",Bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxdl:"",boxdL:"",boxDl:"",boxDL:"",boxdr:"",boxdR:"",boxDr:"",boxDR:"",boxh:"",boxH:"",boxhd:"",boxhD:"",boxHd:"",boxHD:"",boxhu:"",boxhU:"",boxHu:"",boxHU:"",boxminus:"",boxplus:"",boxtimes:"",boxul:"",boxuL:"",boxUl:"",boxUL:"",boxur:"",boxuR:"",boxUr:"",boxUR:"",boxv:"",boxV:"",boxvh:"",boxvH:"",boxVh:"",boxVH:"",boxvl:"",boxvL:"",boxVl:"",boxVL:"",boxvr:"",boxvR:"",boxVr:"",boxVR:"",bprime:"",breve:"",Breve:"",brvbar:"",bscr:"",Bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpe:"",bumpE:"",bumpeq:"",Bumpeq:"",cacute:"",Cacute:"",cap:"",Cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",ccaron:"",Ccaron:"",ccedil:"",Ccedil:"",ccirc:"",Ccirc:"",Cconint:"",ccups:"",ccupssm:"",cdot:"",Cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",centerdot:"",CenterDot:"",cfr:"",Cfr:"",chcy:"",CHcy:"",check:"",checkmark:"",chi:"",Chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cire:"",cirE:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",colon:":",Colon:"",colone:"",Colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",conint:"",Conint:"",ContourIntegral:"",copf:"",Copf:"",coprod:"",Coproduct:"",copy:"",COPY:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",cross:"",Cross:"",cscr:"",Cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",cup:"",Cup:"",cupbrcap:"",cupcap:"",CupCap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",dagger:"",Dagger:"",daleth:"",darr:"",dArr:"",Darr:"",dash:"",dashv:"",Dashv:"",dbkarow:"",dblac:"",dcaron:"",Dcaron:"",dcy:"",Dcy:"",dd:"",DD:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",delta:"",Delta:"",demptyv:"",dfisht:"",dfr:"",Dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",diamond:"",Diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",djcy:"",DJcy:"",dlcorn:"",dlcrop:"",dollar:"$",dopf:"",Dopf:"",dot:"",Dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",downarrow:"",Downarrow:"",DownArrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",dscr:"",Dscr:"",dscy:"",DScy:"",dsol:"",dstrok:"",Dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",dzcy:"",DZcy:"",dzigrarr:"",eacute:"",Eacute:"",easter:"",ecaron:"",Ecaron:"",ecir:"",ecirc:"",Ecirc:"",ecolon:"",ecy:"",Ecy:"",eDDot:"",edot:"",eDot:"",Edot:"",ee:"",efDot:"",efr:"",Efr:"",eg:"",egrave:"",Egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",emacr:"",Emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",eng:"",ENG:"",ensp:"",eogon:"",Eogon:"",eopf:"",Eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",epsilon:"",Epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",escr:"",Escr:"",esdot:"",esim:"",Esim:"",eta:"",Eta:"",eth:"",ETH:"",euml:"",Euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",exponentiale:"",ExponentialE:"",fallingdotseq:"",fcy:"",Fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",ffr:"",Ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",fopf:"",Fopf:"",forall:"",ForAll:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",fscr:"",Fscr:"",gacute:"",gamma:"",Gamma:"",gammad:"",Gammad:"",gap:"",gbreve:"",Gbreve:"",Gcedil:"",gcirc:"",Gcirc:"",gcy:"",Gcy:"",gdot:"",Gdot:"",ge:"",gE:"",gel:"",gEl:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",gfr:"",Gfr:"",gg:"",Gg:"",ggg:"",gimel:"",gjcy:"",GJcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gne:"",gnE:"",gneq:"",gneqq:"",gnsim:"",gopf:"",Gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",gscr:"",Gscr:"",gsim:"",gsime:"",gsiml:"",gt:">",Gt:"",GT:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",hardcy:"",HARDcy:"",harr:"",hArr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",hcirc:"",Hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",hfr:"",Hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",hopf:"",Hopf:"",horbar:"",HorizontalLine:"",hscr:"",Hscr:"",hslash:"",hstrok:"",Hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",iacute:"",Iacute:"",ic:"",icirc:"",Icirc:"",icy:"",Icy:"",Idot:"",iecy:"",IEcy:"",iexcl:"",iff:"",ifr:"",Ifr:"",igrave:"",Igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",ijlig:"",IJlig:"",Im:"",imacr:"",Imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",int:"",Int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",iocy:"",IOcy:"",iogon:"",Iogon:"",iopf:"",Iopf:"",iota:"",Iota:"",iprod:"",iquest:"",iscr:"",Iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",itilde:"",Itilde:"",iukcy:"",Iukcy:"",iuml:"",Iuml:"",jcirc:"",Jcirc:"",jcy:"",Jcy:"",jfr:"",Jfr:"",jmath:"",jopf:"",Jopf:"",jscr:"",Jscr:"",jsercy:"",Jsercy:"",jukcy:"",Jukcy:"",kappa:"",Kappa:"",kappav:"",kcedil:"",Kcedil:"",kcy:"",Kcy:"",kfr:"",Kfr:"",kgreen:"",khcy:"",KHcy:"",kjcy:"",KJcy:"",kopf:"",Kopf:"",kscr:"",Kscr:"",lAarr:"",lacute:"",Lacute:"",laemptyv:"",lagran:"",lambda:"",Lambda:"",lang:"",Lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",larr:"",lArr:"",Larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",latail:"",lAtail:"",late:"",lates:"",lbarr:"",lBarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",lcaron:"",Lcaron:"",lcedil:"",Lcedil:"",lceil:"",lcub:"{",lcy:"",Lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",le:"",lE:"",LeftAngleBracket:"",leftarrow:"",Leftarrow:"",LeftArrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",leftrightarrow:"",Leftrightarrow:"",LeftRightArrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",leg:"",lEg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",lfr:"",Lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",ljcy:"",LJcy:"",ll:"",Ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",lmidot:"",Lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lne:"",lnE:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",longleftarrow:"",Longleftarrow:"",LongLeftArrow:"",longleftrightarrow:"",Longleftrightarrow:"",LongLeftRightArrow:"",longmapsto:"",longrightarrow:"",Longrightarrow:"",LongRightArrow:"",looparrowleft:"",looparrowright:"",lopar:"",lopf:"",Lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",lscr:"",Lscr:"",lsh:"",Lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",lstrok:"",Lstrok:"",lt:"<",Lt:"",LT:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",map:"",Map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",mcy:"",Mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",mfr:"",Mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",mopf:"",Mopf:"",mp:"",mscr:"",Mscr:"",mstpos:"",mu:"",Mu:"",multimap:"",mumap:"",nabla:"",nacute:"",Nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",ncaron:"",Ncaron:"",ncedil:"",Ncedil:"",ncong:"",ncongdot:"",ncup:"",ncy:"",Ncy:"",ndash:"",ne:"",nearhk:"",nearr:"",neArr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:"\n",nexist:"",nexists:"",nfr:"",Nfr:"",nge:"",ngE:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",ngt:"",nGt:"",ngtr:"",nGtv:"",nharr:"",nhArr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",njcy:"",NJcy:"",nlarr:"",nlArr:"",nldr:"",nle:"",nlE:"",nleftarrow:"",nLeftarrow:"",nleftrightarrow:"",nLeftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nlt:"",nLt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",nopf:"",Nopf:"",not:"",Not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrarr:"",nrArr:"",nrarrc:"",nrarrw:"",nrightarrow:"",nRightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",nscr:"",Nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsube:"",nsubE:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupe:"",nsupE:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",ntilde:"",Ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",nu:"",Nu:"",num:"#",numero:"",numsp:"",nvap:"",nvdash:"",nvDash:"",nVdash:"",nVDash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwarr:"",nwArr:"",nwarrow:"",nwnear:"",oacute:"",Oacute:"",oast:"",ocir:"",ocirc:"",Ocirc:"",ocy:"",Ocy:"",odash:"",odblac:"",Odblac:"",odiv:"",odot:"",odsold:"",oelig:"",OElig:"",ofcir:"",ofr:"",Ofr:"",ogon:"",ograve:"",Ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",omacr:"",Omacr:"",omega:"",Omega:"",omicron:"",Omicron:"",omid:"",ominus:"",oopf:"",Oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",or:"",Or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",oscr:"",Oscr:"",oslash:"",Oslash:"",osol:"",otilde:"",Otilde:"",otimes:"",Otimes:"",otimesas:"",ouml:"",Ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",pcy:"",Pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",pfr:"",Pfr:"",phi:"",Phi:"",phiv:"",phmmat:"",phone:"",pi:"",Pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",popf:"",Popf:"",pound:"",pr:"",Pr:"",prap:"",prcue:"",pre:"",prE:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",prime:"",Prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",pscr:"",Pscr:"",psi:"",Psi:"",puncsp:"",qfr:"",Qfr:"",qint:"",qopf:"",Qopf:"",qprime:"",qscr:"",Qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",quot:'"',QUOT:'"',rAarr:"",race:"",racute:"",Racute:"",radic:"",raemptyv:"",rang:"",Rang:"",rangd:"",range:"",rangle:"",raquo:"",rarr:"",rArr:"",Rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",rarrtl:"",Rarrtl:"",rarrw:"",ratail:"",rAtail:"",ratio:"",rationals:"",rbarr:"",rBarr:"",RBarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",rcaron:"",Rcaron:"",rcedil:"",Rcedil:"",rceil:"",rcub:"}",rcy:"",Rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",reg:"",REG:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",rfr:"",Rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",rho:"",Rho:"",rhov:"",RightAngleBracket:"",rightarrow:"",Rightarrow:"",RightArrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",ropf:"",Ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",rscr:"",Rscr:"",rsh:"",Rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",sacute:"",Sacute:"",sbquo:"",sc:"",Sc:"",scap:"",scaron:"",Scaron:"",sccue:"",sce:"",scE:"",scedil:"",Scedil:"",scirc:"",Scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",scy:"",Scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",searr:"",seArr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",sfr:"",Sfr:"",sfrown:"",sharp:"",shchcy:"",SHCHcy:"",shcy:"",SHcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",sigma:"",Sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",softcy:"",SOFTcy:"",sol:"/",solb:"",solbar:"",sopf:"",Sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",square:"",Square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",sscr:"",Sscr:"",ssetmn:"",ssmile:"",sstarf:"",star:"",Star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",sub:"",Sub:"",subdot:"",sube:"",subE:"",subedot:"",submult:"",subne:"",subnE:"",subplus:"",subrarr:"",subset:"",Subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",sum:"",Sum:"",sung:"",sup:"",Sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supe:"",supE:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supne:"",supnE:"",supplus:"",supset:"",Supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swarr:"",swArr:"",swarrow:"",swnwar:"",szlig:"",Tab:"\t",target:"",tau:"",Tau:"",tbrk:"",tcaron:"",Tcaron:"",tcedil:"",Tcedil:"",tcy:"",Tcy:"",tdot:"",telrec:"",tfr:"",Tfr:"",there4:"",therefore:"",Therefore:"",theta:"",Theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",thorn:"",THORN:"",tilde:"",Tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",topf:"",Topf:"",topfork:"",tosa:"",tprime:"",trade:"",TRADE:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",tscr:"",Tscr:"",tscy:"",TScy:"",tshcy:"",TSHcy:"",tstrok:"",Tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",uacute:"",Uacute:"",uarr:"",uArr:"",Uarr:"",Uarrocir:"",ubrcy:"",Ubrcy:"",ubreve:"",Ubreve:"",ucirc:"",Ucirc:"",ucy:"",Ucy:"",udarr:"",udblac:"",Udblac:"",udhar:"",ufisht:"",ufr:"",Ufr:"",ugrave:"",Ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",umacr:"",Umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",uogon:"",Uogon:"",uopf:"",Uopf:"",uparrow:"",Uparrow:"",UpArrow:"",UpArrowBar:"",UpArrowDownArrow:"",updownarrow:"",Updownarrow:"",UpDownArrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",upsi:"",Upsi:"",upsih:"",upsilon:"",Upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",uring:"",Uring:"",urtri:"",uscr:"",Uscr:"",utdot:"",utilde:"",Utilde:"",utri:"",utrif:"",uuarr:"",uuml:"",Uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",varr:"",vArr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",vBar:"",Vbar:"",vBarv:"",vcy:"",Vcy:"",vdash:"",vDash:"",Vdash:"",VDash:"",Vdashl:"",vee:"",Vee:"",veebar:"",veeeq:"",vellip:"",verbar:"|",Verbar:"",vert:"|",Vert:"",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",vfr:"",Vfr:"",vltri:"",vnsub:"",vnsup:"",vopf:"",Vopf:"",vprop:"",vrtri:"",vscr:"",Vscr:"",vsubne:"",vsubnE:"",vsupne:"",vsupnE:"",Vvdash:"",vzigzag:"",wcirc:"",Wcirc:"",wedbar:"",wedge:"",Wedge:"",wedgeq:"",weierp:"",wfr:"",Wfr:"",wopf:"",Wopf:"",wp:"",wr:"",wreath:"",wscr:"",Wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",xfr:"",Xfr:"",xharr:"",xhArr:"",xi:"",Xi:"",xlarr:"",xlArr:"",xmap:"",xnis:"",xodot:"",xopf:"",Xopf:"",xoplus:"",xotime:"",xrarr:"",xrArr:"",xscr:"",Xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",yacute:"",Yacute:"",yacy:"",YAcy:"",ycirc:"",Ycirc:"",ycy:"",Ycy:"",yen:"",yfr:"",Yfr:"",yicy:"",YIcy:"",yopf:"",Yopf:"",yscr:"",Yscr:"",yucy:"",YUcy:"",yuml:"",Yuml:"",zacute:"",Zacute:"",zcaron:"",Zcaron:"",zcy:"",Zcy:"",zdot:"",Zdot:"",zeetrf:"",ZeroWidthSpace:"",zeta:"",Zeta:"",zfr:"",Zfr:"",zhcy:"",ZHcy:"",zigrarr:"",zopf:"",Zopf:"",zscr:"",Zscr:"",zwj:"",zwnj:""},_={aacute:"",Aacute:"",acirc:"",Acirc:"",acute:"",aelig:"",AElig:"",agrave:"",Agrave:"",amp:"&",AMP:"&",aring:"",Aring:"",atilde:"",Atilde:"",auml:"",Auml:"",brvbar:"",ccedil:"",Ccedil:"",cedil:"",cent:"",copy:"",COPY:"",curren:"",deg:"",divide:"",eacute:"",Eacute:"",ecirc:"",Ecirc:"",egrave:"",Egrave:"",eth:"",ETH:"",euml:"",Euml:"",frac12:"",frac14:"",frac34:"",gt:">",GT:">",iacute:"",Iacute:"",icirc:"",Icirc:"",iexcl:"",igrave:"",Igrave:"",iquest:"",iuml:"",Iuml:"",laquo:"",lt:"<",LT:"<",macr:"",micro:"",middot:"",nbsp:"",not:"",ntilde:"",Ntilde:"",oacute:"",Oacute:"",ocirc:"",Ocirc:"",ograve:"",Ograve:"",ordf:"",ordm:"",oslash:"",Oslash:"",otilde:"",Otilde:"",ouml:"",Ouml:"",para:"",plusmn:"",pound:"",quot:'"',QUOT:'"',raquo:"",reg:"",REG:"",sect:"",shy:"",sup1:"",sup2:"",sup3:"",szlig:"",thorn:"",THORN:"",times:"",uacute:"",Uacute:"",ucirc:"",Ucirc:"",ugrave:"",Ugrave:"",uml:"",uuml:"",Uuml:"",yacute:"",Yacute:"",yen:"",yuml:""},y={0:"",128:"",130:"",131:"",132:"",133:"",134:"",135:"",136:"",137:"",138:"",139:"",140:"",142:"",145:"",146:"",147:"",148:"",149:"",150:"",151:"",152:"",153:"",154:"",155:"",156:"",158:"",159:""},v=[1,2,3,4,5,6,7,8,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,64976,64977,64978,64979,64980,64981,64982,64983,64984,64985,64986,64987,64988,64989,64990,64991,64992,64993,64994,64995,64996,64997,64998,64999,65e3,65001,65002,65003,65004,65005,65006,65007,65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111],b=String.fromCharCode,w={}.hasOwnProperty,k=function(e,r){return w.call(e,r)},E=function(e,r){if(!e)return r;var t,n={};for(t in r)n[t]=k(e,t)?e[t]:r[t];return n},q=function(e,r){var t="";return e>=55296&&e<=57343||e>1114111?(r&&A("character reference outside the permissible Unicode range"),""):k(y,e)?(r&&A("disallowed character reference"),y[e]):(r&&function(e,r){for(var t=-1,n=e.length;++t<n;)if(e[t]==r)return!0;return!1}(v,e)&&A("disallowed character reference"),e>65535&&(t+=b((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=b(e))},D=function(e){return"&#x"+e.toString(16).toUpperCase()+";"},x=function(e){return"&#"+e+";"},A=function(e){throw Error("Parse error: "+e)},R=function(e,r){(r=E(r,R.options)).strict&&f.test(e)&&A("forbidden code point");var t=r.encodeEverything,n=r.useNamedReferences,i=r.allowUnsafeSymbols,s=r.decimal?x:D,p=function(e){return s(e.charCodeAt(0))};return t?(e=e.replace(a,function(e){return n&&k(l,e)?"&"+l[e]+";":p(e)}),n&&(e=e.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;").replace(/&#x66;&#x6A;/g,"&fjlig;")),n&&(e=e.replace(u,function(e){return"&"+l[e]+";"}))):n?(i||(e=e.replace(d,function(e){return"&"+l[e]+";"})),e=(e=e.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;")).replace(u,function(e){return"&"+l[e]+";"})):i||(e=e.replace(d,p)),e.replace(o,function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return s(1024*(r-55296)+t-56320+65536)}).replace(c,p)};R.options={allowUnsafeSymbols:!1,encodeEverything:!1,strict:!1,useNamedReferences:!1,decimal:!1};var $=function(e,r){var t=(r=E(r,$.options)).strict;return t&&h.test(e)&&A("malformed character reference"),e.replace(m,function(e,n,i,s,o,a,c,u,l){var d,p,h,f,m,y;return n?g[m=n]:i?(m=i,(y=s)&&r.isAttributeValue?(t&&"="==y&&A("`&` did not start a character reference"),e):(t&&A("named character reference was not terminated by a semicolon"),_[m]+(y||""))):o?(h=o,p=a,t&&!p&&A("character reference was not terminated by a semicolon"),d=parseInt(h,10),q(d,t)):c?(f=c,p=u,t&&!p&&A("character reference was not terminated by a semicolon"),d=parseInt(f,16),q(d,t)):(t&&A("named character reference was not terminated by a semicolon"),e)})};$.options={isAttributeValue:!1,strict:!1};var S={version:"1.2.0",encode:R,decode:$,escape:function(e){return e.replace(d,function(e){return p[e]})},unescape:$};if(n&&!n.nodeType)if(i)i.exports=S;else for(var T in S)k(S,T)&&(n[T]=S[T]);else t.he=S}(he)}(he$1,he$1.exports)),he$1.exports}var heExports=requireHe();const REQUEST_CHUNK=50,EBAY_OAUTH_SCOPE="https://api.ebay.com/oauth/api_scope";let ebayAccessToken=null,ebayAccessTokenExpiry=0;const HEAVY_FIELDS_TO_CLEAR=["image_src","description","item_affiliate_web_url","item_web_url","raw_data"];var index=defineHook(({schedule:e,init:r},{services:t,database:n,getSchema:i,env:s,logger:o})=>{const a=t.ItemsService,c=s.LISTINGS_CRON||"0 3 * * *",u=s.RATES_CRON||"0 */6 * * *",l="true"===s.LISTINGS_SYNC_DRY_RUN,d=s.EBAY_CLIENT_ID||s.EBAY_CLIENTID||"",p=s.EBAY_CLIENT_SECRET||s.EBAY_CLIENTSECRET||"",h=parseInt(s.EBAY_MAX_PAGES||"3",10),f=parseInt(s.EBAY_MAX_CONCURRENT||"2",10),m=parseInt(s.EBAY_MIN_TIME_MS||"200",10),g=s.EBAY_TRACKING||"",_=s.EXCHANGE_RATES_URL||"http://api.exchangeratesapi.io/v1/latest?access_key=53af9fd44c212751829b71979e140b25&format=1&symbols=EUR,USD,GBP",y=s.LISTINGS_SYNC_SECRET,v=new Bottleneck({maxConcurrent:f,minTime:m});async function b(e,r,t){const n=await async function(){const e=Date.now();if(ebayAccessToken&&e<ebayAccessTokenExpiry-6e4)return ebayAccessToken;if(!d||!p)throw new Error("Missing eBay credentials: set EBAY_CLIENT_ID/EBAY_CLIENT_SECRET");const r=Buffer.from(`${d}:${p}`,"utf8").toString("base64"),t=new URLSearchParams;t.set("grant_type","client_credentials"),t.set("scope",EBAY_OAUTH_SCOPE);const n=await fetch("https://api.ebay.com/identity/v1/oauth2/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Basic ${r}`},body:t.toString()});if(!n.ok){const e=await n.text();throw o.error(`[listings-sync] Failed to obtain eBay OAuth token: ${n.status} ${e}`),new Error(`Failed to obtain eBay OAuth token (status ${n.status})`)}const i=await n.json();ebayAccessToken=i.access_token;const s="number"==typeof i.expires_in?i.expires_in:7200;return ebayAccessTokenExpiry=e+1e3*s,ebayAccessToken}(),i=new URLSearchParams,s=function(e){const r=e.ebay_keywords||"",t=Array.isArray(e.ebay_optional_words)?e.ebay_optional_words:[],n=Array.isArray(e.ebay_stopwords)?e.ebay_stopwords:[];return`${r} ${t.length>0?`+(${t.join(",")})`:""} ${n.length>0?`-(${n.join(",")})`:""}`.trim()}(r);s&&i.set("q",s),i.set("sort","price"),i.set("category_ids","267");const a=(e-1)*REQUEST_CHUNK;i.set("limit",String(REQUEST_CHUNK)),i.set("offset",String(a));const c=`https://api.ebay.com/buy/browse/v1/item_summary/search?${i.toString()}`,u={Authorization:`Bearer ${n}`,"Content-Type":"application/json","X-EBAY-C-MARKETPLACE-ID":`EBAY_${t}`};g&&(u["X-EBAY-C-ENDUSERCTX"]=`affiliateCampaignId=${g},affiliateReferenceId=${g}`);return await v.schedule(async()=>{const e=await fetch(c,{method:"GET",headers:u});if(!e.ok){const r=await e.text();throw o.error(`[listings-sync] eBay Browse API error: ${e.status} ${r}`),new Error(`eBay Browse API error (status ${e.status})`)}return e.json()})}function w(e,r,t,n){const i=e?.itemSummaries;if(!Array.isArray(i)||0===i.length)return[];const s=[];for(const e of i){const i=e.itemLocation,o=i?.country;if(o!==r)continue;const a=e.price;if(!a?.value||!a?.currency)continue;const c=parseFloat(a.value),u=a.currency;if(!Number.isFinite(c)||!t[u])continue;const l=[i?.city||"",i?.stateOrProvince||""].filter(Boolean).join(", ")||o||"",d=e.title||"",p=e.seller,h=p?.username||"",f=e.image?.imageUrl||(e.thumbnailImages||[])[0]?.imageUrl||null,m=e.itemAffiliateWebUrl||e.itemWebUrl||"",g=e.buyingOptions||[];let _="Auction";g.includes("FIXED_PRICE")&&g.includes("AUCTION")?_="AuctionWithBIN":g.includes("FIXED_PRICE")&&(_="FixedPrice");const y=e.condition||"",v=e.conditionId||"",b=e.shortDescription||"",w=e.itemId||""||require$$8$1.createHash("sha256").update(`${m}|${h}`).digest("hex").slice(0,32);s.push({book:n,source:"ebay",listing_key:w,status:"active",title:d,link:m,seller:h,location:l,item_currency:u,item_price:c,item_price_eur:c*t.EUR/t[u],item_price_usd:c*t.USD/t[u],item_price_gbp:c*t.GBP/t[u],listing_type:_,condition:y,condition_id:v,image_src:f,description:b,item_affiliate_web_url:e.itemAffiliateWebUrl||null,item_web_url:e.itemWebUrl||null,raw_data:e})}return s}async function k(e,r,t){const n=[];let i=1,s=!0,a=!1;for(;s&&i<=h;)try{const o=await b(i,e,r),a="number"==typeof o.total?o.total:0,c=a>0?Math.ceil(a/REQUEST_CHUNK):0,u=w(o,r,t,e.id);n.push(...u),!a||!c||i>=c||i>=h?s=!1:i+=1}catch(t){o.warn(`[listings-sync] eBay error for book ${e.id} ${r}: ${t}`),s=!1,a=!0}return{listings:n,success:!a,source:"ebay"}}async function E(e,r){const t=[],n=Array.isArray(e.abebooks_stopwords)?e.abebooks_stopwords:[],i=`${e.ebay_keywords||""} ${(e.ebay_optional_words||[]).join(" ")}`.trim(),s=e.isbn13?`&isbn=${encodeURIComponent(e.isbn13)}`:"",a=`https://www.abebooks.co.uk/servlet/SearchResults?ds=50&sortby=3&tn=${encodeURIComponent(e.title)}&kn=${encodeURIComponent(i)}${s}`;try{const i=await fetch(a,{headers:{"User-Agent":"Mozilla/5.0 (compatible; DirectusBot/1.0)",Accept:"text/html"}});if(!i.ok)return o.warn(`[listings-sync] AbeBooks fetch failed for book ${e.id}: ${i.status}`),{listings:[],success:!1,source:"abebooks"};const s=await async function(e){const r=await e.arrayBuffer(),t=function(e){if(!e)return"utf-8";const r=/charset=([^;]+)/i.exec(e);return r&&r[1]?r[1].toLowerCase():"utf-8"}(e.headers.get("content-type")),n="iso-8859-1"===t?"latin1":t;try{return new TextDecoder(n).decode(r)}catch{return new TextDecoder("utf-8").decode(r)}}(i),c=/<li[^>]*class="[^"]*\bresult-item\b[^"]*"[^>]*>([\s\S]*?)<\/li>/gi,u=/<span[^>]*data-(?:cy|test-id)="listing-title"[^>]*>([^<]+)<\/span>/i,l=/<meta[^>]*itemprop="price"[^>]*content="([\d.,]+)"/i,d=/<p[^>]*class="[^"]*item-price[^"]*"[^>]*>[^0-9]*([\d.,]+)/i,p=/<a[^>]*(?:itemprop="url"|data-(?:cy|test-id)="listing-title")[^>]*href="([^"]+)"/i,h=/<span[^>]*data-(?:cy|test-id)="listing-seller-name"[^>]*>([^<]+)<\/span>/i,f=/<span[^>]*(?:class="[^"]*\bopt-subcondition\b[^"]*"|data-(?:cy|test-id)="listing-optional-condition")[^>]*>([^<]+)<\/span>/i,m=/<span[^>]*data-(?:cy|test-id)="listing-book-condition"[^>]*>([^<]+)<\/span>/i,g=/<img[^>]*class="[^"]*\bsrp-item-image\b[^"]*"[^>]*src="([^"]+)"/i,_=/from\s+([^<]+?)\s+to/i;let y;for(;null!==(y=c.exec(s));){const i=y[1]||"",s=u.exec(i),o=s&&s[1]?heExports.decode(s[1].trim()):"";if(n.some(e=>o.toLowerCase().includes(e.toLowerCase())))continue;const a=l.exec(i)||d.exec(i),c=a?a[1]||a[2]:null,v=c?parseFloat(c.replace(",","")):null;if(null===v||!Number.isFinite(v))continue;const b=p.exec(i),w=b?`https://www.abebooks.co.uk${b[1]}`:"",k=h.exec(i),E=k&&k[1]?heExports.decode(k[1].trim()):"",q=f.exec(i),D=q&&q[1]?heExports.decode(q[1].trim()):"",x=(()=>{if(D)return D.replace(/^Condition:\s*/i,"").trim();const e=m.exec(i);return e&&e[1]?heExports.decode(e[1].trim()):""})(),A=x.includes("-")?x.split("-")[0].trim():x,R=g.exec(i),$=R?R[1]:null,S=_.exec(i),T=S&&S[1]?S[1].trim():null,Z=require$$8$1.createHash("sha256").update(`${w}|${E}`).digest("hex").slice(0,32);t.push({book:e.id,source:"abebooks",listing_key:Z,status:"active",title:o,link:w,seller:E,location:T,item_currency:"GBP",item_price:v,item_price_eur:v*r.EUR/r.GBP,item_price_usd:v*r.USD/r.GBP,item_price_gbp:v,listing_type:"FixedPrice",condition:A,condition_id:null,image_src:$||null,description:null,item_affiliate_web_url:null,item_web_url:w,raw_data:null})}return{listings:t,success:!0,source:"abebooks"}}catch(r){return o.warn(`[listings-sync] AbeBooks scrape error for book ${e.id}: ${r}`),{listings:[],success:!1,source:"abebooks"}}}async function q(){o.info("[listings-sync] Fetching exchange rates...");const e=await i(),r=new a("rates",{schema:e,knex:n});try{const e=await fetch(_),t=(await e.json()).rates,n={EUR:1,USD:t.USD/t.EUR,GBP:t.GBP/t.EUR};return await r.upsertSingleton({eur:n.EUR,usd:n.USD,gbp:n.GBP}),o.info(`[listings-sync] Rates saved: EUR=${n.EUR}, USD=${n.USD.toFixed(4)}, GBP=${n.GBP.toFixed(4)}`),n}catch(e){return o.error(`[listings-sync] Failed to fetch/save FX rates: ${e}`),null}}async function D(e,r){const t=Date.now();o.info(`[listings-sync] Starting sync (dryRun=${l}, ids=${e?.join(",")||"all"}, sources=${r?.join(",")||"all"})`);const s=await i(),c=await async function(){const e=await i(),r=new a("rates",{schema:e,knex:n});try{const e=await r.readSingleton({fields:["eur","usd","gbp"]});return e&&e.usd&&e.gbp?{EUR:e.eur||1,USD:e.usd,GBP:e.gbp}:(o.warn("[listings-sync] No saved rates found, fetching fresh rates..."),await q())}catch(e){return o.error(`[listings-sync] Failed to load rates: ${e}`),null}}();if(!c)return void o.error("[listings-sync] Cannot proceed without FX rates");o.info(`[listings-sync] Using rates: EUR=${c.EUR}, USD=${c.USD}, GBP=${c.GBP}`);const u=new a("books",{schema:s,knex:n}),d={fields:["id","url","title","isbn13","ebay_keywords","ebay_optional_words","ebay_stopwords","abebooks_stopwords"],limit:-1};e&&e.length>0&&(d.filter={id:{_in:e}});const p=await u.readByQuery(d);o.info(`[listings-sync] Loaded ${p.length} books`);const h=new a("listings",{schema:s,knex:n}),f=(new Date).toISOString();let m=0,g=0,_=0;for(const e of p){if(!e.ebay_keywords&&!e.title)continue;const t=["DE","AT","CH","IT","FR","GB","US"],n=[],i=!r||r.includes("ebay"),s=!r||r.includes("abebooks");i&&n.push(...t.map(r=>k(e,r,c))),s&&n.push(E(e,c));const a=await Promise.all(n),u=i&&a.filter(e=>"ebay"===e.source).every(e=>e.success),d=s&&a.filter(e=>"abebooks"===e.source).every(e=>e.success),p=a.filter(e=>e.success).flatMap(e=>e.listings),y=new Map;for(const e of p){const r=`${e.source}:${e.listing_key}`;y.has(r)||y.set(r,e)}const v=Array.from(y.values()),b=await h.readByQuery({fields:["id","listing_key","source","status"],filter:{book:{_eq:e.id},status:{_eq:"active"}},limit:-1});new Set(b.map(e=>`${e.source}:${e.listing_key}`));const w=new Set(v.map(e=>`${e.source}:${e.listing_key}`));for(const r of v){const t=`${r.source}:${r.listing_key}`,n=b.find(e=>`${e.source}:${e.listing_key}`===t);l?n?o.info(`[listings-sync] [DRY-RUN] Would update listing ${n.id}`):o.info(`[listings-sync] [DRY-RUN] Would create listing for book ${e.id} key=${r.listing_key}`):n?(await h.updateOne(n.id,{...r,date_last_seen:f},{emitEvents:!1}),g+=1):(await h.createOne({...r,date_first_seen:f,date_last_seen:f},{emitEvents:!1}),m+=1)}for(const e of b){if(!("ebay"!==e.source||i&&u))continue;if(!("abebooks"!==e.source||s&&d))continue;const r=`${e.source}:${e.listing_key}`;if(!w.has(r)){if(l){o.info(`[listings-sync] [DRY-RUN] Would retire listing ${e.id}`);continue}const r={};for(const e of HEAVY_FIELDS_TO_CLEAR)r[e]=null;await h.updateOne(e.id,{status:"inactive",date_last_seen:f,...r},{emitEvents:!1}),_+=1}}o.info(`[listings-sync] Processed book ${e.id} (${e.url}): ${v.length} listings`)}const y=((Date.now()-t)/1e3).toFixed(1);o.info(`[listings-sync] Sync complete in ${y}s: created=${m}, updated=${g}, retired=${_}`)}e(u,async()=>{try{await q()}catch(e){o.error(`[listings-sync] Rates sync failed: ${e}`)}}),o.info(`[listings-sync] Registered rates cron: ${u}`),e(c,async()=>{try{await D()}catch(e){o.error(`[listings-sync] Sync failed: ${e}`)}}),o.info(`[listings-sync] Registered listings cron: ${c}`),r("routes.before",async({app:e})=>{e.post("/listings-sync",async(e,r)=>{try{let t=!1;if(e.accountability&&e.accountability.user&&(t=!0),y&&e.headers["x-sync-secret"]===y&&(t=!0),!t)return r.status(401).send("Unauthorized");const{keys:n,sources:i}=e.body;if(!n||!i)return r.status(400).send('Invalid payload. Expected "keys" and "sources" arrays.');if(n&&(!Array.isArray(n)||0==n.length))return r.status(400).send('Invalid payload. Expected "keys" array.');if(i&&(!Array.isArray(i)||0==i.length))return r.status(400).send('Invalid payload. Expected "sources" array.');await D(n,i),r.json({success:!0,message:`Synced ${n?n.length:"all"} books`})}catch(e){o.error(e),r.status(500).json({error:e instanceof Error?e.message:"Unknown error"})}})})});module.exports=index;
